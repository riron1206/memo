<html>
<head>
  <title>Evernote Export</title>
  <basefont face="メイリオ" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308919 (ja-JP, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: メイリオ;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3459"/>

<div>
<span><div><br/></div><div><b># カレントディレクトリ確認</b></div><div>getwd()</div><div><br/></div><div><b># カレントディレクトリ移動</b></div><div>setwd(&quot;C:/Users/shingo/Documents/R/code/work/pokemon_inference&quot;)  # windowsでも「/」区切りでないとエラーになる</div><div><br/></div><div><b>############# random data ##############</b></div><div><b># 平均値100、標準偏差20の正規乱数を、10000個作成</b></div><div>RandomData &lt;- function(num, mean, var){</div><div>  return(rnorm(num, mean, var))</div><div>}</div><div><br/></div><div><br/></div><div><b># データフレームの特定の値に一致する要素取り出す</b></div><div>convstr &lt;- convNCBI.homo[convNCBI.homo$V1==string,]$V2</div><div><br/></div><div><b># 2次のlistで特定の値に一致する要素取り出す</b></div><div>ele[[1]][ele[[2]] == &quot;red&quot;]</div><div><b><br/></b></div><div><b># 変数（plotcolor）にある値（commonele）含まれか確認</b></div><div>plotcolor[plotcolor %in% commonele] &lt;- &quot;red&quot;</div><div><br/></div><div><b># list write</b></div><div>lapply(tmp.other, function(x) write.table( data.frame(x), 'tmp_other.txt' , append= T, sep='\t' ))</div><div><br/></div><div><b># 列名を文字列で操作</b></div><div><b>#  [[ ]] の中身の式は評価される</b></div><div>tmp.df &lt;- data.frame(</div><div>  col1 = c(&quot;↑&quot;,&quot;↑&quot;,&quot;↓&quot;)</div><div>  , col2 = c(&quot;↑&quot;,&quot;↓&quot;, &quot;&quot;)</div><div>  , col3 = c(&quot;↓&quot;,&quot;&quot;,&quot;&quot;)</div><div>  )</div><div>tmp.df[[&quot;col1&quot;]]</div><div>dfsubset &lt;- function(df, colname1, colname2){</div><div>  sub.df &lt;- subset(df</div><div>                   , (df[[colname1]] == &quot;↑&quot; | df[[colname1]] == &quot;↓&quot; ) &amp; (df[[colname2]] == &quot;↑&quot; | df[[colname2]] == &quot;↓&quot; )</div><div>                   )</div><div>}</div><div>sub.df &lt;- dfsubset(tmp.df, &quot;col1&quot;, &quot;col2&quot;)</div><div><br/></div><div><b>###duplicated()とdata.frameのインデックスの操作で重複を取り除く。</b></div><div><b># サンプルデータ</b></div><div>set.seed(71)</div><div>dat &lt;- matrix(floor(runif(30, min = 0,max = 10)), ncol = 3)</div><div>dat &lt;- as.data.frame(dat)</div><div>colnames(dat) &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</div><div><br/></div><div><b># a列をキーに重複した値を持つ行を除外</b></div><div>dat[!duplicated(dat$a), ]</div><div><br/></div><div><b># b列とc列をキーに重複した値の組を持つ行を除外</b></div><div>dat[!duplicated(paste(dat$b, dat$c, sep = &quot;,&quot;)), ]</div><div><br/></div><div><br/></div><div><b># SQL文をスペースで分割する</b></div><div>sql.split &lt;- unlist(strsplit(sql, &quot; &quot;))</div><div><br/></div><div><b># 配列(リスト・ベクトル）の逆順を出す</b></div><div>x &lt;- 1:5</div><div>rev(x)</div><div># [1] 5 4 3 2 1</div><div><br/></div><div><b><br/></b></div><div><b>############# コマンドを実行した時の引数の受け取り方#############</b></div><div><b># 参考&lt;https://cran.r-project.org/doc/manuals/R-intro.pdf&gt;</b></div><div>R CMD BATCH --vanilla &quot;--args SF100&quot; ScatterPlot.R # コマンドラインでの実行文</div><div><b><br/></b></div><div><b># ScatterPlot.R</b></div><div>workpath = commandArgs(trailingOnly=TRUE)[1]</div><div>print(workpath)</div><div>print(commandArgs(T))</div><div>if(workpath == &quot;RAW&quot;){</div><div>  workpath &lt;- &quot;../../Illumina/ModData/RAW/&quot;</div><div><br/></div><div>}else if(workpath == &quot;SF100&quot;){</div><div>  workpath &lt;- &quot;../../Illumina/ModData/SF100/&quot;</div><div><br/></div><div>}else{</div><div>  return(&quot;path error&quot;)</div><div>}</div><div>--------------------------</div><div><br/></div><div>hoge.R</div><div>args1 = commandArgs(trailingOnly=TRUE)[1] #1番目の引数を取得する</div><div>args2 = commandArgs(trailingOnly=TRUE)[2] #2番目の引数を取得する</div><div>args3 = commandArgs(trailingOnly=TRUE)[3] #3番目の引数を取得する</div><div><br/></div><div><br/></div><div><br/></div><div><b>############# グラフ参考 #############</b></div><div># plot参考 &lt;http://www.agr.nagoya-u.ac.jp/~seitai/document/R2009/R_graph_yk.pdf&gt;</div><div><b><br/></b></div><div><b>#頻度は棒グラフで表示します。xtabs( ~ 変数名 )で作成した頻度表をbarplot( )に渡して作る</b></div><div>xtabs( ~onom ) # 擬音語データを回数別に集計</div><div>#onom</div><div>#0 1 2 3 4 5</div><div>#1252 942 213 50 13 2</div><div>barplot( xtabs( ~onom ),　 # 集計表を棒グラフに</div><div>  xlab=&quot;擬音語使用頻度&quot;, ylab=&quot;頻度&quot;, main=&quot;擬音語使用頻度の棒グラフ&quot; )</div><div><b><br/></b></div><div><b>############# Check data ##############</b></div><div>str (iris) #　と記述すると，「irisのデータ構造」</div><div><br/></div><div><br/></div><div>rm(list = ls()) #環境内の全ての変数を削除</div><div><br/></div><div>i%%2#余りは%%</div><div><br/></div><div>ZeroPad &lt;- function(int, padnum) {</div><div>  #</div><div>  # 数値（int=1）をゼロパディング（width=3→&quot;001&quot;）する</div><div>  #</div><div>  return(formatC(int, width=as.integer(padnum), flag=&quot;0&quot;))</div><div>}</div><div><br/></div><div><br/></div><div>ClassCheck &lt;- function(data) {</div><div>  #</div><div>  # データの型を判定し型名を返す</div><div>  #</div><div>  switch(class(data), # switch(,</div><div>  &quot;character&quot; = return(&quot;character&quot;), # character（文字型）のときに実行</div><div>  &quot;numeric&quot; = return(&quot;numeric&quot;), # numeric（数値型）のときに実行</div><div>  &quot;matrix&quot; = return(&quot;matrix&quot;), # matrix（行列型）</div><div>  &quot;array&quot; = return(&quot;array&quot;), # array（配列型）</div><div>  &quot;list&quot; = return(&quot;list&quot;), # list型</div><div>  &quot;dataframe&quot; = return(&quot;dataframe&quot;), # dataframe（データフレーム型）</div><div>  &quot;logical&quot; = return(&quot;logical&quot;), # logical（論理型）</div><div>  &quot;factor&quot; = return(&quot;factor&quot;), # factor型</div><div>  &quot;integer&quot; = return(&quot;integer&quot;), # integer（整数型）</div><div>  &quot;integer&quot; = return(&quot;integer&quot;), # complex（複素数型）</div><div>  print(&quot;&quot;) # 一致するものが無いとき実行</div><div>  )</div><div>}</div><div><br/></div><div><b># 部分一致 grepだと一致がないと、長さ0のベクトルになるため、戻り値TRUEまたはFALSEのgrepl使った</b></div><div>if( grepl( opeinfo.Id, opetable.Id ) == TRUE ){</div><div><br/></div><div><br/></div><div><b># 検索</b></div><div><b>#「.gb」で終わる要素を検索</b></div><div>grep(&quot;\\.gb$&quot;, files) # files ベクトルの 1 と 2 の要素が .gb で終わっている</div><div>## [1] 1 2</div><div><br/></div><div><br/></div><div><b># 置換</b></div><div>dna &lt;- c(&quot;AAGCAT&quot;, &quot;TAATAA&quot;, &quot;CCTAT&quot;)</div><div><br/></div><div>sub(&quot;TA&quot;, &quot;ta&quot;, dna)</div><div>## [1] &quot;AAGCAT&quot; &quot;taATAA&quot; &quot;CCtaT&quot; #sub が最初に見つかった pattern だけを置き換える</div><div><br/></div><div>sub(&quot;${name}&quot;,&quot;Tiger&quot;,x, fixed=TRUE)</div><div># [1] &quot;My name is Tiger&quot;</div><div><br/></div><div>gsub(&quot;TA&quot;, &quot;ta&quot;, dna)</div><div>## [1] &quot;AAGCAT&quot; &quot;taAtaA&quot; &quot;CCtaT&quot; #見つかったすべてを置き換える</div><div><br/></div><div>column.txt &lt;- gsub(&quot; VARCHAR2\\(100\\)&quot;, &quot;&quot;, column.txt)</div><div><br/></div><div># dna =~ tr/ACGT/TGCA/</div><div>chartr(&quot;ACGT&quot;, &quot;TGCA&quot;, dna)</div><div>## [1] &quot;TTCGTA&quot; &quot;ATTATT&quot; &quot;GGATA&quot;</div><div><br/></div><div><br/></div><div><br/></div><div><b># 文字列を任意の文字（文字列）を区切りとして分割</b></div><div>str &lt;- &quot;A BC DEFG&quot; # 文字列を設定</div><div>strsplit(str, &quot; &quot;) # strsplit関数の戻り値はリスト</div><div>#[[1]]</div><div>#[1] &quot;A&quot; &quot;BC&quot; &quot;&quot; &quot;DEFG&quot;</div><div><br/></div><div><b># 文字連結</b></div><div>sprintf(&quot;tax is %.2f&quot;, 0.05)</div><div>## [1] &quot;tax is 0.05&quot;</div><div>sprintf(&quot;DROP TABLE %s CASCADE CONSTRAINTS;&quot;, basename(readpath))</div><div><br/></div><div><b># ゼロ長のベクトル（整数1）を出力するRの方法</b></div><div>length(a)</div><div># 0</div><div><br/></div><div><br/></div><div><b>#有効数字</b></div><div><b>#小数点を指定する。例えば、小数点以下４で揃える</b></div><div>test &lt;- 3.14</div><div>format(test, nsmall = 4)</div><div>#[1] &quot;3.1400&quot;</div><div><br/></div><div><b># 数字の文字列を数字と認識。</b> </div><div><a href="https://www.karada-good.net/analyticsr/r-288">https://www.karada-good.net/analyticsr/r-288</a></div><div>#数字を文字列で保存<br/></div><div>ChaTest &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;)</div><div>class(type.convert(ChaTest))</div><div>#[1] &quot;integer&quot;</div><div><br/></div><div><b># 重複を取り除く</b></div><div>refdata.df &lt;- refdata.df[!duplicated(refdata.df$Name), ]</div><div><br/></div><div><b>############# file #############</b></div><div><b># ディレクトリ内のファイル名取得</b></div><div>GetFilePath &lt;- function(path, extension){</div><div>  return( list.files(path, pattern=extension) )</div><div>  #filelist &lt;- list.files(inputdir, pattern=&quot;txt&quot;, full.names = T) # full.names = T はフルパスでとれる</div><div>}</div><div><br/></div><div><b># ファイル削除</b></div><div>file.remove(&quot;../../a.txt&quot;)</div><div>if (file.exists(nonnor.leg.output.path)) file.remove(nonnor.leg.output.path)</div><div><br/></div><div>############# text #############</div><div>EvalText &lt;- function(text){</div><div> #</div><div> # 文字列(例えば”TEST”のようにダブルクォーテーションで囲った文字)でRに命令する方法</div><div> #</div><div>  eval(parse(text = text))</div><div>}</div><div><br/></div><div>StrText &lt;- function(text, start, end){</div><div>  #</div><div>  # 文字列の切り出し</div><div>  # text内のstart番目の文字~end番目の文字返す</div><div>  #</div><div>  return(substr(text, start, end))</div><div>}</div><div><br/></div><div><br/></div><div>Print &lt;- function(...){</div><div>  #</div><div>  # 変数の名前と値をペアで表示するだけのデバッグ用関数</div><div>  # &lt;http://hiratake55.hatenadiary.jp/entry/20100201/1264994611&gt;</div><div>  #</div><div>  key &lt;- as.list(substitute(list(...)))[-1L]</div><div>  val &lt;- list(...)</div><div>  mapply(</div><div>  function(k, v){</div><div>  cat(k, &quot;= &quot;)</div><div>  if(!is.matrix(v) &amp;&amp; (is.logical(v) || is.numeric(v) || is.complex(v) || is.character(v))){ cat(v, &quot;\n&quot;) }</div><div>  else{ cat(&quot;\n&quot;); print(v); cat(&quot;\n&quot;) }</div><div>  },</div><div>  key, val)</div><div>  cat(&quot;\n&quot;)</div><div>}</div><div><br/></div><div><br/></div><div><br/></div><div><b>############# Matrix ##############</b></div><div><b># 行列の列の順番入れ替える。ここでは1と2列を入れ替えてる</b></div><div>iris2 &lt;- iris[,c(2,1,3,4,5)]</div><div><br/></div><div><br/></div><div><b>############# Create numeric Matrix ##############</b></div><div>GetNaToZero &lt;- function(data.mx){</div><div>  #</div><div>  # 欠損値（NA）を0に変換</div><div>  #</div><div>  return(data.mx[is.na(data.mx)] &lt;- 0)</div><div>}</div><div><br/></div><div>RemNa &lt;- function(data.mx){</div><div>  #</div><div>  # NAがひとつでもあるケース (行) を削除</div><div>  # 欠損値（NA）を除去</div><div>  #</div><div>  return(na.omit(data.mx))</div><div>  # x[!is.na(x)]</div><div>}</div><div><br/></div><div>#for( i in 1:length(data.mx[1, ]) ){</div><div># for( j in 1: length(data.mx[, 1]) ) {</div><div># if( is.chracter(data.mx[i, j]) ) {</div><div># data.mx[i, j] &lt;- 0</div><div># }</div><div># }</div><div>#}</div><div><br/></div><div><b># listの要素を追加</b></div><div>x &lt;- c(x, list(y))</div><div><br/></div><div><b># サイズを指定したリスト（list）の初期化方法</b></div><div>list &lt;- vector(&quot;list&quot;,4)</div><div><b><br/></b></div><div><b>############# Max Min Mean Sum of row ############</b></div><div>AppendData &lt;- function(bec1, bec2, insert){</div><div>  #</div><div>  # ベクトル(bec1)の途中に要素を追加</div><div>  #</div><div>  ret &lt;- NULL</div><div>  if(is.null(insert)){</div><div>  ret &lt;- append(bec1, bec2)</div><div>  }else{</div><div>  ret &lt;- append(bec1, bec2, after=insert)</div><div>  }</div><div>  return(ret)</div><div>}</div><div><br/></div><div>RowMaxDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行の最大値</div><div>  #</div><div>  #colMax &lt;- SummaryMatrixDada(data.mx)[6,]</div><div>  #print(colMax)</div><div>  #return(colMax)</div><div><br/></div><div>  max.mx &lt;- matrix(nrow = 1, ncol = ncol(data.mx))</div><div>  for(i in 1:ncol(data.mx)){</div><div>  max.mx[1, i] &lt;- max(data.mx[, i], na.rm=TRUE)</div><div>  }</div><div>  return(max.mx)</div><div>}</div><div><br/></div><div>RowMinDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行の最小値</div><div>  #</div><div>  #colMin &lt;- SummaryMatrixDada(data.mx)[1,]</div><div>  #print(colMin)</div><div>  #return(colMin)</div><div><br/></div><div>  min.mx &lt;- matrix(nrow = 1, ncol = ncol(data.mx))</div><div>  for(i in 1:ncol(data.mx)){</div><div>  min.mx[1, i] &lt;- min(data.mx[, i], na.rm=TRUE)</div><div>  }</div><div>  return(min.mx)</div><div>}</div><div><br/></div><div>RowMeanDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行の平均</div><div>  #</div><div>  #ColMean &lt;- SummaryMatrixDada(data.mx)[4,]</div><div>  #print(ColMean)</div><div>  #return(ColMean)</div><div><br/></div><div>  #colMeans(data.mx, na.rm=TRUE)</div><div><br/></div><div>  mean.mx &lt;- matrix(nrow = 1, ncol = ncol(data.mx))</div><div>  for(i in 1:ncol(data.mx)){</div><div>  mean.mx[1, i] &lt;- mean(data.mx[, i], na.rm=TRUE)</div><div>  }</div><div>  return(mean.mx)</div><div>}</div><div><br/></div><div>RowSumDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行の合計</div><div>  #</div><div>  colsum.mx &lt;- matrix(</div><div>  colSums(data.mx, na.rm=TRUE),</div><div>  nrow = 1,</div><div>  ncol = ncol(data.mx)</div><div>  )</div><div>  return(colsum.mx)</div><div>}</div><div><br/></div><div><b>############# Max Min Mean Sum of column ############</b></div><div>ColMaxDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 列の最大値</div><div>  #</div><div>  max.mx &lt;- matrix(nrow = nrow(data.mx), ncol = 1)</div><div><br/></div><div>  for(i in 1:nrow(data.mx)){</div><div>  max.mx[i, 1] &lt;- max(data.mx[i, ], na.rm=TRUE)</div><div>  }</div><div>  return(max.mx)</div><div>}</div><div><br/></div><div>ColMinDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 列の最小値</div><div>  #</div><div>  min.mx &lt;- matrix(nrow = nrow(data.mx), ncol = 1)</div><div><br/></div><div>  for(i in 1:nrow(data.mx)){</div><div>  min.mx[i, 1] &lt;- min(data.mx[i, ], na.rm=TRUE)</div><div>  }</div><div>  return(min.mx)</div><div>}</div><div><br/></div><div>ColMeanDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 列の平均</div><div>  #</div><div>  #rowMeans(data.mx, na.rm=TRUE)</div><div><br/></div><div>  mean.mx &lt;- matrix(nrow = nrow(data.mx), ncol = 1)</div><div><br/></div><div>  for(i in 1:nrow(data.mx)){</div><div>  mean.mx[i, 1] &lt;- mean(data.mx[i, ], na.rm=TRUE)</div><div>  }</div><div>  return(mean.mx)</div><div>}</div><div><br/></div><div>ColSumDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 列の合計</div><div>  #</div><div>  colsum.mx &lt;- matrix(</div><div>  rowSums(data.mx, na.rm=TRUE),</div><div>  nrow = nrow(data.mx),</div><div>  ncol = 1</div><div>  )</div><div>  return(colsum.mx)</div><div>}</div><div><br/></div><div><b>############# Matrix Summary(Max Min Mean .ect) ############</b></div><div>SummaryMatrixDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行列のサマリー情報</div><div>  #</div><div>  summary &lt;- summary(data.mx)</div><div>  #print(summary)</div><div>  return(summary)</div><div>}</div><div><br/></div><div>SummaryColDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行列の列ごとのサマリー情報(最大値、最小値、平均、合計)</div><div>  #</div><div>  summarycol &lt;- data.frame(</div><div>  max = t(RowMaxDada(data.mx)),</div><div>  min = t(RowMinDada(data.mx)),</div><div>  mean = t(RowMeanDada(data.mx)),</div><div>  sum = t(RowSumDada(data.mx))</div><div>  )</div><div>  return(t(summarycol))</div><div>}</div><div><br/></div><div>SummaryRowDada &lt;- function(data.mx) {</div><div>  #</div><div>  # 行列の行ごとのサマリー情報(最大値、最小値、平均、合計)</div><div>  #</div><div>  summaryrow &lt;- data.frame(</div><div>  max = ColMaxDada(data.mx),</div><div>  min = ColMinDada(data.mx),</div><div>  mean = ColMeanDada(data.mx),</div><div>  sum = ColSumDada(data.mx)</div><div>  )</div><div>  return(summaryrow)</div><div>}</div><div><br/></div><div>GetTable &lt;- function(data.mx) {</div><div>  #</div><div>  # データの項目の度数を取得</div><div>  #</div><div>  return(table(data.mx))</div><div>}</div><div><br/></div><div>GetAscSort &lt;- function(data.mx, rowname) {</div><div>  #</div><div>  # 昇順ソート</div><div>  # sort(rowdata)でも可能</div><div>  #</div><div>  sortlist &lt;- order(data.mx$rowname)</div><div>  return(data.mx[sortlist,])</div><div>}</div><div><br/></div><div>GetDscSort &lt;- function(data.mx, rowname) {</div><div>  #</div><div>  # 降順ソート</div><div>  #</div><div>  sortlist &lt;- order(data.mx$rowname, decreasing=T)</div><div>  return(data.mx[sortlist,])</div><div>}</div><div><br/></div><div><br/></div><div><b>############# apply = 行列の各行、各列、各要素に関数を一括適用############</b></div><div>GetColApply &lt;- function(data.mx, func){</div><div>  #</div><div>  # 列ごとにfunc関数実行</div><div>  #</div><div>  return(apply(data.mx, 2, func, na.rm = TRUE))</div><div>  # apply(data,2,function(v){return(min(v)*1.08)}) # 列ごとに最低値の1.08倍を計算</div><div>}</div><div><br/></div><div>GetRowApply &lt;- function(data.mx, func){</div><div>  #</div><div>  # 行ごとにfunc関数実行</div><div>  #</div><div>  return(apply(data.mx, 1, func, na.rm = TRUE))</div><div>  # mean &lt;- apply(data.df[, 2:ncol(data.df)], 1, mean)</div><div>}</div><div><br/></div><div>GetRowApply &lt;- function(data.mx, func){</div><div>  #</div><div>  # 行列の各要素ごとにfunc関数実行</div><div>  #</div><div>  return(apply(data.mx, c(1,2), func, na.rm = TRUE))</div><div>}</div><div><br/></div><div>GetColNames &lt;- function(data.mx){</div><div>  #</div><div>  # データフレームの列名を取得</div><div>  #</div><div>  return(colnames(data.mx))</div><div>}</div><div><br/></div><div><b># 列名変更</b></div><div># https://winlabo.com/post-805</div><div>names(df)</div><div>#[1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</div><div># names(df)の1番目の要素にアクセスして&quot;id&quot;に置換</div><div>names(df)[1]&lt;-&quot;id&quot;</div><div># 列名確認</div><div>names(df)</div><div>#[1] &quot;id&quot; &quot;b&quot; &quot;c&quot;</div><div><br/></div><div><br/></div><div>GetRoeNames &lt;- function(data.mx){</div><div>  #</div><div>  # データフレームの行名を取得</div><div>  #</div><div>  return(rownames(data.mx))</div><div>}</div><div><br/></div><div><b>############# column row Bind and Names ############</b></div><div>BindRow &lt;- function(row1, addrow){</div><div>  #</div><div>  # 行ごとにベクトル結合して行列作成</div><div>  #</div><div>  return(rbind(row1, addrow))</div><div>}</div><div><br/></div><div>BindCol &lt;- function(col1, addcol){</div><div>  #</div><div>  # 列ごとにベクトル結合して行列作成</div><div>  #</div><div>  return(cbind(col1, addcol))</div><div>}</div><div><br/></div><div>AddCol &lt;- function(data.mx, addcol){</div><div>  #</div><div>  # 列追加</div><div>  #</div><div>  return(data.frame(data.mx, addcol))</div><div>}</div><div><br/></div><div>NameCols &lt;- function(data.mx, colnamelist){</div><div>  #</div><div>  # 行列orデータフレームの行に名前付ける</div><div>  #</div><div>  colnames(data.mx) &lt;- c(colnamelist)</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>NameRows&lt;- function(data.mx, rownamelist){</div><div>  #</div><div>  # 行列orデータフレームの列に名前付ける</div><div>  #</div><div>  rownames(data.mx) &lt;- c(rownamelist)</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>NameRows&lt;- function(data.mx, row){</div><div>  #</div><div>  # 行列orデータフレームの列削除</div><div>  #</div><div>  data.mx$row &lt;- NULL</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>#1列目削除</div><div>human &lt;- human[-1,]</div><div><br/></div><div>#1行目削除</div><div>human &lt;- human[,-1]</div><div><br/></div><div><b>############# List #############</b></div><div>ConvListToDf &lt;- function(iris.list) {</div><div>  #</div><div>  # List型をデータフレームに変換</div><div>  #</div><div>  Unzip &lt;- function(...) rbind(data.frame(), ...)</div><div>  iris.frame &lt;- do.call(Unzip, iris.list)</div><div><br/></div><div>  # #リスト ⇒ データフレーム</div><div>  # evidence.codes.info.df &lt;- do.call(rbind, evidence.codes.info)</div><div>}</div><div><br/></div><div>ConvDfToList &lt;- function(iris) {</div><div>  #</div><div>  # データフレーム型をListに変換</div><div>  #</div><div>  Zip &lt;- function(...) Map(list, ...)</div><div>  iris.list &lt;- do.call(Zip, iris)</div><div>}</div><div><br/></div><div>ConvListToMatrix &lt;- function(iris.list) {</div><div>  #</div><div>  # List型を行列に変換</div><div>  #</div><div>  do.call(rbind, iris.list)</div><div>}</div><div><br/></div><div>ConvListToBec &lt;- function(iris.list) {</div><div>  #</div><div>  # List型を行列に変換</div><div>  # 再帰的にベクトル変換したくない場合はrecursive = FALSE</div><div>  #</div><div>  return(unlist(iris.list, recursive = TRUE))</div><div>}</div><div><br/></div><div>FlattenList &lt;- function(x){</div><div>  #</div><div>  # リストを平滑に分割する(JSONデータファイル出力で使った)</div><div>  #</div><div>  morelists &lt;- sapply(x, function(xprime) class(xprime)[1]==&quot;list&quot;)</div><div>  out &lt;- c(x[!morelists], unlist(x[morelists], recursive=FALSE))</div><div>  if(sum(morelists)){</div><div>  Recall(out)</div><div>  }else{</div><div>  return(out)</div><div>  }</div><div>}</div><div><br/></div><div>FlattenListBec &lt;- function(list.row) {</div><div>  #</div><div>  # listの各要素のベクトルを「,」区切りで結合</div><div>  #</div><div>  for(i in 1:length(row)){</div><div>  list.row[[i]] &lt;- paste( list.row[[i]], collapse = &quot;,&quot;)</div><div>  }</div><div>  return(list.row)</div><div>}</div><div><br/></div><div><b>############# matrix Other ############</b></div><div>GetSubSet &lt;- function() {</div><div>  #</div><div>  # 行列の列抽出</div><div>  #</div><div>  # subset(light_2h_deep_12h, TRUE, c(probe, GeneSymbol, A549_ASP3325_10nM_2h, A549_ASP3325_1000nM_12h))</div><div>}</div><div><br/></div><div>GetMatchData &lt;- function(data1, data2){</div><div>  #</div><div>  # 積集合　2つのベクトルの共通要素取得</div><div>  #</div><div>  return(intersect(data1, data2))</div><div>}</div><div><br/></div><div>GetMisData &lt;- function(data1, data2){</div><div>  #</div><div>  # 差集合　2つのベクトルの非共通要素取得</div><div>  #</div><div>  diffdata1 &lt;- setdiff(data1, data2)</div><div>  diffdata2 &lt;- setdiff(data2, data1)</div><div>  return(c(diffdata1, diffdata2))</div><div>}</div><div><br/></div><div><b># 空のlistを作る</b></div><div>l &lt;-list()</div><div><br/></div><div>GetEmpDF &lt;- function(n){</div><div>  #</div><div>  # 空のデータフレームを作る</div><div>  # 3列のカラムを作って、それぞれにcolumn1～column3という名前をつけています</div><div>  #</div><div>  n &lt;- 3</div><div>  df &lt;- data.frame(matrix(rep(NA, n), nrow=1))[numeric(0), ]</div><div>  colnames(df) &lt;- c(&quot;column1&quot;, &quot;column2&quot;, &quot;column3&quot;)</div><div>}</div><div><b><br/></b></div><div><b># 空のデータフレームにforで列追加していく</b></div><div>TmpDf &lt;- function(){</div><div><br/></div><div>  nonor.R2 &lt;- read.table(&quot;T:/Array/Illumina/GSE65391_H3-014/work/tmp/normalize_check/class_file/orig_nonnormalized/GSE65391_non-normalized_data_Illumina_HT12_V4_R2.txt&quot;</div><div>  , header = T, sep = &quot;\t&quot;, stringsAsFactors = F)</div><div>  df &lt;- data.frame()</div><div>  for( i in seq(1, ncol(nonor.R2), 2) ){</div><div>  if(i == 1){</div><div>  df &lt;- rbind( data.frame(nonor.R2[,i]) )</div><div>  }else{</div><div>  df &lt;- cbind( df, data.frame(nonor.R2[,i]) )</div><div>  }</div><div>  }</div><div>}</div><div><br/></div><div><b>############# File input output ############</b></div><div><b># クリップボードにコピーしたテーブルは，ファイル名に clipboard と指定するだけで読み込めます</b></div><div>read.table(&quot;clipboard&quot;)</div><div><br/></div><div>a &lt;- read.table(file = &quot;clipboard&quot;, header = F,</div><div>  as.is = T,# 因子化を防ぐ?</div><div>  quote=&quot;&quot;,# &quot;'&quot;が使ってあっても大丈夫</div><div>  sep = &quot;\t&quot;,</div><div>  strip.white = T,# 空白スペースは無視</div><div>  na.strings = &quot;NA&quot;,</div><div>  fill = T,#空のラインを無視しない</div><div>  blank.lines.skip = F,#空のラインを無視しない</div><div>  comment.char = &quot;&quot;)# &quot;#&quot;を注釈文字として扱わない</div><div><br/></div><div><br/></div><div>ReadMatrixFile.HeadTab &lt;- function(filepath) {</div><div>  #</div><div>  # ファイル読み込み　ヘッダあり　タブ区切り</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, header=T, sep=&quot;\t&quot;, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.CSV &lt;- function(filepath) {</div><div>  #</div><div>  # ファイル読み込み　CSVファイル（ヘッダありのカンマ区切りのファイル）</div><div>  #</div><div>  data.mx &lt;- read.csv(filepath, sep=&quot;,&quot;, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.Skip &lt;- function(filepath, num) {</div><div>  #</div><div>  # ファイル読み込み 頭から指定行分行スキップ</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, skip=num, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.Comment &lt;- function(filepath, com) {</div><div>  #</div><div>  # ファイル読み込み コメント行の文頭指定し、コメント行スキップ</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, comment.char=com, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.Lack &lt;- function(filepath, com) {</div><div>  #</div><div>  # ファイル読み込み 行データが欠落していてヘッダのカラムの数と同じ数だけデータ無い場合</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, header = T, sep = &quot;\t&quot;, quote=&quot;&quot;, comment.char=&quot;&quot;, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.Chara &lt;- function(filepath, com) {</div><div>  #</div><div>  # ファイル読み込み 「001」や「002」を文字として読み込ませたい場合</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, colClasses = &quot;character&quot;, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div>ReadMatrixFile.Factor &lt;- function(filepath, com) {</div><div>  #</div><div>  # ファイル読み込み 文字列がfactorに解釈されないようにする場合</div><div>  #</div><div>  data.mx &lt;- read.table(filepath, stringsAsFactors=F, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div># ファイルパスからファイル名を取得　http://pandazx.hatenablog.com/entry/2014/08/04/172211</div><div>input = &quot;dir/file.csv&quot;</div><div>basename(input)</div><div>#[1] &quot;file.csv&quot;</div><div><br/></div><div># 拡張子を除外したい場合</div><div>substr(basename(input), 1, nchar(basename(input)) - 4)</div><div>#[1] &quot;file&quot;</div><div><br/></div><div><br/></div><div># &quot;&quot;と''が引用符として認識されます。</div><div># もし文字列データの中にこの記号が含まれていると読み込みが上手くいきません。そこで引用符をなし</div><div>read.table(&quot;dummydata.txt&quot;, header = TRUE, fill = TRUE, sep = &quot;\t&quot;, quote = &quot;&quot;)</div><div>summary(dummydata)</div><div><br/></div><div>ReadMatrixFile &lt;- function(filepath) {</div><div>  #</div><div>  # ファイル読み込み</div><div>  #</div><div>  data.mx &lt;- read.table(filepath)</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div><b># inputdirディレクトリの複数csvファイルを1つのdata.frameに一括で読み込みファイル出力 統合 ファイル結合</b></div><div>CsvFileMerge &lt;- function(inputdir, outputdir){</div><div>  # inputdir &lt;- outputdir</div><div>  filelist &lt;- list.files(inputdir, pattern=&quot;csv&quot;, full.names = T)</div><div>  x &lt;- do.call(rbind, lapply(filelist,read.csv))　# 複数csvファイルを1つのdata.frameに一括で読み込む</div><div>  write.table(x, paste0(outputdir, &quot;merge.txt&quot;), quote = FALSE, row.names=F, col.names=F, sep = &quot;\t&quot;)</div><div>}</div><div><br/></div><div><br/></div><div>ReadTextFile &lt;- function(filepath) {</div><div>  #</div><div>  # 文字列のファイルそのまま読み込み　文字列のreadはscan　htmlファイル変更に使った</div><div>  #</div><div>  text &lt;- scan(filepath, what = character(), sep = &quot;\n&quot;, blank.lines.skip = F)</div><div>  return(text)</div><div>}</div><div><br/></div><div>ReadJsonFile &lt;- function(filepath) {</div><div>  #</div><div>  # JSONファイル読み込み</div><div>  # flatten = TRUEをつけることでネストされてる列をばらしてくれる</div><div>  #</div><div>  library(jsonlite)</div><div>  data.mx &lt;- fromJSON(filepath, flatten = TRUE)</div><div>  return(data.mx)</div><div>}</div><div><br/></div><div><br/></div><div>WriteMatrixFile.HeadTab &lt;- function(data.mx, filepath) {</div><div>  #</div><div>  # ファイル出力　タブ区切り　ヘッダあり　クオートなし</div><div>  #</div><div>  write.table(data.mx, filepath, sep=&quot;\t&quot;, col.names=T, row.names=F, quote=F, append = F)</div><div>}</div><div><br/></div><div>WriteMatrixFile.HeadTabAppend &lt;- function(data.mx, filepath) {</div><div>  #</div><div>  # ファイル出力　タブ区切り　ヘッダあり　クオートなし　追記していく</div><div>  #</div><div>  write.table(data.mx, filepath, sep=&quot;\t&quot;, col.names=T, row.names=F, quote=F, append = T)</div><div>}</div><div><br/></div><div>WriteMatrixFile.RowColHeadTab &lt;- function(data.mx, filepath) {</div><div>  #</div><div>  # ファイル出力　タブ区切り　行と列でヘッダあり　クオートなし　追記していく</div><div>  #</div><div>  write.table(data.mx, filepath, sep=&quot;\t&quot;, col.names=T, row.names=T, quote=F)</div><div>}</div><div><br/></div><div>WriteMatrixFile &lt;- function(data.mx, filepath) {</div><div>  #</div><div>  # ファイル出力</div><div>  #</div><div>  write.table(data.mx, filepath)</div><div>}</div><div><br/></div><div>WriteXlsxFile &lt;- function(data, filepath) {</div><div>  #</div><div>  # エクセルファイル出力</div><div>  #</div><div>  library(&quot;openxlsx&quot;)#library(&quot;xlsx&quot;)</div><div>  write.xlsx(data, filepath, row.names=F)</div><div>}</div><div><br/></div><div>WriteHtmlFile &lt;- function(data, filepath) {</div><div>  #</div><div>  # HTMLファイル出力</div><div>  #</div><div>  library(hwriter)</div><div>  tmp_html &lt;- openPage(filepath, charset=&quot;shift-jis&quot;)#charset=&quot;UTF-8&quot;</div><div>  hwrite(data, tmp_html, row.style=list('font-weight:bold'), row.bgcolor='#ffaaaa', row.names=F, col.style=list(NA, NA, 'text-align:center', 'text-align:center'))</div><div>  closePage(tmp_html)</div><div>}</div><div><br/></div><div>############# development fonction ############</div><div>NumMatrixSummaryOutput &lt;- function(input.filepath, output.filepath.col, output.filepath.row) {</div><div>  #</div><div>  # 数値データのみ可能</div><div>  # 行列の行と列でのサマリー情報(最大値、最小値、平均、合計)をファイル出力する</div><div>  #</div><div>  #filepath &lt;- &quot;tmp/tmp.txt&quot;</div><div>  #data.mx &lt;- ReadTextFile(&quot;tmp/tmp.txt&quot;)</div><div>  data.mx &lt;- read.table(input.filepath, header=T, sep=&quot;\t&quot;, fileEncoding = &quot;SJIS&quot;)#, fileEncoding = &quot;UTF-8&quot;</div><div>  #data.mx &lt;- ReadMatrixFile.HeadTab(input.filepath)</div><div>  WriteMatrixFile.RowColHeadTab( SummaryColDada(data.mx), output.filepath.col )</div><div>  WriteMatrixFile.RowColHeadTab( SummaryRowDada(data.mx), output.filepath.row )</div><div>}</div><div><br/></div><div><br/></div><div># --------------- random data ---------------</div><div># 1000個のデータ（平均＝0、標準偏差＝1）</div><div>RandomData(1000, 0, 1)</div><div><br/></div><div><br/></div><div><br/></div><div># --------------- Max Min Mean Sum Summary Test --------------------</div><div>bec1 &lt;- c(1, 2, 2)</div><div>bec2 &lt;- c(2, 5, 66)</div><div>appe &lt;- AppendData(bec1, bec2, NULL)</div><div>appe &lt;- AppendData(bec1, bec2, 1)</div><div>AppendData(bec1, bec2, 2)</div><div>table(appe)</div><div><br/></div><div><br/></div><div>data.mx &lt;- matrix(1:6, nrow=2, ncol=3)</div><div>data.mx &lt;- BindCol(data.mx, c(NA, NA, NA))</div><div>data.mx &lt;- BindCol(data.mx, c(NA, NA, NA))</div><div>data.mx &lt;- BindRow(data.mx, c(NA, NA, NA, NA, 4.2))</div><div><br/></div><div><br/></div><div>RowMaxDada(data.mx)</div><div>t(RowMaxDada(data.mx))</div><div>RowMinDada(data.mx)</div><div><br/></div><div>RowMeanDada(data.mx)</div><div><br/></div><div>RowSumDada(data.mx)</div><div>RowSumDada(data.mx)[1]</div><div><br/></div><div><br/></div><div>ColMaxDada(data.mx)</div><div>ColMaxDada(data.mx)[1]</div><div><br/></div><div>ColMinDada(data.mx)</div><div><br/></div><div>ColMeanDada(data.mx)</div><div><br/></div><div>x &lt;- ColSumDada(data.mx)</div><div>ColSumDada(data.mx)[1]</div><div><br/></div><div>SummaryMatrixDada(data.mx)</div><div><br/></div><div>SummaryColDada(data.mx)</div><div>sumr &lt;- SummaryRowDada(data.mx)</div><div>sumr$max</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>nrow(data.mx)</div><div><br/></div><div>max.mx &lt;- matrix(nrow = 1, ncol = ncol(data.mx))</div><div>for(i in max.mx){</div><div>  print(i)</div><div>  #max.mx[1, i] &lt;- max(data.mx[, i], na.rm=TRUE)</div><div>}</div><div># -------------------------------------------------</div><div><br/></div><div># --------------- column row Bind and Names Test --------------------</div><div>x1 &lt;- c(&quot;NA&quot;, 12, 1000.001, &quot;FSFDSあああ&quot;)</div><div>x2 &lt;- c(100000000025.0111, 12000, &quot;うううううう&quot;, 4589.358)</div><div><br/></div><div>x3 &lt;- BindRow(x1,x2)</div><div>BindCol(x1,x2)</div><div><br/></div><div>colnames &lt;- c(&quot;1&quot;, &quot;asfds&quot;, &quot;sdss&quot;, &quot;adda&quot;)</div><div>NameCols(x3, colnames)</div><div><br/></div><div>lownames &lt;- c(&quot;1&quot;, &quot;asfds&quot;)</div><div>NameRows(x3, lownames)</div><div><br/></div><div>data.mx &lt;- matrix(nrow=2, ncol=4)</div><div># -------------------------------------------------------------------</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div># --------------- apply = 行列の各行、各列、各要素に関数を一括適用 ---------------</div><div>data.mx &lt;- matrix(1:6, nrow=2, ncol=3)</div><div>data.mx &lt;- BindCol(data.mx, c(NA, NA, NA))</div><div>data.mx &lt;- BindCol(data.mx, c(NA, NA, NA))</div><div>data.mx &lt;- BindRow(data.mx, c(NA, NA, NA, NA, 4.2))</div><div><br/></div><div><br/></div><div>GetColApply(data.mx, min)</div><div>GetColApply(data.mx, max)</div><div><br/></div><div>RangeWidth &lt;- function(x) {return (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))} # 最大と最少の差を計算する関数を定義する</div><div>apply(data.mx, 1, RangeWidth, na.rm = TRUE)</div><div>GetColApply(data.mx, RangeWidth)</div><div><br/></div><div>GetRowApply(data.mx, max)</div><div><br/></div><div><br/></div><div># サンプルデータを作る</div><div>名前 &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;)</div><div>性別 &lt;- c(&quot;男&quot;, &quot;男&quot;, &quot;女&quot;, &quot;男&quot;, &quot;女&quot;, &quot;女&quot; )</div><div>身長 &lt;- c(175, 165, 165, 170, 160, 155 )</div><div>df &lt;- data.frame(名前, 性別, 身長)</div><div>df</div><div><br/></div><div>tapply(df$身長, df$性別, mean)</div><div><br/></div><div># --------------- Other Test --------------------</div><div>xx1 &lt;- c(1:5)</div><div>xx2 &lt;- c(1:10)</div><div>GetMatchData(xx1, xx2)</div><div>GetMatchData(xx1, xx2)[1]</div><div><br/></div><div>GetMisData(xx1, xx2)</div><div>GetMisData(xx2, xx1)</div><div>GetMisData(xx1, xx2)[1]</div><div># -----------------------------------------------</div><div><br/></div><div><br/></div><div># --------------- File input output Test --------------------</div><div><br/></div><div>filedata.mx &lt;- ReadMatrixFile.HeadTab(&quot;tmp/lengthData_MCF7_ASP9521.txt&quot;)</div><div>filedata.mx &lt;- ReadMatrixFile.CSV(&quot;tmp/lengthData_MCF7_ASP9521.csv&quot;)</div><div>filedata.mx &lt;- ReadMatrixFile.CSV(&quot;tmp/test.csv&quot;)</div><div>sss.mx &lt;- read.csv(&quot;tmp/test.csv&quot;, fileEncoding = &quot;SJIS&quot;)</div><div>aaa.mx &lt;- ReadMatrixFile.Skip(&quot;tmp/lengthData_MCF7_ASP9521.txt&quot;, 1)</div><div>aaa.mx &lt;- ReadMatrixFile(&quot;tmp/lengthData_MCF7_ASP9521.txt&quot;)</div><div><br/></div><div>text &lt;- ReadTextFile(&quot;tmp/lengthData_MCF7_ASP9521.txt&quot;)</div><div><br/></div><div><br/></div><div>WriteXlsxFile(text, &quot;tmp/txt.xlsx&quot;)</div><div>WriteHtmlFile(text, &quot;tmp/txt.html&quot;)</div><div><br/></div><div># ---------------- development Test --------------------------</div><div>NumMatrixSummaryOutput(&quot;../tmp/tmp_num.txt&quot;, &quot;../tmp/out_col.txt&quot;, &quot;../tmp/out_row.txt&quot;)</div><div><br/></div><div>data.mx &lt;- read.table(&quot;../tmp/tmp_num.txt&quot;, header=T, sep=&quot;\t&quot;)</div><div>table(data.mx)</div><div><br/></div><div><br/></div><div># ------------------------------------------------------------</div><div>tmp</div><div>length(tmp)</div><div>tmp[[1]]</div><div>tmp[[2]]</div><div><br/></div><div><br/></div><div>mer &lt;- append(mtcars$gear, mtcars$carb)</div><div>fac.mer &lt;- as.factor(mer)</div><div>levels(fac.mer)</div><div>table(append(mtcars$gear, mtcars$carb))</div><div>table(mtcars$gear)</div><div>table(mtcars$carb)</div><div><br/></div><div>data.mx &lt;- data.frame(merge=levels(fac.mer), data1=levels(fac.mer), data2=levels(fac.mer))</div><div>data.mx$merge &lt;- levels(fac.mer)</div><div><br/></div><div>intersect(fac.gear, fac.carb)</div><div>setdiff(fac.gear, fac.carb)</div><div><br/></div><div>tmp.mx &lt;- matrix(setdiff(fac.carb, fac.gear))</div><div>tmp2 &lt;- rep(0, length(setdiff(fac.carb, fac.gear)))</div><div><br/></div><div>mytable &lt;- table(gear=mtcars$gear, gear=mtcars$gear)</div><div><br/></div><div>append(c(1,1,1),table(mtcars$gear))</div><div><br/></div><div>tabulate(mtcars$gear)</div><div>tabulate(mtcars$carb)</div><div>data.mx &lt;- data.frame(merge=levels(fac.mer), data1=tabulate(mtcars$gear), data2=tabulate(mtcars$carb))</div><div><br/></div><div>matrix(mtcars$carb,nrow=2,ncol=5,byrow=TRUE)</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div># 2元の度数表</div><div>mytable &lt;- table(gear=mtcars$gear, carb=mtcars$carb) # &quot;gear=...&quot;としないと名前のない表になるので見づらい。</div><div>mytable</div><div><br/></div><div># 集計欄</div><div>margin.table(mytable, 1) # 行の合計</div><div>margin.table(mytable, 2) # 列の合計</div><div># 表に集計行を追加</div><div>addmargins(mytable)</div><div>?addmargins</div><div><br/></div><div># パーセンテージ</div><div>prop.table(mytable) # セルのパーセンテージ</div><div>prop.table(mytable, 1) # 行のパーセンテージ</div><div>prop.table(mytable, 2) # 列のパーセンテージ</div><div># パーセンテージ (+ 合計欄) の関数</div><div>cprp &lt;- function(x, p=1) {</div><div>  xn &lt;- addmargins(x)</div><div>  cp &lt;- t(t(xn)/xn[nrow(xn),]*p)[-nrow(xn), -ncol(xn)]</div><div>  rp &lt;- (xn/xn[, ncol(xn)]*p)[-nrow(xn), -ncol(xn)]</div><div>  pt &lt;- prop.table(x)</div><div>  return(list(adm=xn, cp=cp, rp=rp, pt=pt))</div><div>}</div><div>cprp(mytable)</div><div><br/></div><div># 3元の集計表</div><div>attach(mtcars)</div><div>mytable &lt;- table(am, gear, carb)</div><div>mytable</div><div>ftable(mytable)</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>tab &lt;- table(data.mx)</div><div>tab</div><div>tab2 &lt;- BindRow(tab, table(data.mx))</div><div>tab2</div><div>t(tab2)</div><div>rownames(tab2)</div><div>colnames(tab2)</div><div><br/></div><div># tapply(数値ベクトル，数値ベクトルと同じ長さの文字列ベクトル，適用したい関数)</div><div>( mymeans &lt;- tapply(data.mx, 1, mean) ) # breaks の平均をグループごとに計算</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>table(mytable)</div><div><br/></div><div>stem(data.mx)</div><div>fivenum(data.mx)</div><div><br/></div><div>xxxx &lt;- fivenum(data.mx) # 最小値・下側ヒンジ・中央値・上側ヒンジ・最大値</div><div>xxxx[1]</div><div><br/></div><div><br/></div><div>colMeans(data.mx, na.rm=TRUE)</div><div>rowMeans(data.mx, na.rm=TRUE)</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 