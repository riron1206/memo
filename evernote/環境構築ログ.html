<html>
<head>
  <title>Evernote Export</title>
  <basefont face="メイリオ" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/309091 (ja-JP, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: メイリオ;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1065"/>

<div>
<span><div><div><div><div><div><div><div><div><span style="font-weight: bold;">自宅PC_Windows_DeepLearning環境構築ログ</span></div><hr/><div><span style="font-weight: bold;">tfgpu環境に入れたライブラリ.txt</span></div><div><br/></div><div>20180519</div><div>conda create -n tfgpu</div><div>activate tfgpu</div><div>conda install python=3.5</div><div>conda install numpy pandas opencv scikit-learn keras git</div><div>conda install jupyter Protobuf Pillow lxml Matplotlib</div><div><br/></div><div>mkdir Git</div><div>cd Git</div><div>git clone <a href="https://github.com/tensorflow/models.git" rev="en_rl_none">https://github.com/tensorflow/models.git</a></div><div><br/></div><div>mkdir proc_3.3</div><div><a href="https://github.com/google/protobuf/releases">https://github.com/google/protobuf/releases</a></div><div>からproc v3.3ダウンロード</div><div><br/></div><div>set PYTHONPATH=%PYTHONPATH%;C:\Users\shingo\Git\models\research;C:\Users\shingo\Git\models\research\slim;C:\Users\shingo\Git\models\research\object_detection</div><div><br/></div><div>cd C:\Users\shingo\Git\models\research</div><div>python object_detection/builders/model_builder_test.py</div><div># object detection APIエラーなく動いた</div><div><br/></div><div>conda install -c anaconda cython</div><div>#---------------------------------------</div><div><br/></div><div>20180520</div><div>tensorflow-gpuインストール手順ものすごく苦労した...</div><div><br/></div><div>tensorflow-gpuインストール手順は</div><div><a href="https://www.sejuku.net/blog/43784">https://www.sejuku.net/blog/43784</a></div><div>と</div><div><a href="http://www.python36.com/install-tensorflow-gpu-windows/">http://www.python36.com/install-tensorflow-gpu-windows/</a></div><div>と</div><div><a href="http://suechan.hateblo.jp/entry/2017/12/23/235835">http://suechan.hateblo.jp/entry/2017/12/23/235835</a></div><div>のサイトが参考になった</div><div>大まかな手順は</div><div>1．GeForce 1080に合ったNVIDIAドライバをダウンロードしインストール：<a href="http://www.nvidia.co.jp/Download/index.aspx?lang=jp" rev="en_rl_none">http://www.nvidia.co.jp/Download/index.aspx?lang=jp</a></div><div>　ダウンロードしたファイル&lt;&lt; C:\Users\shingo\Downloads\02.dl_cuda\01.installed\397.64-desktop-win10-64bit-international-whql.exe &gt;&gt;</div><div><br/></div><div>2．CUDA Toolkit 9.0をダウンロード：<a href="https://developer.nvidia.com/cuda-90-download-archive" rev="en_rl_none">https://developer.nvidia.com/cuda-90-download-archive</a></div><div>　ダウンロードしたファイル&lt;&lt; C:\Users\shingo\Downloads\02.dl_cuda\01.installed\cuda_9.0.176_win10.exe &gt;&gt;</div><div><br/></div><div>3．cuDNN v7.0.5 for CUDA 9.0をダウンロード：<a href="https://developer.nvidia.com/rdp/cudnn-download" rev="en_rl_none">https://developer.nvidia.com/rdp/cudnn-download</a></div><div>　ダウンロードしたファイル&lt;&lt; C:\Users\shingo\Downloads\02.dl_cuda\01.installed\cudnn-9.0-windows10-x64-v7.zip &gt;&gt;</div><div>　→注意：cuDNNのダウンロードはユーザ登録が必要。ユーザ登録確認のメールはすぐに来る。</div><div>　　cuDnnダウンロード&lt; <a href="https://developer.nvidia.com/rdp/cudnn-archive" rev="en_rl_none">https://developer.nvidia.com/rdp/cudnn-archive</a> &gt;でユーザー登録した</div><div>　　mail：<a href="mailto:rironyokoi@gmail.com" rev="en_rl_none">rironyokoi@gmail.com</a></div><div>　　password:Shingorider1</div><div>　　ユーザ名：anonamename</div><div><br/></div><div>4．Visual Studio 2015 Update 3（Visual Studio Community 2015 with Update 3）ダウンロードしインストール：<a href="https://my.visualstudio.com/Downloads" rev="en_rl_none">https://my.visualstudio.com/Downloads</a></div><div>　ダウンロードしたファイル&lt;&lt; C:\Users\shingo\Downloads\02.dl_cuda\01.installed\ja_visual_studio_community_2015_with_update_3_x86_x64_web_installer_8922964.exe &gt;&gt;</div><div>　→注意1：古いバージョンのVisual StudioなのでMicrosoftのDeveloper Accountでサインインしないとダウンロードサイトに入れな</div><div>　→注意2：Visual Studio 2015のインストールはカスタムでインストールすること</div><div>　　&gt; カスタムインストールに進み、Visual C ++とPython Tools for Visual Studioをプログラミング言語の中にインストールしてください。インストールを完了します。</div><div>　2017版のVisual Studio入れて消してを繰り返したのでインストールできなかった以下の項目があった</div><div>　　インスールでMicrosoft Visual C++ *** Redistriburable</div><div>　コントロール パネル\プログラム\プログラムと機能</div><div>　で</div><div>　c++ redist</div><div>　検索かけて</div><div>　Microsoft Visual C++ *** Redistriburable 2016 以上のプログラムは削除する</div><div><br/></div><div>5．Visual Studio 2015 の Visual C++ 再頒布可能パッケージをダウンロードしインストール：<a href="https://www.microsoft.com/ja-JP/download/details.aspx?id=48145" rev="en_rl_none">https://www.microsoft.com/ja-JP/download/details.aspx?id=48145</a></div><div>　ダウンロードしたファイル&lt;&lt; C:\Users\shingo\Downloads\02.dl_cuda\01.installed\vc_redist.x64.exe &gt;&gt;</div><div>　これは多分Microsoft Visual C++ *** Redistriburable 2015 のプログラム</div><div><br/></div><div>6. CUDA Toolkit 9.0インストールする</div><div>　CUDA Toolkit 9.0インストールでVisual Studio 2015が必要みたい</div><div>　デフォルトでインストールすると</div><div>　Visual studio integration</div><div>　のインスールに失敗してエラーになる</div><div>　→カスタムインストールにして</div><div>　　Visual studio integration</div><div>　　だけ除いてインストール実行した。（Visual studio integration だけどうしても入らないので。。。）</div><div><br/></div><div>7. install tensorflow-gpu</div><div>　Windowsでは  conda install tensorflow-gpu ではv1.1のtensorflowしかない。。。</div><div>　なのでpipでしかインストールできない。。。</div><div>　別環境 tensorflow-gpu 作成してpip試した</div><div>(tfgpu_pip) C:\Users\shingo&gt;pip install --upgrade tensorflow-gpu</div><div>Collecting tensorflow-gpu</div><div> Downloading <a href="https://files.pythonhosted.org/packages/42/a8/4c96a2b4f88f5d6dfd70313ebf38de1fe4d49ba9bf2ef34dc12dd198ab9a/tensorflow_gpu-1.8.0-cp36-cp36m-win_amd64.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/42/a8/4c96a2b4f88f5d6dfd70313ebf38de1fe4d49ba9bf2ef34dc12dd198ab9a/tensorflow_gpu-1.8.0-cp36-cp36m-win_amd64.whl</a> (88.9MB)</div><div>   100% |????????????????????????????????| 88.9MB 290kB/s</div><div>Collecting termcolor&gt;=1.1.0 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/8a/48/a76be51647d0eb9f10e2a4511bf3ffb8cc1e6b14e9e4fab46173aa79f981/termcolor-1.1.0.tar.gz" rev="en_rl_none">https://files.pythonhosted.org/packages/8a/48/a76be51647d0eb9f10e2a4511bf3ffb8cc1e6b14e9e4fab46173aa79f981/termcolor-1.1.0.tar.gz</a></div><div>Collecting gast&gt;=0.2.0 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/5c/78/ff794fcae2ce8aa6323e789d1f8b3b7765f601e7702726f430e814822b96/gast-0.2.0.tar.gz" rev="en_rl_none">https://files.pythonhosted.org/packages/5c/78/ff794fcae2ce8aa6323e789d1f8b3b7765f601e7702726f430e814822b96/gast-0.2.0.tar.gz</a></div><div>Collecting grpcio&gt;=1.8.6 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/60/61/d4886a79db5581d6169ec651351212ee503a6759abc5c575b6263256e4be/grpcio-1.12.0-cp36-cp36m-win_amd64.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/60/61/d4886a79db5581d6169ec651351212ee503a6759abc5c575b6263256e4be/grpcio-1.12.0-cp36-cp36m-win_amd64.whl</a> (1.4MB)</div><div>   100% |????????????????????????????????| 1.4MB 7.9MB/s</div><div>Collecting absl-py&gt;=0.1.6 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/f7/69/6c86a51c6cf5ad6f09a54c9a7aae09850166af8d99cf1418e9ea9250baca/absl-py-0.2.1.tar.gz" rev="en_rl_none">https://files.pythonhosted.org/packages/f7/69/6c86a51c6cf5ad6f09a54c9a7aae09850166af8d99cf1418e9ea9250baca/absl-py-0.2.1.tar.gz</a> (81kB)</div><div>   100% |????????????????????????????????| 92kB 10.2MB/s</div><div>Collecting six&gt;=1.10.0 (from tensorflow-gpu)</div><div> Using cached <a href="https://files.pythonhosted.org/packages/67/4b/141a581104b1f6397bfa78ac9d43d8ad29a7ca43ea90a2d863fe3056e86a/six-1.11.0-py2.py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/67/4b/141a581104b1f6397bfa78ac9d43d8ad29a7ca43ea90a2d863fe3056e86a/six-1.11.0-py2.py3-none-any.whl</a></div><div>Requirement not upgraded as not directly required: wheel&gt;=0.26 in c:\users\shingo\anaconda3\envs\tfgpu_pip\lib\site-packages (from tensorflow-gpu) (0.31.1)</div><div>Collecting tensorboard&lt;1.9.0,&gt;=1.8.0 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/59/a6/0ae6092b7542cfedba6b2a1c9b8dceaf278238c39484f3ba03b03f07803c/tensorboard-1.8.0-py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/59/a6/0ae6092b7542cfedba6b2a1c9b8dceaf278238c39484f3ba03b03f07803c/tensorboard-1.8.0-py3-none-any.whl</a> (3.1MB)</div><div>   100% |????????????????????????????????| 3.1MB 6.4MB/s</div><div>Collecting numpy&gt;=1.13.3 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/af/e4/7d7107bdfb5c33f6cf33cdafea8c27d1209cf0068a6e3e3d3342be6f3578/numpy-1.14.3-cp36-none-win_amd64.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/af/e4/7d7107bdfb5c33f6cf33cdafea8c27d1209cf0068a6e3e3d3342be6f3578/numpy-1.14.3-cp36-none-win_amd64.whl</a> (13.4MB)</div><div>   100% |????????????????????????????????| 13.4MB 3.2MB/s</div><div>Collecting protobuf&gt;=3.4.0 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/32/cf/6945106da76db9b62d11b429aa4e062817523bb587018374c77f4b63200e/protobuf-3.5.2.post1-cp36-cp36m-win_amd64.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/32/cf/6945106da76db9b62d11b429aa4e062817523bb587018374c77f4b63200e/protobuf-3.5.2.post1-cp36-cp36m-win_amd64.whl</a> (958kB)</div><div>   100% |????????????????????????????????| 962kB 9.3MB/s</div><div>Collecting astor&gt;=0.6.0 (from tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/b2/91/cc9805f1ff7b49f620136b3a7ca26f6a1be2ed424606804b0fbcf499f712/astor-0.6.2-py2.py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/b2/91/cc9805f1ff7b49f620136b3a7ca26f6a1be2ed424606804b0fbcf499f712/astor-0.6.2-py2.py3-none-any.whl</a></div><div>Collecting html5lib==0.9999999 (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/ae/ae/bcb60402c60932b32dfaf19bb53870b29eda2cd17551ba5639219fb5ebf9/html5lib-0.9999999.tar.gz" rev="en_rl_none">https://files.pythonhosted.org/packages/ae/ae/bcb60402c60932b32dfaf19bb53870b29eda2cd17551ba5639219fb5ebf9/html5lib-0.9999999.tar.gz</a> (889kB)</div><div>   100% |????????????????????????????????| 890kB 8.5MB/s</div><div>Collecting werkzeug&gt;=0.11.10 (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/20/c4/12e3e56473e52375aa29c4764e70d1b8f3efa6682bef8d0aae04fe335243/Werkzeug-0.14.1-py2.py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/20/c4/12e3e56473e52375aa29c4764e70d1b8f3efa6682bef8d0aae04fe335243/Werkzeug-0.14.1-py2.py3-none-any.whl</a> (322kB)</div><div>   100% |????????????????????????????????| 327kB 9.3MB/s</div><div>Collecting markdown&gt;=2.6.8 (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/6d/7d/488b90f470b96531a3f5788cf12a93332f543dbab13c423a5e7ce96a0493/Markdown-2.6.11-py2.py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/6d/7d/488b90f470b96531a3f5788cf12a93332f543dbab13c423a5e7ce96a0493/Markdown-2.6.11-py2.py3-none-any.whl</a> (78kB)</div><div>   100% |????????????????????????????????| 81kB 8.2MB/s</div><div>Collecting bleach==1.5.0 (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu)</div><div> Downloading <a href="https://files.pythonhosted.org/packages/33/70/86c5fec937ea4964184d4d6c4f0b9551564f821e1c3575907639036d9b90/bleach-1.5.0-py2.py3-none-any.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/33/70/86c5fec937ea4964184d4d6c4f0b9551564f821e1c3575907639036d9b90/bleach-1.5.0-py2.py3-none-any.whl</a></div><div>Requirement not upgraded as not directly required: setuptools in c:\users\shingo\anaconda3\envs\tfgpu_pip\lib\site-packages (from protobuf&gt;=3.4.0-&gt;tensorflow-gpu) (39.1.0)</div><div>Building wheels for collected packages: termcolor, gast, absl-py, html5lib</div><div> Running setup.py bdist_wheel for termcolor ... done</div><div> Stored in directory: C:\Users\shingo\AppData\Local\pip\Cache\wheels\7c\06\54\bc84598ba1daf8f970247f550b175aaaee85f68b4b0c5ab2c6</div><div> Running setup.py bdist_wheel for gast ... done</div><div> Stored in directory: C:\Users\shingo\AppData\Local\pip\Cache\wheels\9a\1f\0e\3cde98113222b853e98fc0a8e9924480a3e25f1b4008cedb4f</div><div> Running setup.py bdist_wheel for absl-py ... done</div><div> Stored in directory: C:\Users\shingo\AppData\Local\pip\Cache\wheels\84\69\e0\6f4b789daf6cae7e70e5fda095603c7746cdc1a6013303c7ff</div><div> Running setup.py bdist_wheel for html5lib ... done</div><div> Stored in directory: C:\Users\shingo\AppData\Local\pip\Cache\wheels\50\ae\f9\d2b189788efcf61d1ee0e36045476735c838898eef1cad6e29</div><div>Successfully built termcolor gast absl-py html5lib</div><div>Installing collected packages: termcolor, gast, six, grpcio, absl-py, html5lib, werkzeug, markdown, bleach, numpy, protobuf, tensorboard, astor, tensorflow-gpu</div><div>Successfully installed absl-py-0.2.1 astor-0.6.2 bleach-1.5.0 gast-0.2.0 grpcio-1.12.0 html5lib-0.9999999 markdown-2.6.11 numpy-1.14.3 protobuf-3.5.2.post1 six-1.11.0 tensorboard-1.8.0 tensorflow-gpu-1.8.0 termcolor-1.1.0 werkzeug-0.14.1</div><div><br/></div><div>(tfgpu_pip) C:\Users\shingo&gt;python</div><div>Python 3.6.5 |Anaconda, Inc.| (default, Mar 29 2018, 13:32:41) [MSC v.1900 64 bit (AMD64)] on win32</div><div>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</div><div><br/></div><div>実行後</div><div>import numpy</div><div>import tensorflow</div><div>できた</div><div><br/></div><div>tfgpu環境でも</div><div>import numpy</div><div>できた</div><div><br/></div><div>tfgpu環境でもpipで入れた</div><div>(tfgpu) C:\Users\shingo&gt;pip install --upgrade tensorflow-gpu</div><div>Collecting tensorflow-gpu</div><div> Downloading <a href="https://files.pythonhosted.org/packages/42/97/ce28b1651b59cafb6abd2d62df2856b6c139c8f3eb5a0f66ca41ca33ab92/tensorflow_gpu-1.8.0-cp35-cp35m-win_amd64.whl" rev="en_rl_none">https://files.pythonhosted.org/packages/42/97/ce28b1651b59cafb6abd2d62df2856b6c139c8f3eb5a0f66ca41ca33ab92/tensorflow_gpu-1.8.0-cp35-cp35m-win_amd64.whl</a> (88.9MB)</div><div>   100% |################################| 88.9MB 229kB/s</div><div>Requirement not upgraded as not directly required: six&gt;=1.10.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (1.11.0)</div><div>Requirement not upgraded as not directly required: wheel&gt;=0.26 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (0.31.1)</div><div>Requirement not upgraded as not directly required: grpcio&gt;=1.8.6 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (1.11.0)</div><div>Requirement not upgraded as not directly required: protobuf&gt;=3.4.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (3.5.2)</div><div>Requirement not upgraded as not directly required: absl-py&gt;=0.1.6 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (0.2.0)</div><div>Requirement not upgraded as not directly required: tensorboard&lt;1.9.0,&gt;=1.8.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (1.8.0)</div><div>Requirement not upgraded as not directly required: gast&gt;=0.2.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (0.2.0)</div><div>Requirement not upgraded as not directly required: termcolor&gt;=1.1.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (1.1.0)</div><div>Requirement not upgraded as not directly required: numpy&gt;=1.13.3 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (1.14.2)</div><div>Requirement not upgraded as not directly required: astor&gt;=0.6.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorflow-gpu) (0.6.2)</div><div>Requirement not upgraded as not directly required: setuptools in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from protobuf&gt;=3.4.0-&gt;tensorflow-gpu) (39.1.0)</div><div>Requirement not upgraded as not directly required: werkzeug&gt;=0.11.10 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu) (0.14.1)</div><div>Requirement not upgraded as not directly required: bleach==1.5.0 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu) (1.5.0)</div><div>Requirement not upgraded as not directly required: markdown&gt;=2.6.8 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu) (2.6.11)</div><div>Requirement not upgraded as not directly required: html5lib==0.9999999 in c:\users\shingo\anaconda3\envs\tfgpu\lib\site-packages (from tensorboard&lt;1.9.0,&gt;=1.8.0-&gt;tensorflow-gpu) (0.9999999)</div><div>Installing collected packages: tensorflow-gpu</div><div>Successfully installed tensorflow-gpu-1.8.0</div><div><br/></div><div>(tfgpu) C:\Users\shingo&gt;python</div><div>Python 3.5.5 |Anaconda, Inc.| (default, Apr  7 2018, 04:52:34) [MSC v.1900 64 bit (AMD64)] on win32</div><div>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</div><div>&gt;&gt;&gt; import numpy</div><div>&gt;&gt;&gt; import tensorflow</div><div>C:\Users\shingo\Anaconda3\envs\tfgpu\lib\site-packages\h5py\__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.</div><div> from ._conv import register_converters as _register_converters</div><div>&gt;&gt;&gt;</div><div><br/></div><div>importエラーにならないのでいけてそう</div><div><br/></div><div><span style="font-weight: bold;"># object_detection のインストール</span></div><div>0 <a href="https://github.com/tensorflow/models.git" rev="en_rl_none">https://github.com/tensorflow/models.git</a> でライブラリダウンロード</div><div>1 <a href="https://github.com/google/protobuf" rev="en_rl_none">https://github.com/google/protobuf</a> でprotoc_3.3 ダウンロード</div><div>2 protoc_3.3のprotoc.exe を models\research にコピー</div><div>models\research  で以下のコマンド実行</div><div>3 $ protoc object_detection/protos/*.proto --python_out=.</div><div>4 $ python object_detection/builders/model_builder_test.py # ビルド</div><div><br/></div><div><br/></div><div>環境変数追加した</div><div>Path:C:\Program Files\NVIDIA Corporation\NVSMI\</div><div>PYTHONPATH:C:\Users\shingo\Git\models\research;C:\Users\shingo\Git\models\research\slim;C:\Users\shingo\Git\models\research\object_detection;</div><div><br/></div><div>必要かわからないけどLimuxのときと同じように</div><div>CUDA_ROOT：C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v9.0</div><div>LD_LIBRARY_PATH：C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v9.0\lib\x64</div><div>LIBRARY_PATH：C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v9.0\lib\x64</div><div>も環境変数に追加した</div><div><br/></div><div><br/></div><div><br/></div><div>-----------------------------</div><div>20180627</div><div># Augmentor: 機械学習用にイメージデータを水増しするpythonライブラリ で必要</div><div>conda install -c conda-forge tqdm</div><div><br/></div><div># ハイパーパラメータを最適化するために探索を行うhyperoptというpythonのライブラリ で必要</div><div>conda install -c conda-forge future</div><div>conda install -c anaconda networkx</div><div><br/></div><div><br/></div><div>-----------------------------</div><div>20180717</div><div># keras-facenet（顔認識に特化したモデルkeras版&lt;&lt;<a href="https://github.com/nyoki-mtl/keras-facenet" rev="en_rl_none">https://github.com/nyoki-mtl/keras-facenet</a>&gt;&gt;）動かすのに必要だった</div><div>conda install -c conda-forge imageio</div><div>conda install -c conda-forge scikit-image</div><div># keras-facenetのモデルメモリに乗せるところでjupyterのカーネルが落ちる。動かせない（作業dir:C:\Users\shingo\Git\keras-facenet\notebook）。落ちる原因は多分モデルがでかすぎでメモリ足りないため</div><div><br/></div><div><br/></div><div>-----------------------------</div><div>20180830</div><div># scikit-learn 更新した</div><div>conda install -c conda-forge scikit-learn</div><div><br/></div><div><br/></div><div># 20180909</div><div># pythonでクリップボードの内容コピペできるパッケージ入れた</div><div>conda install -c conda-forge pyperclip</div><div>import pyperclip</div><div>pyperclip.paste()# クリップボードの内容出力</div><div><br/></div><div>20181003</div><div>conda install -c conda-forge tqdm</div><div>conda install -c conda-forge pytest</div><div>conda install -c conda-forge requests</div><div>conda install -c conda-forge beautifulsoup4</div><div><br/></div><div>20181231</div><div># tfgpu_py36 環境がconda install できなくなった。。。。</div><div># RecursionError: maximum recursion depth exceeded が出てインストールできない。。。。</div><div>→pipでtensorflow入れたこの環境はなぜかinstall できる</div><div>　新規で作ったtfgpu_py35, tfgpu_py36_v2 どちらもRecursionError でconda install できない。。。</div><div># tfgpu_py36 に入れたライブラリ入れ直す</div><div>conda install -c conda-forge future</div><div>conda install -c conda-forge graphviz</div><div>conda install -c conda-forge pydot</div><div># conda install -c conda-forge scipy # もう入っていた</div><div>conda install -c conda-forge selenium</div><div>conda install -c conda-forge cssselect</div><div>conda install -c conda-forge lxml</div><div>conda install -c conda-forge openpyxl</div><div>conda install -c conda-forge papermill</div><div>conda install -c conda-forge pypdf2</div><div>conda install -c conda-forge python-docx</div><div>conda install -c conda-forge tweepy # Twitter APIにアクセスするための使いやすいPythonライブラリ</div><div>conda install -c conda-forge textblob # Pythonのテキスト処理。感情分析、品詞タグ付け、名詞句解析など</div><div>conda install -c conda-forge seaborn # 統計データの可視化</div><div>conda install -c conda-forge scikit-image # SciPyの画像処理ライブラリ</div><div>conda install -c conda-forge imbalanced-learn # アンダーサンプリングとオーバーサンプリングを使用してデータセットのバランスをとるPythonモジュール</div><div>conda install -c pjamesjoyce imutils# OpenCVとPython 2.7とPython 3の両方で 、翻訳、回転、サイズ変更、スケルトン化、Matplotlib画像の表示などの基本的な画像処理機能を簡単に行うための一連の便利な機能</div><div># PFNが世に送り出した最適化枝刈りライブラリOptuna ダウンロード（pipでしか入れれないからとりあえずgitのファイルとってきた）</div><div>(tfgpu_py36) C:\Users\shingo\Git&gt;git clone <a href="https://github.com/pfnet/optuna.git" rev="en_rl_none">https://github.com/pfnet/optuna.git</a></div><div># Optuna の依存ライブラリconda から取得</div><div>conda install -c conda-forge colorlog # 色付きのログフォーマット</div><div>conda install -c conda-forge sqlalchemy # データベース抽象化ライブラリ</div><div># 画像変換ライブラリimgaug(<a href="https://github.com/aleju/imgaug" rev="en_rl_none">https://github.com/aleju/imgaug</a>) の依存ライブラリ追加</div><div>(tfgpu_py36) C:\Users\shingo\Git&gt;git clone <a href="https://github.com/aleju/imgaug.git" rev="en_rl_none">https://github.com/aleju/imgaug.git</a></div><div>conda install -c conda-forge shapely # デカルト平面内の幾何学的オブジェクトの操作と分析のためのPythonパッケージ</div><div>conda install -c conda-forge imageio # もう入ってた</div><div><br/></div><hr/><div><span style="font-weight: bold;">tfgpu_py36環境に入れたライブラリ.txt</span></div><div><br/></div><div>20181003</div><div># python3.6版のtensorflow環境作成する</div><div># 複数パッケージ一気に入れたら環境壊れたので1つずつ入れてみた</div><div># チャンネルは <a href="https://anaconda.org/" rev="en_rl_none">https://anaconda.org/</a> で検索してダウンロード数多いのにした</div><div># conda remove -n tfgpu_py36 --all</div><div>#</div><div><br/></div><div>conda create -n tfgpu_py36</div><div>activate tfgpu_py36</div><div>conda install python=3.6</div><div>conda install -c anaconda tensorflow-gpu=1.8 # tfgpu環境と同じバージョンにしとく</div><div>conda install -c conda-forge keras=2.1.5 # tfgpu環境と同じバージョンにしとく</div><div>conda install -c conda-forge numpy</div><div>conda install -c conda-forge pandas</div><div>conda install -c conda-forge scikit-learn</div><div>conda install -c conda-forge Cython</div><div>conda install -c conda-forge opencv</div><div>conda install -c conda-forge git # ここでなにか変なのでた</div><div>conda install -c conda-forge jupyter</div><div>#conda install -c conda-forge Protobuf # anaconda でもう入っていた</div><div>conda install -c conda-forge Pillow</div><div>conda install -c conda-forge lxml</div><div>conda install -c conda-forge Matplotlib</div><div>conda install -c conda-forge tqdm</div><div>conda install -c conda-forge future</div><div>conda install -c conda-forge pytest</div><div>conda install -c conda-forge pyperclip</div><div>conda install -c conda-forge networkx</div><div>conda install -c conda-forge graphviz</div><div>conda install -c conda-forge pydot</div><div># conda install -c conda-forge scipy # もう入っていた</div><div><br/></div><div># jupyterのカーネルの起動でエラーになるためjupyterをanaconda リポジトリから入れ直した</div><div>conda install -c anaconda jupyter</div><div>→C:\Users\shingo\Anaconda3\envs\tfgpu_py36\share\jupyter\kernels\python3</div><div>のpythonのパスが間違っていた</div><div>C:\\Users\\shingo\\Anaconda3\\envs\\tfgpu_py36\\python.exe</div><div>に変更した</div><div>→jupyter 起動できた。</div><div><br/></div><div><br/></div><div>20181007</div><div>conda install -c conda-forge selenium</div><div>conda install -c conda-forge beautifulsoup4</div><div>conda install -c conda-forge cssselect</div><div>conda install -c conda-forge lxml</div><div>conda install -c conda-forge openpyxl</div><div><br/></div><div>20181008</div><div>conda install -c conda-forge pypdf2</div><div>conda install -c conda-forge python-docx</div><div>conda install -c conda-forge requests</div><div><br/></div><div>20181013</div><div><a href="http://ossyaritoori.hatenablog.com/entry/2017/06/01/Keras%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E3%81%8CTheano%E3%81%8B%E3%82%89%E5%A4%89%E6%9B%B4%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E8%A9%B1">http://ossyaritoori.hatenablog.com/entry/2017/06/01/Keras%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E3%81%8CTheano%E3%81%8B%E3%82%89%E5%A4%89%E6%9B%B4%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F%E8%A9%B1</a></div><div>より</div><div>バックエンド変更は</div><div>C:\Users\shingo\Anaconda3\envs\tf14\etc\conda\activate.d</div><div>を</div><div>tensorflow</div><div>に変更</div><div>conda install -c conda-forge papermill</div><div><br/></div><div>20181026</div><div>conda install -c conda-forge tweepy# Twitter APIにアクセスするための使いやすいPythonライブラリ</div><div>conda install -c conda-forge textblob# Pythonのテキスト処理。感情分析、品詞タグ付け、名詞句解析など</div><div>conda install -c conda-forge seaborn# 統計データの可視化</div><div>conda install -c conda-forge scikit-image# SciPyの画像処理ライブラリ</div><div>conda install -c conda-forge imbalanced-learn# アンダーサンプリングとオーバーサンプリングを使用してデータセットのバランスをとるPythonモジュール</div><div><br/></div><div>20181030</div><div>conda install -c pjamesjoyce imutils# OpenCVとPython 2.7とPython 3の両方で 、翻訳、回転、サイズ変更、スケルトン化、Matplotlib画像の表示などの基本的な画像処理機能を簡単に行うための一連の便利な機能</div><div><br/></div><div>20181223</div><div># PFNが世に送り出した最適化枝刈りライブラリOptuna ダウンロード（pipでしか入れれないからとりあえずgitのファイルとってきた）</div><div>(tfgpu_py36) C:\Users\shingo\Git&gt;git clone <a href="https://github.com/pfnet/optuna.git" rev="en_rl_none">https://github.com/pfnet/optuna.git</a></div><div><br/></div><div># Optuna の依存ライブラリconda から取得</div><div>conda install -c conda-forge colorlog # 色付きのログフォーマット</div><div>conda install -c conda-forge sqlalchemy # データベース抽象化ライブラリ</div><div><br/></div><div>20181231</div><div>自宅環境のtfgpu_py36環境いきなりconda install できなくなった。。。。</div><div>anaconda から入れたtensorflow環境 のせい？</div><div>（pipからいれたtfgpu環境はconda install できるので）</div><div><br/></div><hr/><div><span style="font-weight: bold;">tfgpu_py36_v2環境に入れたライブラリ.txt</span></div><div>20190102</div><div># chainer入れたらtfgpu_py36 環境壊れたのでpython3.6版のtensorflow環境作り直す</div><div># チャンネルは <a href="https://anaconda.org/" rev="en_rl_none">https://anaconda.org/</a> で検索してダウンロード数多いのにした</div><div>※20181231 に一回作成したが</div><div>　conda install -c anaconda jupyter</div><div>　実行後、RecursionError: maximum recursion depth exceeded が出てconda installできなくなり、</div><div>　conda remove -n tfgpu_py36_v2 --all</div><div>　で一回環境消して、再度作成した</div><div>　anaconda jupyter がおかしくなる原因？？</div><div>※conda-forge 以外のリポジトリから入れるとconda installできなくなるみたい</div><div>　conda install -c pjamesjoyce imutils</div><div>　実行したら、conda installできなくなったので、もっかいtfgou_py36_v2環境消した</div><div><br/></div><div>conda create -n tfgpu_py36_v2</div><div>activate tfgpu_py36_v2</div><div>conda install python=3.6</div><div>conda install -c anaconda tensorflow-gpu=1.8 # tfgpu環境と同じバージョンにしとく</div><div>conda install -c conda-forge keras=2.1.5 # tfgpu環境と同じバージョンにしとく</div><div><br/></div><div># DeepLaerning 系ライブラリ</div><div>conda install -c conda-forge pandas scikit-learn jupyter Cython Protobuf Pillow lxml Matplotlib</div><div><br/></div><div># 本「退屈なことはpythonにやらせよう」(webブラウザ系が主)で使うライブラリ</div><div>conda install -c conda-forge tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests</div><div><br/></div><div># 小さなデータセットで良い分類器を学習させるとき</div><div>　<a href="https://qiita.com/daisukelab/items/381099590f22e4f9ab1f" rev="en_rl_none">https://qiita.com/daisukelab/items/381099590f22e4f9ab1f</a></div><div>　で主に必要だったライブラリ</div><div>　（conda install -c pjamesjoyce imutils は実行しない）</div><div>conda install -c conda-forge tweepy textblob seaborn scikit-image imbalanced-learn</div><div><br/></div><div># Optuna (PFNが世に送り出した最適化枝刈りライブラリ git clone <a href="https://github.com/pfnet/optuna.git" rev="en_rl_none">https://github.com/pfnet/optuna.git</a>)の依存ライブラリ</div><div>conda install -c conda-forge colorlog sqlalchemy</div><div><br/></div><div># git はなにか変なのでるので単一でインストールした</div><div>conda install -c conda-forge git</div><div><br/></div><div># install 漏れ</div><div>conda install -c conda-forge papermill</div><div>conda install -c conda-forge opencv</div><div><br/></div><div># 画像変換ライブラリimgaug(<a href="https://github.com/aleju/imgaug" rev="en_rl_none">https://github.com/aleju/imgaug</a>) の依存ライブラリ追加</div><div>(tfgpu_py36) C:\Users\shingo\Git&gt;git clone <a href="https://github.com/aleju/imgaug.git" rev="en_rl_none">https://github.com/aleju/imgaug.git</a></div><div>conda install -c conda-forge shapely imageio</div><div><br/></div><div># 機械学習系ライブラリ</div><div>conda install -c conda-forge eli5 # kaggleで書いてた機械学習ライブラリ。XGBoostとかある。 OpenCVがconda-forgeじゃなくなる</div><div>→eli5 入れたらconda install できなくなった。。。（20190214）</div><div><br/></div><hr/><div><span style="font-weight: bold;">tfgpu_py36_v3環境に入れたライブラリ.txt</span></div><div>20190214</div><div># eli5入れたらtfgpu_py36_v2 環境壊れたのでpython3.6版のtensorflow環境作り直す</div><div>conda create -n tfgpu_py36_v3</div><div>activate tfgpu_py36_v2</div><div>conda install python=3.6</div><div>conda install -c anaconda tensorflow-gpu=1.8 # tfgpu環境と同じバージョンにしとく</div><div><br/></div><div># 機械学習系ライブラリ</div><div>conda install -c conda-forge eli5 # kaggleで書いてた機械学習ライブラリ。XGBoostとかある。 OpenCVがconda-forgeじゃなくなる</div><div><br/></div><div>conda install -c conda-forge keras=2.1.5 # tfgpu環境と同じバージョンにしとく</div><div><br/></div><div># DeepLaerning 系ライブラリ</div><div>conda install -c conda-forge pandas scikit-learn jupyter Cython Protobuf Pillow lxml Matplotlib</div><div><br/></div><div>→conda install できなくなった。。。eli5とpandas scikit-learn jupyter Cython Protobuf Pillow lxml Matplotlibのどれかが競合してるっぽい。。。</div><div><br/></div><div>------------------------------------------------------------------------------------</div><div>20190214</div><div>削除してtfgpu_py36_v2と同じ環境（ <span style="font-weight: bold;">tfgpu_py36_v3</span> ）作り直す</div><div>※# DeepLaerning 系ライブラリ+…のコマンド実行後、conda install -c conda-forge git など実行すると、依存ライブラリがconda-forge以外になると、conda install できなくなるみたい。。。また削除して作り直した</div><div>deactivate</div><div>conda remove -n tfgpu_py36_v3 --all</div><div><br/></div><div>conda create -n tfgpu_py36_v3</div><div>activate tfgpu_py36_v3</div><div>conda install python=3.6</div><div>conda install -c anaconda tensorflow-gpu=1.8 # tfgpu環境と同じバージョンにしとく</div><div>conda install -c conda-forge keras=2.1.5 # tfgpu環境と同じバージョンにしとく</div><div><br/></div><div># DeepLaerning 系ライブラリ+本「退屈なことはpythonにやらせよう」(webブラウザ系が主)で使うライブラリ+小さなデータセットで良い分類器を学習させるとき+Optuna (PFNが世に送り出した最適化枝刈りライブラリ git clone <a href="https://github.com/pfnet/optuna.git" rev="en_rl_none">https://github.com/pfnet/optuna.git</a>)の依存ライブラリ+画像変換ライブラリimgaug(<a href="https://github.com/aleju/imgaug" rev="en_rl_none">https://github.com/aleju/imgaug</a>) の依存ライブラリ追加+papermill+opencv+git+機械学習モデルの予測の寄与内容示すライブラリ(shap eli5)+umap</div><div>conda install -c conda-forge pandas scikit-learn jupyter Cython Protobuf Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill opencv shapely imageio git shap eli5 umap-learn</div><div><br/></div><div>20190307</div><div>Optuna_v0.7.0でplotlyが必要だった。リポジトリconda-forge で統一するようにopencv も一緒に入れた</div><div>conda install -c conda-forge plotly opencv</div><div><br/></div><div># 20190319</div><div>conda install -c conda-forge ipysheet opencv # ipywidgets はすでに入っていた</div><div>conda install -c conda-forge bqplot opencv # bqplotは ipysheet で必要だったplot系のライブラリ</div><div><br/></div><div>20190322</div><div>conda install -c conda-forge rise opencv # rise:jupyter でスライド作るライブラリ</div><div>conda install -c conda-forge bokeh opencv # bokeh: オシャレかつインタラクティブなグラフが書ける。かなり自由度が高く高機能である</div><div>conda install -c conda-forge jupyter_contrib_nbextensions opencv # jupyter_contrib_nbextensions: Jupyterに機能を追加するextensionを集めたレポジトリ</div><div>conda install -c conda-forge yapf opencv # yapf: riseの依存ライブラリ</div><div>conda install -c conda-forge flask opencv # webフレームワークflask 入れてみた</div><div><br/></div><div>20190507</div><div>conda install -c conda-forge joblib opencv # Githubのkeras-arcfaceで joblib  が必要なので。opencvのバージョンもなぜか上がる</div><div><br/></div><div>20190526</div><div>conda install -c conda-forge lightgbm opencv=4.1.0 grpcio=1.16 #  lightgbm: 決定木アルゴリズムに基づいた勾配ブースティング（Gradient Boosting）の機械学習フレームワーク　XGBoostより速いらしい</div><div><span style="text-decoration: line-through;">conda install -c conda-forge xgboost</span> #   XGBoost はなぜかインストールできない。。。XGBoostもLigtGBMとおなじく決定木の勾配ブースティングのフレームワーク</div><div><br/></div><div>20190619</div><div>conda install -c conda-forge opencv=4.1.0 dill # custom_objectでモデルロードするとき関数内の関数呼び出すのにdillが必要</div><div>conda install -c conda-forge scikit-learn # sklearn 0.21.2にupdate。sklearn.metrics.multilabel_confusion_matrix()を使うために→ multilabel_confusion_matrixうまく使えなかった</div><div><br/></div><div>20190706</div><div><span style="font-weight: bold;">anaconda promptを管理者権限で開かないとconda install できなくなっていた（jupyterで流してるkerasのjob落としたら管理者じゃなくてもconda installできた）</span></div><div>conda install -c conda-forge alembic # optuna v 0.13で必要だった（optunaのディレクトリで $ git pull origin master してoptuna更新した）</div><div>conda install -c conda-forge scikit-learn=0.20 # eli5パッケージでimport errorになったからバージョンもどした</div><div><br/></div><div>20190718</div><div>conda install -c conda-forge lime # 分類モデルの局所的な判断根拠を示すlime ( Local Interpretable Model-agnostic Explanations ) # certifi と openssl も更新された</div><div><br/></div><div>20190723</div><div>conda install -c conda-forge ipywidgets #  ipywidgets  更新。ipywidgets 7.5.0と widgetsnbextension-3.5.0 を入れた</div><div><br/></div><div>20190922</div><div>conda install -c conda-forge pyxley # RのshinyみたいなFlask、PyReact、およびPandasを使用したシンプルなWebアプリケーション作れるパッケージ <a href="https://pyxley.readthedocs.io/en/latest/" rev="en_rl_none">https://pyxley.readthedocs.io/en/latest/</a> → イマイチだった。reactive機能なさそうなので</div><div><br/></div><div>conda install -c conda-forge dash # Pythonの可視化ライブラリであり、分析Webアプリケーションを構築するためのPythonフレームワーク  <a href="https://towardsdatascience.com/how-to-build-a-complex-reporting-dashboard-using-dash-and-plotl-4f4257c18a7f" rev="en_rl_none">https://towardsdatascience.com/how-to-build-a-complex-reporting-dashboard-using-dash-and-plotl-4f4257c18a7f</a></div><div><br/></div><div>conda install -c conda-forge plotly # plotly更新した</div><div><br/></div><div>conda install -c conda-forge shapely # tmp環境でconda clean --all 実行し、使っていないpkg削除したためか、importできないので再度install</div><div><br/></div><div>------------------------------------------------------------------------------------</div><div>20190923</div><div>削除してtfgpu_py36_v3と同じ環境（ <span style="font-weight: bold;">tfgpu_py36_v4</span> ）作り直す</div><div><span style="font-weight: bold;">→作り直してもうまく行かず。。。Anaconda削除して再インストールした</span></div><div>Anaconda削除は</div><div><a href="https://echomist.com/conda-uninstall/">https://echomist.com/conda-uninstall/</a></div><div>を参考に</div><div>①まずWindowsエクスプローラを開き、Anacondaのフォルダ上にある「envs」および「pkgs」フォルダを削除する。</div><div>（これをしておかないとアンインストールにかなり時間がかかる）</div><div>②[コントロールパネル]の [プログラムの追加と削除]もしくは[プログラムのアンインストール]を開く。</div><div>③[Python 3.x.x（Anaconda 3.x.x）]を選択し、アンインストールを実行。</div><div>を行って</div><div><a href="https://www.anaconda.com/distribution/">https://www.anaconda.com/distribution/</a></div><div>から</div><div>Anaconda3-2019.07-Windows-x86_64.exe</div><div>ダウンロード（ダウンロード先：D:\001.Download_files\01.dl_app\01.system_installed）し、</div><div>実行して、再インストールした</div><div><br/></div><div>以下のコマンド叩いて環境作成した。shap eli5 は怪しそうなのでinstallやめておく（使ってないし）</div><div>$ conda create -n tfgpu_py36_v4</div><div>$ activate tfgpu_py36_v4</div><div>$ conda install python=3.6</div><div>$ conda install -c anaconda tensorflow-gpu=1.13.1</div><div>$ conda install -c conda-forge keras=2.2.4 lightgbm=2.2.3 scikit-learn=0.20.3 opencv=4.1.0 grpcio=1.16 numba=0.38.1 scipy=1.2.1 numpy=1.16.4 pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime dash rdkit line_profiler cx_oracle tifffile</div><div><br/></div><div><span style="font-weight: bold;">20191218</span></div><div><span style="font-weight: bold;">PC修理後に再インストールした</span></div><div>$ conda create -n tfgpu113</div><div>$ activate tfgpu113</div><div>$ conda install python=3.6</div><div>$ conda install -c anaconda tensorflow-gpu=1.13.1</div><div>$ conda install -c conda-forge keras=2.2.4 lightgbm=2.2.3 scikit-learn=0.20.3 opencv=4.1.0 grpcio=1.16 numba=0.38.1 scipy=1.2.1 numpy=1.16.4 pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime dash rdkit line_profiler cx_oracle tifffile optuna jupyterlab</div><div>conda install -c conda-forge validators # ファイルダウンロードで使う</div><div>conda install -c conda-forge imgaug albumentations</div><div><br/></div><hr/><div><span style="font-weight: bold;">githubにコードpushした</span></div><div><a href="https://github.com/riron1206/02_keras_py">https://github.com/riron1206/02_keras_py</a></div><div>### ディレクトリをGitリポジトリにする ###</div><div># バージョン管理を行っていない既存のプロジェクトをGitリポジトリに変換する場合や、空の新規リポジトリを作成して初期化する場合に使用</div><div>$ activate tfgpu_py36_v3</div><div>$ cd C:\Users\shingo\jupyter_notebook\tfgpu_py36_work\02_keras_py</div><div>$ git init # このディレクトリをGitリポジトリにする .gitディレクトリ作成する</div><div>$ git add --all # 全ファイルアップロード README.mdあげるだけなら git add README.md</div><div>$ git commit -m &quot;first commit&quot; # コミットの説明文</div><div>$ git remote add origin <a href="https://github.com/riron1206/02_keras_py.git" rev="en_rl_none">https://github.com/riron1206/02_keras_py.git</a> # リモートリポジトリに反映させる前に、リモートリポジトリの情報を追加</div><div>$ git push -u origin master # GitHubへプッシュしてリモートリポジトリへ反映させる</div><div>→riron1206</div><div>→shingorider1</div><div>### 更新 ###</div><div>$ activate tfgpu_py36_v3</div><div>$ cd C:\Users\shingo\jupyter_notebook\tfgpu_py36_work\02_keras_py</div><div>$ git add README.md # 更新したいファイル（今ならREADME.md）アップロード。全ファイルアップロードする場合はgit add --all</div><div>$ git commit -m &quot;edit README.md&quot; # コミットの説明文</div><div>$ git push origin master # GitHubへプッシュしてリモートリポジトリへ反映させる</div><div><br/></div><hr/><div>20190402</div><div><span style="font-weight: bold;">tensorflow-gpu 1.11 環境作る</span>（一般物体APIがtensorflow1.11でないとエラーになるっぽいので。 <a href="https://github.com/tensorflow/tensorflow/issues/17747" rev="en_rl_none">https://github.com/tensorflow/tensorflow/issues/17747</a>  より）</div><div>conda create -n tfgpu_v1-11</div><div>activate tfgpu_v1-11</div><div>conda install -c anaconda tensorflow-gpu=1.11</div><div>conda install -c conda-forge keras=2.2.4 #  <a href="https://www.kunihikokaneko.com/dblab/keras/keras2.html" rev="en_rl_none">https://www.kunihikokaneko.com/dblab/keras/keras2.html</a> より。tf 1.11 でkeras 2.2.4 入れてた</div><div>conda install -c conda-forge pandas scikit-learn jupyter</div><div># → keras MNIST動いた（）</div><div>#  tfgpu_py36_v3 と同等の環境にする</div><div>conda install -c conda-forge pandas scikit-learn jupyter Cython Protobuf Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill opencv shapely imageio git shap eli5 umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask cx_oracle rdkit tifffile xlsxwriter</div><div>conda install -c conda-forge numba=0.38.1 opencv # umap-learn動かすために numba このバージョンにする</div><div><br/></div><div># 上記のconda install -c conda-forge pandas scikit-learn jupyter <span style="text-decoration: underline;">実行後、</span>conda install できないから一旦削除した</div><div>conda remove -n tfgpu_v1-11 --all</div><div><br/></div><div><br/></div><hr/><div><span style="font-weight: bold;">自宅PC_conda_R環境構築</span></div><div><span style="font-weight: bold;">r_env環境に入れたライブラリ.txt</span></div><div><br/></div><div>20180903</div><div>conda create -n r_env python=3</div><div>activate r_env</div><div>conda install -n r_env -c r r</div><div>conda install -n r_env jupyter</div><div>conda install -n r_env -c r r-essentials</div><div>conda install -n r_env -c r rstudio r-tidyverse r-irkernel</div><div><br/></div><div># RNA-seqのSingle-cellの解析使うRパッケージ</div><div># <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/rkit" rev="en_rl_none">https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/rkit</a></div><div># R上で実行。ログ&lt;&lt; C:\Users\shingo\jupyter_notebook\r_env_work\work\R_test.ipynb &gt;&gt;</div><div>&gt; source(&quot;<a href="http://cf.10xgenomics.com/supp/cell-exp/rkit-install-2.0.0.R" rev="en_rl_none">http://cf.10xgenomics.com/supp/cell-exp/rkit-install-2.0.0.R</a>&quot;)</div><div><br/></div><div>20181003</div><div>umapの機能の一部でpython版のumap（umap-learn）が必要なため、pythonの依存ライブラリを追加した</div><div>参照：<a href="https://github.com/lmcinnes/umap" rev="en_rl_none">https://github.com/lmcinnes/umap</a></div><div><br/></div><div>conda install python=3.6 # umap-learn はpython3.7版は無かったためバージョン下げた</div><div>conda install git numpy pandas scipy opencv scikit-learn numba Matplotlib</div><div>conda install -c conda-forge umap-learn</div><div><br/></div><div>&gt; install.packages(&quot;umap&quot;) 失敗する</div><div>→&quot;package 'umap' is not available (for R version 3.4.3)&quot;</div><div><br/></div><hr/><div>20190828</div><div><span style="font-weight: bold;">tensorflow-gpu 1.14 環境作る</span>（&lt; <a href="https://dev.infohub.cc/setup_keras_tensorflow_gpu/" rev="en_rl_none">https://dev.infohub.cc/setup_keras_tensorflow_gpu/</a> &gt;より仮想環境ごとでバージョン違いのcuda混在できるみたいなので）</div><div><br/></div><div>①nvidia-driverを更新する（tensorflowv1.14はcuda10が必要で、cuda10はnvidia-driver411.31以上が必要だから  <a href="https://qiita.com/konzo_/items/a6f2e8818e5e8fcdb896" rev="en_rl_none">https://qiita.com/konzo_/items/a6f2e8818e5e8fcdb896</a> ）</div><div>nvidia-driver更新手順参考:  <a href="https://volx.jp/geforce-driver-update" rev="en_rl_none">https://volx.jp/geforce-driver-update</a></div><div>　windows10のデスクトップ左下の検索で GEFORCE EXPERIENCE を検索し、管理者で起動</div><div>    nvidiaのアカウント入力</div><div>　　ID: <a href="mailto:rironyokoi@gmail.com" rev="en_rl_none">rironyokoi@gmail.com</a></div><div>　　パスワード: Shingorider1</div><div>　→右上のドライバーの更新 ボタンクリック</div><div>　→右上のエクスプレスインストール ボタンクリック</div><div>　→30分ぐらいでインストール完了するので、完了後一応pc再起動</div><div>　→Anaconda prompt で $ nvidia-smi 入れたら</div><div>　NVIDIA-SMI 436.15       Driver Version: 436.15       CUDA Version: 10.1</div><div>　が1行目に表示された。nvidiaドライバーとcudaどっちも更新されたっぽい</div><div><br/></div><div>②Anacondaでパッケージインストール</div><div>$ conda create -n tfgpu_v1-14 python=3.6</div><div>$ activate tfgpu_v1-14</div><div>$ conda install -c anaconda tensorflow-gpu</div><div><br/></div><div># TensorFlow-GPUの動作確認</div><div>$ python -c &quot;import tensorflow as tf; tf.enable_eager_execution(); print(tf.reduce_sum(tf.random_normal([1000, 1000])))&quot;</div><div>→gpuで動いてるっぽい</div><div><br/></div><div># tfgpu_py36_v3のパッケージインストール（xgboost は入れれなかった）</div><div>$ conda install -c conda-forge lightgbm=2.2.3 scikit-learn=0.20.3 opencv=4.1.0 grpcio=1.16 numba=0.38.1 pandas jupyter Cython Protobuf Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git shap eli5 umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime</div><div>→efficientnetのkerasをすべてtf.kerasにしたが、モデルファイルimportでエラーになり挫折した</div><div><br/></div><div># conda install -c conda-forge scipy=1.2.1 rdkit line_profiler cx_oracle tifffile # A社環境にはこれらのパッケージも入れてたから追加すべき（依存パッケージとしてすでにインストールしているかもしれないが）_20190919</div><div><br/></div><div># conda installできなくなってた 20190919</div><div>→一旦環境削除して再作成した（ conda remove -n tfgpu_v1-14 --all ）</div><div>$ conda create -n tfgpu_v1-14 python=3.6</div><div>$ activate tfgpu_v1-14</div><div>$ conda install -c anaconda tensorflow-gpu</div><div>→なぜかconda-forgeだとエラーになる。。。しょうがないからリポジトリ指定なしにしてinstallしてみた</div><div>$ conda install keras</div><div>$ conda install lightgbm=2.2.3 scikit-learn=0.20.3 opencv=4.1.0 grpcio=1.16 numba=0.38.1 numpy=1.16.4 scipy=1.2.1 pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git shap eli5 umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime rdkit line_profiler cx_oracle tifffile</div><div>→ 上記実行後も conda install numpy できそうだった</div><div>→ import cv2できないので入れ直した</div><div>conda uninstall opencv</div><div>conda install -c conda-forge opencv</div><div>→失敗する。。。。_20190919</div><div><span style="font-weight: bold;">→「使われていないパッケージ及びキャッシュ削除する」下記コマンドを別の仮想環境(環境名：tmp)で実行したら conda-forge でinstall できるようになった_20190920</span></div><div><span style="font-weight: bold;">conda clean --all</span></div><div><a href="https://github.com/conda/conda/issues/8630" rev="en_rl_none">https://github.com/conda/conda/issues/8630</a> より</div><div><br/></div><div>→一旦環境削除して再作成した（ conda remove -n tfgpu_v1-14 --all ）_20190920</div><div>conda create -n tfgpu_v1-14 python=3.6</div><div>activate tfgpu_v1-14</div><div>conda install -c anaconda tensorflow-gpu</div><div>conda install -c conda-forge keras=2.2.4 lightgbm=2.2.3 scikit-learn=0.20.3 opencv=4.1.0 grpcio=1.16 numba=0.38.1 numpy=1.16.4 scipy=1.2.1 pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git shap eli5 umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime rdkit line_profiler cx_oracle tifffile</div><div>→なんか嫌なポップアップ出たけどインストールできた</div><div><br/></div><div><br/></div><hr/><div>20190919</div><div><span style="font-weight: bold;"># コンダをアップデートしてみた</span></div><div><span style="font-weight: bold;">管理者権限でアナコンダプロンプト開いて以下のコマンド叩いた</span></div><div>conda update -n base conda</div><div>→ conda 4.6.14 になった</div><div>→conda activate で環境切り替えるようになった</div><div><br/></div><hr/><div>20191126</div><div><span style="font-weight: bold;">tensorflow2.0環境作ってみる</span></div><div>conda create -n tfgpu python=3.7</div><div>conda activate tfgpu</div><div>conda install -c anaconda tensorflow-gpu</div><div>conda install -c conda-forge lightgbm scikit-learn opencv grpcio numba numpy pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime rdkit line_profiler cx_oracle tifffile psutil dash isort flask-login optuna jupyterlab</div><div>conda install -c conda-forge opencv=4.1.0 # opencv importエラーになったのでバージョンかえる <a href="https://qiita.com/nn_tok/items/e3a6b244e29c5a0510b0" rev="en_rl_none">https://qiita.com/nn_tok/items/e3a6b244e29c5a0510b0</a> # jupyterで別カーネルにした時だけこの現象発生</div><div>conda install -c conda-forge validators # ファイルダウンロードで使う</div></div><div>conda install -c conda-forge imgaug albumentations</div><div>conda install -c conda-forge pylint # VSCode で毎回聞かれるコードの静的解析ツール</div><div>conda install -c conda-forge pdfminer.six # pdfをtxtにするライブラリ</div><div>conda install -c conda-forge scipy=1.2.1 # ImportError: cannot import name 'imresize' from 'scipy.misc' が出たからバージョン下げた</div><div>conda install -c conda-forge pandas-profiling # pandas-profiling:pandasの基礎集計とか簡単に出せるパッケージ scipy-1.4.1にupgradeされた scipy v1.3.0以降でimread 使うにはimageioから呼ぶ(from imageio import imread) 20200117</div><div>conda install -c conda-forge tensorflow-hub # <span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">TensorFlowのトレーニング済みモデルのリポジトリ </span>20200126</div><div>conda install -c conda-forge numpy # なんか知らんがimport numpy できなかったからnumpy-1.17.5 入れなおした 20200126</div><div>conda install -c conda-forge metaflow # metaflow: Netflixが公開した機械学習パイプラインの構築ツール linuxでしか使えない。。。 20200126</div><div>conda install -c conda-forge hiplot # Facebookが作った多変量データの視覚化ができるpythonライブラリ。機械学習のハイパーパラメーターチューニングの結果比較に使える 20200301</div><div>conda install -c conda-forge quandl # 株式情報収集するpythonライブラリ。<a href="https://www.quandl.com/">https://www.quandl.com/</a> でAPI keyもらう必要ある 20200301</div><div>conda install -c delichon pandas_datareader # Pythonのライブラリで、経済データや金融商品の価格データが取ることができる。いくつかライブラリバージョン変わった。pandas 0.24以下じゃないと使えないのでだめだった 20200307</div><div>conda install -c conda-forge imutils # 基本的な画像処理機能パッケージ。pyimagesearchで必要だった。20200315</div><div>conda install -c conda-forge plotnine folium altair # 可視化パッケージ。コロナのgithub触るのに必要だった。20200330</div><div>conda install -c conda-forge flake8 # コードがPEP 8に準拠してるかチェック $ flake8 filename.py. 20200330</div><div>conda install -c conda-forge mlflow # 20200330 windowsの場合condaのmlflow UI($ mlflow ui --port 5000 --host 0.0.0.0)はバグる。。。 <a href="https://github.com/mlflow/mlflow/issues/1951">https://github.com/mlflow/mlflow/issues/1951</a></div><div>conda install -c plotly plotly-orca # 可視化パッケージ。コロナのgithub触るのに必要だった。20200330 Orcaは、コマンドラインからplotly.jsグラフ、ダッシュアプリ、ダッシュボードなどのPlotlyの画像とレポートを生成するElectronアプリ  <a href="https://github.com/plotly/orca">https://github.com/plotly/orca</a></div><div>conda install -c conda-forge plotly # plotly4.5.4に更新した</div><div>conda install -c conda-forge arviz # ベイズモデルの探索的分析のための Python パッケージ</div><div>conda install -c conda-forge pymc3 # ベイズ統計モデリングおよび確率的機械学習用のPythonパッケージ</div><div>conda install -c conda-forge jupyterthemes # Jupyterの見た目を自分好みにカスタマイズするパッケージ。設定は「Pandas+Numpy+matplotlib+etc... Tips」に書いた 20200411</div><div>conda install -c conda-forge imageio-ffmpeg # imageioでmp4をgifにするために必要だった 20200416</div><div>conda install -c conda-forge nodejs  # jupyterlabのExtension入れるためにNode.js入れた 20200419</div><div>conda install -c conda-forge jupyterlab  # jupyterlab=2.1にバージョン上げた。jsエラーでビルド失敗するから。updateしたらextension maneger が表示されなくなった。。。 20200421</div><div>conda install -c conda-forge pandas-highcharts  #  ブラウザ上にグラフを表示するJavaScriptのライブラリーであるHighchartsのラッパー。jupyterで時系列データインタラクティブにいじれる 20200421</div><div>conda install -c conda-forge nteract_on_jupyter  # Jupyter Notebookの上位互換的ツール windowsならアプリダウンロードした方が使いやすいかも&lt; <a href="https://nteract.io/">https://nteract.io/</a>&gt;</div><div>conda install -c conda-forge scikit-learn  # sklearn v0.23.0から統計モデリングに対応したからupdate</div><div>conda install -c conda-forge pytesseract   # OCR読み込みのためのライブラリ 20200526</div><div>conda install -c anaconda tensorflow-datasets  # 20200615</div><div>pip install tensorflow_addons==0.8.3  # 一か八かpipで入れてみた 20200619</div><div>conda install -c anaconda tensorflow-gpu=2.1  # tf2.1にしてみる。tensorflow_addons==0.8.3はtf2.1からしか使えないから</div><div>conda install -c conda-forge librosa  # 音声処理・音楽情報処理を行うときに使えるpythonのpackage 20200704</div><div>conda install -c conda-forge pydub  # 音声系のライブラリ 20200705</div><div><span style="text-decoration: line-through;">conda install -c conda-forge pandas-profiling=2.8  # pandas-profiling v2.8.0に更新 20200708</span> なぜかできなかった</div><div>conda install -c conda-forge pydotplus  # 決定木のdotファイルを変換 20200708</div><div>conda install -c conda-forge optuna  # xfeatがoptunaのv1.3.0以上必要だったので更新</div><div>conda install -c conda-forge geopandas  # birdコンペで必要だった 20200724</div><div>conda install -c conda-forge tsfresh  # 時系列扱うためのパッケージっぽい</div><div>conda install -c conda-forge featuretools  # 特徴量作成するためのパッケージ</div><div>conda install -c conda-forge wandb  # モデルの学習履歴残すパッケージ？mlflowみたいなもんかな</div><div>conda install -c conda-forge fbprophet</div><div><span style="text-decoration: line-through;">conda install -c conda-forge pyarrow</span>  # install失敗する。これないとfeatherが使えない。。。</div><div>conda install -c conda-forge fuzzywuzzy  # 距離測るパッケージ</div><div>conda install -c conda-forge tensorflow-probability</div><div>conda install -c conda-forge jupyter_pivottablejs  # ピボットテーブル作れるhtmlを出力する  <a href="https://towardsdatascience.com/interactive-pivot-tables-in-jupyter-notebook-fc74bad8aa67">https://towardsdatascience.com/interactive-pivot-tables-in-jupyter-notebook-fc74bad8aa67</a></div><div><br/></div><div># python の自動formatterであるblackをjupyterで使うには以下のコマンドたたいてblackのjupyter_contrib_nbextensionsをインストールする 20200730</div><div>jupyter nbextension install <a href="https://github.com/drillan/jupyter-black/archive/master.zip">https://github.com/drillan/jupyter-black/archive/master.zip</a> --user</div><div>jupyter nbextension enable jupyter-black-master/jupyter-black</div><div><br/></div><div># 環境のyml作成してみた（出力ymlの最終行のファイルパスは消すこと） 20200412</div><div>conda env export --no-builds &gt; ./02_keras_py.yml</div><div>conda env export --no-builds &gt; ./tfgpu.yml  # 20200622</div><div><br/></div><div># ドスパラのPCに仮想環境の作成(yamlファイルの読み込み)した 20200621</div><div><span style="color: rgb(255, 0, 0);">※yamlは文字コードUTF-8じゃないと失敗する！！！</span></div><div><a href="https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512">https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512</a></div><div>cd C:\Users\81908\tmp</div><div>conda env create -n tfgpu -f tfgpu.yml</div><div><br/></div><div># jupyterの見栄えの設定(jupyterthemes)は</div><div>evernoteの Pandas+Numpy+matplotlib+etc... Tips をに書いてる  20200621</div><div><br/></div><div><hr/></div><div>20191223</div><div><span style="font-weight: bold;">pytorch環境作ってみる</span></div><div>conda create -n pytorch python=3.7</div><div>conda activate pytorch</div><div>conda install pytorch torchvision cudatoolkit=10.1 -c pytorch</div><div>conda install -c conda-forge lightgbm scikit-learn opencv grpcio numba numpy pandas jupyter Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git umap-learn plotly ipysheet bqplot rise bokeh jupyter_contrib_nbextensions yapf flask joblib alembic dill xlrd nose xlsxwriter lime rdkit line_profiler cx_oracle tifffile psutil dash isort flask-login optuna jupyterlab imgaug albumentations <span style="font-size: 10pt;">validators absl-py tensorboard tensorboardx pdfminer.six pylint</span></div><div>conda install -c conda-forge mlflow # 20200330 windowsの場合condaのmlflow UI($ mlflow ui --port 5000 --host 0.0.0.0)はバグる。。。 <a href="https://github.com/mlflow/mlflow/issues/1951">https://github.com/mlflow/mlflow/issues/1951</a></div><div>conda install -c pytorch pytorch=1.4 # pytorch更新した。2次元→3次元に変換するgithubで必要だった 20200412</div><div>conda install -c conda-forge vispy # 2D / 3Dデータ可視化ライブラリ。GPU使えるみたい。2次元→3次元に変換するgithubで必要だった 20200413</div><div>conda install -c conda-forge moviepy # ビデオ編集用のPythonライブラリ。2次元→3次元に変換するgithubで必要だった 20200413</div><div>conda install -c conda-forge transforms3d # 回転、ズーム、シア、反射などの3次元変換を作成および変換するためのPython関数とクラスのコレクション。2次元→3次元に変換するgithubで必要だった 20200413</div><div>conda install -c conda-forge networkx=2.3 # 2次元→3次元に変換するgithubで「AttributeError: 'Graph' object has no attribute 'node'」エラーが出るからバージョン下げた 20200413</div><div>conda install -c conda-forge pyopengl # 2次元→3次元に変換するgithubでエラーが出るからvispyの依存っぽいの入れた 20200413</div><div>conda install -c conda-forge audioread pydub librosa pysoundfile  # 音声系のライブラリ 20200705</div><div>conda install -c conda-forge fastprogress  # 進捗バー 20200705</div><div>conda install -c conda-forge jupyter_contrib_nbextensions jupytext black  # 20201027</div><div>conda install -c conda-forge category_encoders  # 20201207</div><div><span style="text-decoration: line-through;">conda install -c conda-forge pytorch-lightning  # 20201210</span>  エラーになる</div><div><br/></div><div># 環境のyml作成してみた（出力ymlの最終行のファイルパスは消すこと） 20200413</div><div>cd C:\Users\shingo\jupyter_notebook\pytorch_work</div><div>conda env export --no-builds &gt; ./pytorch.yml</div><div><br/></div><div># ドスパラのPCに仮想環境の作成(yamlファイルの読み込み)した 20200621</div><div><span style="color: rgb(255, 0, 0);">※yamlは文字コードUTF-8じゃないと失敗する！！！</span></div><div><a href="https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512">https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512</a></div><div>cd C:\Users\81908\jupyter_notebook\pytorch_work</div><div>conda env create -n pytorch -f pytorch.yml</div><div><br/></div><div><br/></div><hr/><div>20201210</div><div><span style="font-weight: bold;">pytorch-lightning環境作ってみる</span></div><div>conda create -n lightning</div><div>conda activate lightning</div><div>conda install -c conda-forge pytorch-lightning</div><div>conda install pytorch==1.6.0 torchvision==0.7.0 cudatoolkit=10.1 -c pytorch</div><div>conda install -c conda-forge category_encoders jupyter jupyter_contrib_nbextensions jupytext black category_encoders lightgbm scikit-learn opencv grpcio numba pandas Cython Pillow lxml Matplotlib tqdm future graphviz pydot pytest pyperclip networkx selenium beautifulsoup4 cssselect openpyxl pypdf2 python-docx requests tweepy textblob seaborn scikit-image imbalanced-learn colorlog sqlalchemy papermill shapely imageio git umap-learn plotly ipysheet bqplot rise bokeh pandas-profiling yapf flask joblib alembic dill xlrd nose xlsxwriter lime rdkit line_profiler cx_oracle tifffile psutil dash isort flask-login optuna jupyterlab imgaug albumentations validators absl-py tensorboard tensorboardx pdfminer.six pylint wandb fbprophet</div><div>conda install -c conda-forge nvidia-apex</div><div>conda install -c conda-forge easydict</div><div>conda install -c conda-forge kornia</div><div><br/></div><div><br/></div><hr/><div>20200307</div><div><span style="font-weight: bold;">株関連環境</span><span style="font-weight: bold;">作ってみる</span></div><div>conda create -n stock python=3.7</div><div>conda activate stock</div><div>conda install -c delichon pandas_datareader # Pythonのライブラリで、経済データや金融商品の価格データが取ることができる。いくつかライブラリバージョン変わった。pandas 0.24以下じゃないと使えないのでだめだった 20200307</div><div>conda install -c conda-forge pandas=0.24</div><div>conda install -c conda-forge jupyter</div><div>conda install -c conda-forge Pillow Matplotlib requests selenium beautifulsoup4 quandl</div><div>conda install -c conda-forge tqdm</div></div><div>conda install -c conda-forge plotly opencv</div><div>conda install -c conda-forge git</div><div>conda install -c conda-forge yaml # 20200329</div><div>conda install -c conda-forge pyyaml # 20200329</div><div>conda install -c conda-forge openpyxl xlsxwriter # 20200329</div><div>conda install -c conda-forge flask dash flask-login # 20200329</div><div>conda install -c conda-forge pysimplegui  # Excel VBAレベルのアプリ作る場合に適してるpythonのアプリ作成ライブラリ 20200420</div><div>conda install -c conda-forge pyquery  # HTML内のデーターを取得するPythonのライブラリー。BeautifulSoupみたいなもん 20200421</div><div>conda install -c conda-forge pandas-highcharts  #  ブラウザ上にグラフを表示するJavaScriptのライブラリーであるHighchartsのラッパー。jupyterで時系列データインタラクティブにいじれる 20200421</div><div>conda install -c conda-forge jupyterlab  # pandas-highchartsはjupyterlabじゃないとつかえない 20200421</div><div>conda install -c conda-forge nodejs  # jupyterlabのExtension入れるためにNode.js入れた 20200423</div><div>conda install -c conda-forge youtube-dl  # youtubeダウンロードするためのライブラリ 20200428</div><div>conda install -c conda-forge swifter  # pandasのapply()の処理をベクトル化(numpyにして)して早くするパッケージ df = df.swifter.apply(func) みたいにして使う。ベクトル化できない処理やベクトル化済みの場合は逆に遅くなる 20200513</div><div>conda install -c conda-forge joblib  # multiprocessingより簡単に並列処理にできるライブラリ 20200513</div><div>conda install -c conda-forge scikit-learn  # sklearnバージョン上げた 20200518</div><div>conda install -c conda-forge optuna  # 時系列モデルのパラメータチューニングで使うため 20200528</div><div>conda install arch -c bashtage  # 時系列モデルのARCHモデル使うためのライブラリ 20200529</div><div>conda install -c conda-forge nose  # noseでテストする 20200530</div><div><br/></div><div># インストールしたjupyterlabのextension</div><div><span style="text-decoration: line-through;">jupyter labextension install @jupyterlab/plotly-extension</span>  # plotly使うためのextension。バージョン不整合で入れれず</div><div><br/></div><div># 環境のyml作成してみた（出力ymlの最終行のファイルパスは消すこと） 20200307</div><div>conda env export --no-builds &gt; ./stock.yml</div><div><br/></div><div># ドスパラのPCに仮想環境の作成(yamlファイルの読み込み)した 20200621</div><div><span style="color: rgb(255, 0, 0);">※yamlは文字コードUTF-8じゃないと失敗する！！！</span></div><div>　<a href="https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512">https://hytmachineworks.hatenablog.com/entry/2019/01/21/001512</a></div><div>cd C:\Users\81908\jupyter_notebook\stock_work\03.stock_repo</div><div>conda env create -n stock -f stock.yml</div><div><br/></div><hr/><div>20200402</div><div><span style="font-weight: bold;">mlflow環境作成（20200412時点のwindows版ではcondaで仮想環境切って、仮想環境内でmlflowをpipでインストールしないとmlflow uiは使えないので。condaのmlflowがバグってるらしい</span> <a href="https://github.com/mlflow/mlflow/issues/154" style="font-weight: bold;">https://github.com/mlflow/mlflow/issues/154</a><span style="font-weight: bold;">）</span></div><div><a href="https://qiita.com/sumita_v09/items/174977f48c44244f9719">https://qiita.com/sumita_v09/items/174977f48c44244f9719</a> より</div><div>conda create -n mlflow python=3.7.0</div><div>conda activate mlflow</div><div>pip install mlflow</div><div>→ほかの仮想環境のnumpyとか上書きされず。問題ない</div><div>cd &lt;mlrunsがあるディレクトリ&gt;</div><div>mlflow ui</div><div>→ <a href="http://localhost:5000/#/">http://localhost:5000/</a> でアクセスできる</div><div><br/></div><div><br/></div><hr/><div>20200817</div><div><span style="font-weight: bold;">時系列関連環境作成（poetryで作ろうとしたがpystanがcondaじゃないとうまく入らないので</span>）</div><div>conda create -n ts python=3.7</div><div>conda activate ts</div><div>conda install -c conda-forge fbprophet</div><div>conda install -c conda-forge jupyter jupyter_contrib_nbextensions jupytext black seaborn</div><div>conda install -c conda-forge joblib</div><div><br/></div><hr/><div>20201026</div></div><div><span style="font-weight: bold;">tf1.15環境作成(TGANをgpuで動かすため→できなかった。。。</span><span style="font-weight: bold;">)</span></div><div>conda create -n tfgpu1</div><div>conda activate tfgpu1</div><div>conda install python=3.7</div><div>conda install -c anaconda tensorflow-gpu=1.15</div><div>conda install -c conda-forge pandas scikit-learn tqdm jupyter</div><div>conda install -c conda-forge jupyter_contrib_nbextensions jupytext</div><div>conda install -c conda-forge matplotlib seaborn</div><div>conda install -c conda-forge msgpack-python  # tensorpackの依存パッケージ</div><div>conda install -c conda-forge msgpack-numpy  # tensorpackの依存パッケージ</div><div>conda install -c conda-forge psutil  # tensorpackの依存パッケージ</div><div><div>conda install -c conda-forge tabulate  # tensorpackの依存パッケージ</div><div><br/></div><hr/><div>20200406</div><div><span style="font-weight: bold;">PowerShellでAnacondaの環境をactivateする方法</span></div><div><a href="https://blog.minatoproject.com/?p=1300">https://blog.minatoproject.com/?p=1300</a></div><div><br/></div><div><span style="font-weight: bold;">1. Anaconda promptで以下のコマンド叩いてpscondaenvsをrootにインストール</span></div><div>$ conda install -n root -c pscondaenvs pscondaenvs</div><div><br/></div><div><span style="font-weight: bold;">2. PowerShellを左クリックで管理者権限で実行し、PowerShellで以下のコマンド叩いてスクリプト実行を許可する</span></div><div>$ Set-ExecutionPolicy RemoteSigned</div><div><br/></div><div>これでPowerShellからconda activateできるようになります</div><div>$ activate hoge_venv</div><div><br/></div><div>→jupyter起動できるし、jupyterでnumpyなどのライブラリもimportできた</div><div>→ただし、jupyter_notebook_config.pyはロードされないみたい</div><div><br/></div><hr/><div>20200406</div><div><span style="font-weight: bold;">Windows 10 の bash を有効にする</span></div><div>参考:</div><div><a href="https://www.vwnet.jp/Windows/w10/2016041301/EnableWindows10bash.htm">https://www.vwnet.jp/Windows/w10/2016041301/EnableWindows10bash.htm</a></div><div><a href="https://www.atmarkit.co.jp/ait/articles/1809/14/news015.html">https://www.atmarkit.co.jp/ait/articles/1809/14/news015.html</a></div><div><br/></div><div>1. 歯車マークの「設定」→「更新とセキュリティ」→「開発者モード」にチェックを入れる</div><div><br/></div><div>2. 「Windowsシステムツール」→「コントロールパネル」→「プログラム」→「Windows機能の有効化または無効化」で「Windows Subsystem for Linux」にチェックを入れてWindows 10を再起動</div><div><br/></div><div>3. デスクトップの検索→「Microsoft Store」で“Linux”を検索して、「Ubuntu」を選択して購入（無料）</div><div><br/></div><div>4. インストール作業が終わったら、スタートに追加されるUbuntuを起動して、インストールの完了を待つ</div><div><br/></div><div><span style="font-weight: bold;">5. 内部で使用するユーザー名とパスワードの設定</span></div><div><span style="font-weight: bold;">　ユーザー名:riron1206</span></div><div><span style="font-weight: bold;">　パスワード:shingorider1</span></div><div><br/></div><div>6. リポジトリの変更</div><div>デフォルトでは海外サーバーにリポジトリのデータを取りに行ってしまいます。</div><div>これだと通信速度が遅くなってしまうので、日本のサーバーに切り替える</div><div>$ sudo sed -i -e 's%http://.*.<a href="http://loadhtml/ubuntu.com%25http://ftp.jaist.ac.jp/pub/Linux%25g">ubuntu.com%http://ftp.jaist.ac.jp/pub/Linux%g</a>' /etc/apt/sources.list</div><div><br/></div><div>7. パッケージのアップデート</div><div>$ sudo apt update</div><div>$ sudo apt upgrade</div><div><br/></div><div><span style="font-weight: bold;">→powershellで bash と打てばUbuntu に切り替わり、bash使える</span></div><div><br/></div><div><br/></div><hr/><div><span style="font-weight: bold;">Windows10でのDocker環境つくり方</span></div><div>参考:</div><div><a href="https://qiita.com/ksh-fthr/items/6b1242c010fac7395a45">https://qiita.com/ksh-fthr/items/6b1242c010fac7395a45</a></div><div><a href="https://docs.microsoft.com/ja-jp/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v#enable-the-hyper-v-role-through-settings">https://docs.microsoft.com/ja-jp/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v#enable-the-hyper-v-role-through-settings</a></div><div><a href="https://qiita.com/chr/items/184b6af37d105bdad145">https://qiita.com/chr/items/184b6af37d105bdad145</a></div><div><br/></div><div><span style="font-weight: bold;">1. Hyper-V を有効化する</span></div><div><span style="color: rgb(255, 0, 0); font-weight: bold;">※Windows 10 proじゃないと</span><span style="color: rgb(255, 0, 0); font-weight: bold;">Hyper-V つかえない。。。</span></div><div>　Windows ボタンを右クリック→ [アプリと機能]→ [プログラムと機能]→[Windows の機能の有効化または無効化] →[Hyper-V] を選択して、 [OK] をクリック</div><div><br/></div><div><span style="font-weight: bold;">2. 下記サイトからDocker for Windows Installer のダウンロードして、ダウンロードしたexe実行してインストール</span></div><div>　<a href="https://docs.docker.com/docker-for-windows/install/#install-docker-desktop-for-windows-desktop-app">https://docs.docker.com/docker-for-windows/install/#install-docker-desktop-for-windows-desktop-app</a></div><div>　→インストールが完了すると、Dockerが自動的に起動する</div><div>　　デスクトップ右下の^にクジラのマークあれば起動している</div><div>　　起動していなければデスクトップの「Docker Desktop」ダブルクリックしたら起動する</div><div><br/></div><div><span style="font-weight: bold;">※ powershwllで以下のコマンドを叩くことでも1,2実行できるみたい</span></div><div># <a href="https://own-search-and-study.xyz/2020/04/02/docker-python-develop-environment/">https://own-search-and-study.xyz/2020/04/02/docker-python-develop-environment/</a></div><div># Hyper-V 有効化（要再起動）</div><div>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All</div><div># Docker for Windowsのインストール（要サインアウト） chocoコマンドがpowershellの機能であるchocolatey。ubuntuのapt getと同じ意味</div><div>choco install docker-for-windows</div><div><br/></div><div><span style="font-weight: bold;">3. コマンドプロンプトやPowerShellからdockerコマンド叩ける</span></div><div>$ docker version # Dockerのバージョン確認</div><div>$ docker run hello-world # Hello World の確認</div><div>$ docker-compose version # docker-composeのバージョン確認</div><div><br/></div><div><span style="font-weight: bold;">4. Docker Hubに登録（</span><span style="font-weight: bold;">nvidia DockerとかいろんなDockerイメージをダウンロードするために必要</span><span style="font-weight: bold;">）</span></div><div><a href="https://hub.docker.com/" style="font-weight: bold;">https://hub.docker.com/</a><span style="font-weight: bold;"> からSign Upでアカウント作成</span></div><div><span style="font-weight: bold;">ID: anonamename</span></div><div><span style="font-weight: bold;">mail:</span> <a href="mailto:rironyokoi@gmail.com" style="font-weight: bold;">rironyokoi@gmail.com</a></div><div><span style="font-weight: bold;">password: shingorider1</span></div><div><br/></div><div>※Dockerの使い方は基本以下の手順</div><div>1.Dockerイメージをダウンロード(docker pull)</div><div>2.ダウンロードしたDockerイメージからコンテナを起動(docker run)</div><div><br/></div><div>※Dockerが面白いのがコンテナはあくまでDockerイメージ固定の仮想環境上である点。</div><div>なので、$ rm -rf みたいなすべて消し去るコマンド叩いても、同じイメージでDocker runすると、何事もなかったように元の環境が復活する。</div><div><br/></div><hr/><div><span style="font-weight: bold;">Docker Hubから</span><span style="font-weight: bold;">機械学習の環境構築</span></div><div><a href="https://karaage.hatenadiary.jp/entry/2019/05/17/073000">https://karaage.hatenadiary.jp/entry/2019/05/17/073000</a></div><div><br/></div><div>PowerShellから以下のコマンド叩く（コマンドプロンプトでも可能だが$PWDとかが使えないからPowerShellの方がいい）</div><div><br/></div><div><span style="font-weight: bold;"># TensorFlowのDockerイメージでコンテナ立ち上げ</span></div><div><span style="color: rgb(255, 0, 0);">$ docker run -it -v $PWD/docker_share:/share</span> <span style="font-size: 14px; color: rgb(255, 0, 0);">-p 8888:8888 </span><span style="color: rgb(255, 0, 0);">--rm --name tensorflow tensorflow/tensorflow</span></div><div>-i:コンテナの標準入力を開くオプション</div><div>-t:tty(端末デバイス=ターミナル)を確保するオプション</div><div>-v $PWD/docker_share:/share : ホスト側とコンテナ側のディレクトリを共有するオプション。コマンド実行したディレクトリの下に docker_share というディレクトリが生成され、/shareディレクトリにファイルを入れると、ホスト側にも共有されます。</div><div>-p:コンテナのポート番号:ホスト番号</div><div>--rm:コンテナから抜けるとコンテナを自動で削除する</div><div>--name: コンテナの名前を指定</div><div>※その他のdocker runオプション</div><div>-e:環境変数指定する。-e foo=bar みたいに</div><div>-w:コンテナの作業ディレクトリを指定する。-w=/tmp/work みたいにすると、カレントディレクトリを<span style="font-size: 14px;">/tmp/workにしてコンテナ起動(例えば、</span><span style="font-size: 14px;">$ docker exec -it tensorflow でtensorflowという名前で稼働中のコンテナにbashを実行して、</span><span style="font-size: 14px;">$pwd と打つと</span><span style="font-size: 14px;">/tmp/work になっている</span><span style="font-size: 14px;">)</span></div><div><br/></div><div><span style="font-weight: bold;"># コンテナで起動したJupyter Notebookにホストのブラウザからアクセス</span><span style="font-weight: bold;">(Jupyter Notebookが入ったDockerイメージとしてdatascience-notebook)</span></div><div># なぜか-vオプションは効かない</div><div><span style="color: rgb(255, 0, 0);">$ docker run -p 8888:8888 -it --rm --name ds jupyter/datascience-notebook</span></div><div>→起動すると画面に token=xxxxxxxxxxxxxx という形でtokenが表示されるので、</div><div>　<a href="http://localhost:8888/">http://localhost:8888</a> にアクセスして、ログイン画面でtoken貼り付ける</div><div>→もしくは、<a href="http://localhost:8888/?token=xxxxxxxxxxxxxx">http://localhost:8888/?token=xxxxxxxxxxxxxx</a> とアドレスにtokenを打ち込めば、ログイン画面を省略して直接Jupyter Notebookにログインできる</div><div><br/></div><div><span style="font-weight: bold;"># 起動中のdsコンテナのターミナルにログインしたい場合（jovyanというjupyter notebookのユーザーを意味するユーザー名でログイン）新規にpower shell起動して以下コマンド叩く</span></div><div><span style="color: rgb(255, 0, 0);">$ docker exec -it ds bash</span></div><div><br/></div><div><span style="font-weight: bold;"># コンテナからイメージ作成（</span><span style="font-weight: bold;">上記の ds というコンテナをkaraage0703/ds-imageというイメージとして保存</span><span style="font-weight: bold;">）</span></div><div><span style="font-weight: bold;"># </span><span style="font-weight: bold;">イメージの名前は、Docker Hubを用いて自分のイメージを公開したい場合は、&lt;Docker Hub ユーザ名&gt;/&lt;リポジトリ名&gt;の形式にする必要がある</span></div><div><span style="color: rgb(255, 0, 0);">$ docker commit ds karaage0703/ds-image</span></div><div>$ docker run -it --rm --name ds karaage0703/ds-image # docker runすると、イメージ化したときの環境でコンテナが起動</div><div><br/></div><div><span style="font-weight: bold;"># Dockerfile</span><span style="font-weight: bold;">（</span><span style="font-weight: bold;">OS のコマンドを羅列した</span><span style="font-weight: bold;">テキストファイル）</span><span style="font-weight: bold;">からイメージ作成（</span><span style="font-weight: bold;">ファイル名は Dockerfile にし、拡張子はつけない）</span></div><div>$ cd docker_share</div><div>$ ls</div><div>Dockerfile</div><div>$ cat Dockerfile</div><div>FROM ubuntu</div><div>MAINTAINER karaage0703 &lt;<a href="mailto:coldchicken@gmail.com">coldchicken@gmail.com</a>&gt;</div><div>RUN apt-get update &amp;&amp; apt-get install -y python3.7</div><div><span style="color: rgb(255, 0, 0);">$ docker build -t karaage0703/test-image .</span> <span style="color: rgb(0, 0, 0);"># カレントディレクトリ(コマンドの最後の「.」)のDockerfileからイメージ作成 。「karaage0703/test-image」は指定したイメージ名。</span><span style="font-size: 14px; color: rgb(0, 0, 0);">-t オプションは作成するDockerイメージのイメージ名およびタグ名を指定</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># 作成したDockerイメージ確認</span></div><div>$ docker image list # 消したい場合は$ docker rmi [IMAGE_ID]</div><div><br/></div><div><span style="font-weight: bold;"># 作成したDockerイメージをDockerHubへアップロード</span><span style="font-weight: bold;">（Docker Hubにログインしてpushするだけ）</span></div><div>$ docker login</div><div>$ docker push karaage0703/test-image</div><div><br/></div><div><span style="font-weight: bold;"># GitHubとDockerHubを連携させてイメージ作成</span></div><div>DockerfileをGitHubにpushするだけで、自動的にそのDockerfileのイメージを作成することまでできます</div><div><br/></div><div><span style="font-weight: bold; text-decoration: line-through;">DockerイメージからDockerfile構築</span></div><div><a href="https://qiita.com/RyodoTanaka/items/6f8da0749cbd0afa0ddd" style="text-decoration: line-through;">https://qiita.com/RyodoTanaka/items/6f8da0749cbd0afa0ddd</a></div><div><span style="color: rgb(255, 0, 0); text-decoration: line-through;">docker history --no-trunc &lt;image name&gt;  | tac | tr -s ' ' | cut -d &quot; &quot; -f 5- | sed 's,^/bin/sh -c #(nop) ,,g' | sed 's,^/bin/sh -c,RUN,g' | sed 's, &amp;&amp; ,\n  &amp; ,g' | sed 's,\s*[0-9]*[\.]*[0-9]*[kMG]*B\s*$,,g' | head -n -1 &gt; .\Dockerfile</span></div><div><br/></div><div><span style="font-weight: bold;"># コンテナの終了</span></div><div>$ exit or Ctrl + D</div><div><br/></div><hr/><div><span style="font-weight: bold;">参考:Dockerのコマンドでよく使うものまとめ</span></div><div><a href="https://designsupply-web.com/knowledgeside/3325/">https://designsupply-web.com/knowledgeside/3325/</a></div><div><br/></div><div><span style="font-weight: bold;">■Dockerのイメージに関する操作を行うコマンド</span></div><div><br/></div><div><span style="font-weight: bold;">// イメージの一覧確認。※Dockerfileのコメントは//</span></div><div>$ docker images</div><div><br/></div><div><span style="font-weight: bold;">// Docker Hubでイメージの検索</span></div><div>$ docker search [NAME]</div><div><br/></div><div><span style="font-weight: bold;">// Docker Hubでイメージのダウンロード</span></div><div>$ docker pull [NAME]:[TAG]</div><div><br/></div><div><span style="font-weight: bold;">// イメージの削除（ID指定）</span></div><div>$ docker rmi [IMAGE_ID]</div><div>$ docker rmi id名 -f  <span style="font-weight: bold;"># -fで強制削除</span></div><div><br/></div><div><span style="font-weight: bold;">// イメージの削除（コンテナ未使用分を一括で）</span></div><div>  // ver1.13以降</div><div>  $ docker image prune</div><div>  // ver1.12以前</div><div>  $ docker rmi $(docker images -q)</div><div><br/></div><div><span style="font-weight: bold;">// 全イメージ削除</span></div><div>docker rmi $(docker images -q)</div><div><br/></div><div><span style="font-weight: bold;">// イメージの作成</span></div><div>$ docker build -t [IMAGE_NAME]:[TAG] [Dockerfile_PATH]</div><div><br/></div><div><span style="font-weight: bold;">// イメージの名前とタグ設定（タグ名は基本バージョン番号）</span></div><div>$ docker tag [IMAGE_ID] [NAME]:[TAG]</div><div>$ docker tag [REPOSITORYが&lt;none&gt;のイメージ] anarinsk/pycare_dependency1:1.0.0  # docker psでイメージ確認するとREPOSITORYが&lt;none&gt;のイメージできるので名前つけておく</div><div><br/></div><div><span style="font-weight: bold;">// イメージやコンテナの詳細表示</span></div><div>$ docker inspect [IMAGE_ID]/[<span style="font-size: 14px;">CONTAINER_ID</span>]</div><div><br/></div><div><br/></div><div><span style="font-size: 10pt; font-weight: bold;">■Dockerのコンテナに関する操作を行うコマンド</span></div><div><br/></div><div><span style="font-weight: bold;">// コンテナの一覧確認（全てのコンテナ）</span></div><div>$ docker ps -a</div><div><br/></div><div><span style="font-weight: bold;">// コンテナの一覧確認（起動中のコンテナのみ）</span></div><div>$ docker ps</div><div><br/></div><div><span style="font-weight: bold;">// コンテナの起動</span></div><div>$ docker start [CONTAINER_ID]</div><div><br/></div><div><span style="font-weight: bold;">// コンテナの停止</span></div><div>$ docker stop [CONTAINER_ID]</div><div><br/></div><div><span style="font-weight: bold;">// 全コンテナ削除</span></div><div>$ docker stop $(docker ps -a -q)  # 全コンテナ停止</div><div>$ docker rm $(docker ps -a -q)  # 全コンテナ削除</div><div><br/></div><div><span style="font-weight: bold;">// 起動中のubuntuコンテナのターミナルにログイン</span></div><div>$ docker exec -it ubuntu bash</div><div><br/></div><div><span style="font-weight: bold;">// コンテナから抜けて停止</span></div><div>$ exit</div><div><br/></div><div><font style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">// docker runで</span><span style="font-size: 10pt; font-weight: bold;">イメージからコンテナ起動</span></font></div><div><span style="font-size: 10pt;">// 実際にはイメージを取得するための「docker pull」や、</span></div><div><span style="font-size: 10pt;">// イメージから新しいコンテナを作成する「docker create」、</span></div><div><span style="font-size: 10pt;">// コンテナ中でプログラムを起動する「docker start」などのコマンドを合成したもの</span></div><div><span style="font-size: 10pt;">// $ docker ps -a で見えるロカールのイメージから起動する場合は、ローカルの[IMAGE]（イメージ名）を指定する。指定のイメージ名がローカルに無い場合はDocker Hubのリポジトリを探しに行く</span></div><div><span style="font-size: 10pt;">// Docker Hub のイメージから起動する場合は、Docker Hub の[USER/IMAGE]（ユーザ名/イメージ名）を指定する</span></div><div><span style="font-size: 10pt;">$ docker run -it [IMAGE]/[USER/IMAGE] (例.</span>docker run -it ubuntu bash<span style="font-size: 10pt;">)</span></div><div><span style="font-size: 10pt;">-it:ターミナルを使うためのオプション</span></div><div><br/></div><div><span style="font-weight: bold;">// コンテナを作成起動し、ログインしてbashで操作（フォアグラウンドで実行）</span></div><div>$ docker run -i -t [IMAGE] /bin/bash</div><div><br/></div><div><span style="font-weight: bold;">// コンテナを作成起動し、ログインしてbashで操作（バックグラウンドで実行）</span></div><div>$ docker run -i -t -d [IMAGE] /bin/bash</div><div><br/></div><div><span style="font-weight: bold;">// コンテナへログインしてbashで操作（起動中のコンテナのみ）</span></div><div>$ docker exec -i -t [CONTAINER_ID] bash</div><div><br/></div><div><span style="font-weight: bold;">// コンテナの削除 ※あらかじめ停止しておくこと</span></div><div>$ docker rm [CONTAINER_ID] # docker rm c865d1671c53 みたいなの</div><div><br/></div><div><span style="font-weight: bold;">// 全コンテナ削除 ※あらかじめ停止しておくこと</span></div><div>$ docker rm $(docker ps -a -q)</div><div><br/></div><div><span style="font-weight: bold;">// コンテナからイメージ作成</span></div><div>$ docker commit [CONTAINER_ID] [イメージ名:タグ名]</div><div><br/></div><div><span style="font-weight: bold;">// コンテナをtarファイルで出力</span></div><div>$ docker export [CONTAINER_ID] &gt; tmp.tar</div><div><br/></div><div><span style="font-weight: bold;"># 出力したtarファイルからイメージ作成</span></div><div>$ act tmp.tar | docker import -  [イメージ名:タグ名]</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">■Dockerfileの文法</span></div><div><br/></div><div><span style="font-weight: bold;">// （</span><span style="font-weight: bold;">Dockerfileは</span><span style="font-weight: bold;">たいてい1行目に）どのイメージからコンテナ生成するか必ず必要(以下の場合はCentOS ver 7のイメージからコンテナ生成)</span></div><div>FROM centos:centos7</div><div><br/></div><div><span style="font-weight: bold;">// （DockerHubのDockerfileはたいてい2行目に）MAINTAINERでDockerfileの作成者指定する</span></div><div>MAINTAINER yokoi</div><div><br/></div><div><span style="font-weight: bold;">// RUN [実行コマンド] でイメージを作成するためのコマンド実行</span></div><div>RUN echo &quot;Hello world&quot;</div><div>RUN pip install mlflow&gt;=1.0</div><div>RUN sudo apt-get -y install graphviz</div><div><br/></div><div><span style="font-weight: bold;">// DockerfileはRUN1行につき内部イメージを1つ重ねて作っている。</span><span style="font-weight: bold;">127行以上（127イメージ一気に作るの）はエラーになるらしい</span></div><div><br/></div><div><span style="font-weight: bold;">// CMD [</span><span style="font-weight: bold;">実行コマンド</span><span style="font-weight: bold;">]で</span><span style="font-weight: bold;">RUNで作った</span><span style="font-weight: bold;">イメージから作成したコンテナでコマンド実行する</span></div><div>CMD /user/sbin/httpd -D FORGROUND # httpdをフォアグラウンドで実行</div><div><br/></div><div><span style="font-weight: bold;">// ENTRYPOINT [</span><span style="font-weight: bold;">実行コマンド</span><span style="font-weight: bold;">] はCMD と役割は同じ。ただし、</span><span style="font-weight: bold;">ENTRYPOINTはコンテナ実行時に行いたいコマンドを強制実行する</span></div><div><br/></div><div><span style="font-weight: bold;">// ENV [キー名] [値] で環境変数設定</span></div><div>ENV name &quot;yokoi&quot;</div><div><br/></div><div><span style="font-weight: bold;">// WORKDIR [ディレクトリのパス] で作業ディレクトリ指定</span></div><div>WORKDIR $PWD/first</div><div><br/></div><div><span style="font-weight: bold;">// EXPORT [ポート番号] でコンテナの公開するポート指定</span></div><div>EXPORT 8080</div><div><br/></div><div><span style="font-weight: bold;">// ADD [ホストファイルのパス] [Dockerイメージのパス] でイメージにホストのファイル/ディレクトリを追加する。tarファイルなどのアーカイブな解凍されて追加される</span></div><div>ADD host.html /docker_dir/</div><div><br/></div><div><span style="font-weight: bold;">// /docker_dir/webにhost.htmlコピー</span></div><div>WORKDIR /docker_dir/</div><div>ADD host.html web/</div><div><br/></div><div><span style="font-weight: bold;">// COPY [ホストファイルのパス] [Dockerイメージのパス] でイメージにホストのファイル/ディレクトリをコピーする</span><span style="font-weight: bold;">。tarファイルなどのアーカイブな解凍されない</span></div><div>COPY host.html /docker_dir/</div><div><br/></div><div><span style="font-weight: bold;">// VOLUME [</span><span style="font-weight: bold;">Dockerイメージのパス</span><span style="font-weight: bold;">] でイメージにマウント</span></div><div>VOLUME /tmp/share</div><div><br/></div><div><span style="font-weight: bold;">// .dockerignoreファイルに書かれたファイルはビルドされない</span></div><div><br/></div><div><span style="font-weight: bold;">// Dockerfileからイメージ作成</span></div><div>$ docker build -t [イメージ名:タグ名]　[Dockerfileのディレクトリ]</div><div>$ docker build -t sample -f Dockerfile . # Dockerfileののパス指定もできる</div><div><br/></div><div><br/></div><div><span style="font-size: 10pt; font-weight: bold;">■docker-composeに関する操作を行うコマンド</span></div><div><span style="font-size: 10pt;"><br/></span></div><div><span style="font-weight: bold;">// docker-composeのバージョンを表示</span></div><div>$ docker-compose version        </div><div><br/></div><div><span style="font-weight: bold;">以下$ cd &lt;docker-compose.yml置いているディレクトリ&gt; 実行後とする</span></div><div><br/></div><div><span style="font-weight: bold;">// docker-composeで起動したコンテナの一覧を表示</span></div><div>$ docker-compose ps           </div><div>   <span style="font-weight: bold;"> </span></div><div><span style="font-weight: bold;">// </span><span style="font-weight: bold;">docker-composeでイメージからコンテナを起動。-dつけてバックグラウンドで実行するとjupyterのtoken表示されないので-dはつけないこと</span></div><div>$ docker-compose up               </div><div><br/></div><div><span style="font-weight: bold;">// docker-composeで起動中のコンテナを強制停止</span></div><div>$ docker-compose kill              </div><div><br/></div><div><span style="font-weight: bold;">// docker-composeで起動中のコンテナを再起動</span></div><div>$ docker-compose restart       <span style="font-weight: bold;"> </span></div><div><br/></div><div><span style="font-weight: bold;">// </span><span style="font-weight: bold;">docker-composeで停止中のコンテナを削除</span></div><div>$ docker-compose rm              </div></div><div><br/></div><div><br/></div><div>■ <span style="font-weight: bold;">docker-compose.ymlの文法</span></div><div><br/></div><div><span style="font-weight: bold;"># ymlファイルのルール</span></div><ul><li><div>pythonと同じくインデントでデータの階層表す</div></li><li><div>「- 」で配列を示す</div></li><li><div># がコメントアウト</div></li></ul><div><br/></div><div><span style="font-weight: bold;"># docker-compose.ymlの記述例</span></div><div># webサーバの設定</div><div>webserver: # docker-compose.ymlでのブロック名。1コンテナに相当する</div><div>    image: httpd:lastest # イメージ指定。コマンド+「:」の後は半角スペースあけること</div><div>    ports:</div><div>        - &quot;8000:80&quot; # ホスト8000ポートをコンテナの80ポートに転送（ポートフォワード）。&quot;&quot;で囲まないとだめ！！！</div><div>    links:        </div><div>        - &quot;dbserver:mysql&quot; # コンテナ間で連携するためのリンク指定。別名(エイリアス名)をmysqlとしている</div><div><br/></div><div># dbサーバの設定</div><div>dbserver:</div><div>    image: mysql</div><div>    volumes_form:</div><div>        - dataonly # 「dataonly」という名前のコンテナをデータ保存先としてマウントする</div><div>    environment:</div><div>        MYSQL_ROOT_PASSWORD: password # 環境変数「MYSQL_ROOT_PASSWORD」を設定して値を「password」にする</div><div><br/></div><div># APサーバの設定</div><div>apserver:</div><div>    build: . # docker buildコマンドと同じ。「.」でカレントディレクトリのDockerfileつかってコンテナ起動</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Dockerのストレージ上げる手順</span></div><div>参考:<a href="https://qiita.com/satoysan/items/1a8ec50fa9eef295ba58">https://qiita.com/satoysan/items/1a8ec50fa9eef295ba58</a></div><div><br/></div><div>1.コマンドプロンプトでコマンドたたいてvdi形式ファイルのリサイズ</div><div>　以下のコマンドは200GBに拡張している</div><div>$ cd C:\Program Files\Oracle\VirtualBox</div><div># 初回はdisk.vmdkのファイルしかないので、VBoxManage clonehd &quot;C:\Users\yokoi.shingo\.docker\machine\machines\default\disk.vmdk&quot; &quot;C:\Users\yokoi.shingo\.docker\machine\machines\default\disk.vdi&quot; --format vdi も実行した</div><div>$ VBoxManage modifyhd &quot;C:\Users\yokoi.shingo\.docker\machine\machines\default\disk.vdi&quot; --resize 204800</div><div><br/></div><div>2.「GNOME Partition Editor」を使って容量再割り当て</div><div>2-1.VirtualBox→ストレージでboot2docker.isoを割り当て除去する</div><div><br/></div><div>2-2.コントローラー:SATAを右クリックして、</div><div>C:\Users\yokoi.shingo\userApp\02.zip\</div><div>gparted-live-1.1.0-5-i686.iso を光学ドライブの追加で割り当てる</div><div><br/></div><div>2-3.その状態で VM を起動すると BIOS 上で GParted が立ち上がる。後は以下のサイト見ながらパーティション拡大する</div><div><a href="http://kabatin.hateblo.jp/entry/2016/02/25/190846">http://kabatin.hateblo.jp/entry/2016/02/25/190846</a></div><div><br/></div><div>2-4.gparted-live-1.1.0-5-i686.isoの割り当てを除去して、boot2docker.isoの割り当てを戻す</div><div>C:\Users\yokoi.shingo\.docker\machine\machines\default</div><div>boot2docker.iso</div><div><br/></div><hr/><div><span style="font-weight: bold;">■UdemyのDocker講座メモ</span></div><div><br/></div><div><span style="font-weight: bold;"># Docker hubから nginx イメージとってきてコンテナたてる</span></div><div><span style="font-weight: bold;"># -dはデタッチモード。バックグラウンドでコンテナ起動する。別シェル立ち上げなくても続けてコマンド打てる</span></div><div>$ docker run --name test-nginx -d -p 8888:80 nginx</div><div>→<a href="http://localhost:8888/">http://localhost:8888/</a></div><div><br/></div><div><span style="font-weight: bold;"># Docker チュートリアルの docker/whalesay イメージとってきてコンテナたてる</span></div><div>$ docker run docker/whalesay cowsay Hello!</div><div>$ docker rm 90ebf7890a9a</div><div><br/></div><div><span style="font-weight: bold;"># イメージの詳細表示。マウント先のパスとか見れる</span></div><div>$ docker inspect hello-world</div><div><br/></div><div><span style="font-weight: bold;"># イメージ強制削除</span></div><div>$ docker rmi -f イメージ名/イメージID</div><div><br/></div><div><span style="font-weight: bold;"># イメージだけダウンロード latestが最新ではないケースあるらしい。latestはタグ無しイメージという意味なので</span></div><div>$ docker pull docker/whalesay:latest</div><div><br/></div><div><span style="font-weight: bold;"># Dockerfileビルド</span></div><div><span style="font-weight: bold;"># -t はタグ名の指定</span></div><div><span style="font-weight: bold;"># . はビルドコンテキスト。カレントディレクトリの内容をDockerデーモンに送る</span></div><div>$ cd ~/my_Docker/docker_tutrial/imagebuild</div><div>$ docker build -t docker-whale .</div><div>$ docker run docker-whale  # コンテナ起動</div><div><br/></div><div><span style="font-weight: bold;">#  --no-cacheはイメージの内容をキャッシュに残したくない場合つける</span></div><div>$ docker build --no-cache -t docker-whale .</div><div><br/></div><div><span style="font-weight: bold;"># Docker hubにイメージup（githubみたいにネットつながればどっからでもイメージとれるようになる）</span></div><div>1. <a href="https://hub.docker.com/">https://hub.docker.com/</a> にサインインし、リポジトリ作成（任意の名前つける）してクリエイト</div><div>※privateリポジトリは1個しか作れないが、publicリポジトリは制限なし</div><div><br/></div><div>2. $ docker login 叩いてDocker hubにログイン</div><div>Username: anonamename</div><div>Password:shingorider1</div><div><br/></div><div>3. upするローカルのイメージをタグ付け</div><div>$ docker tag docker-whale anonamename/docker-whale:0.0.1</div><div><br/></div><div>4. pushコマンドでupする</div><div>$ docker push anonamename/docker-whale:0.0.1</div><div><br/></div><div>5. Dockker hubのサイトに行ってpushされたか確認</div><div><a href="https://hub.docker.com/repository/docker/anonamename/docker-whale/tags?page=1">https://hub.docker.com/repository/docker/anonamename/docker-whale/tags?page=1</a></div><div><br/></div><div>（やらなくてもいい）</div><div>6. 3でタグ付けしたイメージ削除して、upしたイメージpullしてみる</div><div>$ docker rmi -f 515798f20917</div><div>$ docker pull anonamename/docker-whale:0.0.1</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># ディレクトリマウントさせてnginxコンテナ起動</span></div><div><span style="font-weight: bold;"># --rmでコンテナ停止したらコンテナ自動削除</span></div><div>$ docker run --name tmp-nginx \</div><div>--rm \</div><div>-v /c/Users/yokoi.shingo/my_Docker/docker_tutrial/html:/usr/share/nginx/html:ro \</div><div>-d \</div><div>-p 8888:80 nginx</div><div>→<a href="http://localhost:8888/">http://localhost:8888/</a></div><div>※コンテナ実行中にhtml編集しても即時で変更内容反映される</div><div><br/></div><div><span style="font-weight: bold;"># 実行中コンテナからファイルをコピーしてくる</span></div><div>$ cd ~/my_Docker/docker_tutrial/copy_lecture</div><div>$ docker cp tmp-nginx:/etc/nginx/conf.d/default.conf ./</div><div><br/></div><div><span style="font-weight: bold;"># 上のコマンドでコピーしたファイルをDockerfile内でコピーするように書いてコンテナ実行</span></div><div>$ cd ~/my_Docker/docker_tutrial/copy_lecture</div><div>$ docker build -t nginx:ver1 .</div><div>$ docker run -p 8888:80 --rm nginx:ver1</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># 起動中のコンテナのシェルに接続</span></div><div>$ docker run -it --entrypoint /bin/bash --name python python:3.7</div><div>$ docker run --name tmp -it -d --rm ubuntu /bin/bash</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># コンテナ強制削除</span></div><div># docker rm -f &lt;コンテナID&gt;</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># コンテナからイメージを作成</span></div><div>$ docker commit &lt;コンテナ名/コンテナID&gt; &lt;イメージ名&gt;:&lt;タグ&gt;</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Docker Desktopの良いところ</span></div><div>・Docker Desktopは主にローカルでの開発用</div><div>・GUIから起動停止を行ったり、アップデートを自動で行ったり、PC上で使いやすい様な機能が色々と付いている。</div><div>・PC上のファイルも特別な設定を必要とせず簡単にコンテナにバインドマウントできる様になっている。</div><div>・Docker DesktopによってDockerの実行環境のLinuxの仮想マシンが管理されるため、自身で起動したり停止したりといったことも行わずに済む（PCを起動すれば通常自動で立ち上がります）。</div><div><br/></div><div><span style="font-weight: bold;"># Docker Machineの良いところ</span></div><div><span style="font-weight: bold;">※Docker Machine: Docker Engineを搭載した仮想マシンの作成、起動、停止、再起動などをコマンドラインから実行できるツール</span></div><div>　Docker tool boxインストールしたら同時にインストールされる</div><div>　Docker上でさらに仮想環境を作ることなのでサンドボックス的な使い方にも向いている</div><div>　ローカルPC（Docker tool boxをインストールしたPCのこと）だけでなく、GCPとかリモートのクラウドプロバイダでDockerホストを立ち上げて管理できる</div><div>主に複数台必要な環境（主にswarm）の検証に使用したり、リモートのサーバー（クラウドのサーバー）にDockerをインストールしたい場合などに利用</div><div><br/></div><div><span style="font-weight: bold;"># Docker machine一覧</span></div><div>$ docker-machine ls</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホスト（別の仮想環境）作成</span></div><div>$ docker-machine create --driver virtualbox default  # defaultという名前のホスト作成</div><div><br/></div><div><span style="font-weight: bold;"># Docker machine切り替え</span></div><div>$ docker-machine env default</div><div>export DOCKER_TLS_VERIFY=&quot;1&quot;</div><div>export DOCKER_HOST=&quot;<a href="tcp://192.168.99.100:2376">tcp://192.168.99.100:2376</a>&quot;</div><div>export DOCKER_CERT_PATH=&quot;C:\Users\yokoi.shingo\.docker\machine\machines\default&quot;</div><div>export DOCKER_MACHINE_NAME=&quot;default&quot;</div><div>export COMPOSE_CONVERT_WINDOWS_PATHS=&quot;true&quot;</div><div># Run this command to configure your shell:</div><div># eval $(&quot;C:\Program Files\Docker Toolbox\docker-machine.exe&quot; env default)</div><div>→$ eval $(&quot;C:\Program Files\Docker Toolbox\docker-machine.exe&quot; env default) でまとめて環境変数設定して起動</div><div>　$ docker run hello-world でdocker machineでコンテナ実行</div><div><br/></div><div><span style="font-weight: bold;"># 現在アクティブなDocker machine確認</span></div><div>$ docker-machine ls</div><div>$ eval $(&quot;C:\Program Files\Docker Toolbox\docker-machine.exe&quot; env default)  # defaultに戻す場合</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホストにsshで接続</span></div><div>$ docker-machine ssh default</div><div>→表示が docker@default: … に変わり接続できたことわかる</div><div>$ exit  # ローカルPCにもどる</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホストのipアドレス確認</span></div><div>$ docker-machine ip default</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホスト停止</span></div><div>$ docker-machine stop default  # defaultホスト停止</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホスト起動</span></div><div>$ docker-machine start default  # defaultホスト起動</div><div><br/></div><div><span style="font-weight: bold;"># Docker machineのホスト削除</span></div><div>$ docker-machine stop nw-vm1</div><div>$ docker-machine rm nw-vm1</div><div><br/></div><div><span style="font-weight: bold;"># GCPでDocker machine接続</span></div><div><span style="font-weight: bold;">1. GCPでプロジェクト作成</span></div><div>　→私用のアカウントでDocker Testというプロジェクト作った</div><div>　　メニュー→IAMと管理→サービスアカウント→サービスアカウントの作成→サービスアカウント名なんでもいい。アクセス権限はオーナーで作成</div><div>　　→作成したサービスアカウントの操作から「鍵を作成」でjson形式の秘密鍵ダウンロード</div><div><span style="font-weight: bold;">2. 環境変数にダウンロードしたjsonのパスを書く</span></div><div>$ export GOOGLE_APPLICATION_CERDENTIALS=/c/Users/yokoi.shingo/my_Docker/docker_tutrial/GCP/Docker_Test/docker-test-287604-94badac72211.json</div><div><br/></div><div><span style="font-weight: bold;">3. GCP上にdocker machineのホスト作成</span></div><div><span style="font-weight: bold;"># vm01というホストを作成する</span></div><div>$ docker-machine create --driver google --google-project docker-test-287604(これはGCPで作成したプロジェクトID) --google-zone asia-northeast1-a vm01</div><div>→これたたけばホストできて、$ docker-machine ssh vm01 で入れるはずだが失敗する。。。</div><div><br/></div><div><span style="font-weight: bold;"># ブリッジドライバ：Dockerで小規模なネットワーク構成を作る場合に使用する</span></div><div><span style="font-weight: bold;"># 試しにdocker machine上でネットワーク作ってみる</span></div><div>$ docker-machine create nw-vm1  # docker machineのホスト作成</div><div>$ docker-machine ssh nw-vm1  # sshで接続</div><div>$ docker run -itd --name alpine1 alpine /bin/sh  # 試しにalpineコンテナ起動。ブリッジネットワーク（デフォルトのネットワーク）にalpine1のコンテナが接続される</div><div>$ docker network inspect bridge  # ネットワークの詳細表示</div><div>→以下のようにコンテナズの中にalpine1が入ってるのがわかる</div><div>        &quot;Containers&quot;: {</div><div>            &quot;3fd4b7114b6c0fb651051f6e427103baad87b963814d7daa8d96c6b464b23cfd&quot;: {</div><div>                &quot;Name&quot;: &quot;alpine1&quot;,</div><div>                &quot;EndpointID&quot;: &quot;3804e7f4bd390e5400f289d44172baf46b7f6b3986a1fa1a85a9df586bb30eb0&quot;,</div><div>                &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</div><div>                &quot;IPv4Address&quot;: &quot;172.17.0.2/16&quot;,</div><div>                &quot;IPv6Address&quot;: &quot;&quot;</div><div>            }</div><div>→コンテナ間の通信は上のIPv4Address のアドレスから通信できる。試しにもう一つコンテナ立ち上げて比べる</div><div>$ docker run -itd --name alpine2 alpine /bin/sh  # alpine2コンテナ作成</div><div>$ docker attach alpine2  # alpine2コンテナに入る</div><div>$ ip addr show  # ip情報確認</div><div>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1000                                               link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00                                                                   inet 127.0.0.1/8 scope host lo</div><div>       valid_lft forever preferred_lft forever</div><div>2: sit0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN qlen 1000</div><div>    link/sit 0.0.0.0 brd 0.0.0.0</div><div>9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue state UP</div><div>    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff</div><div>    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0</div><div>       valid_lft forever preferred_lft forever</div><div>$ ping -w 3 172.17.0.2  # alpine1のipに3秒間ping飛ばす。ipじゃないと通信できない。コンテナ名では不可能。設定いじればできる</div><div>→通信できてる</div><div><br/></div><div><span style="font-weight: bold;"># ブリッジネットワーク（デフォルトのネットワーク）からコンテナ切り離す</span></div><div>$ docker network disconnect bridge alpine2</div><div>$ docker inspect alpine2  # ネットワーク切れたか確認</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># noneネットワーク（どことも接続できないネットワーク）に接続</span></div><div>$ docker run -itd --name none --network none alpine /bin/sh  # noneネットワークにコンテナ作成</div><div>$ docker attach none  # noneネットワークに入る</div><div>$ ip addr show  # ip無しなのがわかる</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># hostネットワーク（hostのネットワーク設定を持つ。-pフラグでポート指定なしでもwebアプリ接続できるらしい）</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Dockerのnetwork一覧確認</span></div><div>$ docker network ls</div><div><br/></div><div><span style="font-weight: bold;"># Dockerの各networkの詳細確認</span></div><div>$ docker network inspect bridge(ネットワークのドライバ名)</div><div><br/></div><div><span style="font-weight: bold;"># ユーザ定義のブリッジネットワーク作成</span></div><div>$ docker network create my_nw(任意のネットワーク名)</div><div>$ docker network ls  # my_nw 追加されたこと確認できる</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># volumeコマンド。Docker上にファイルマウント(=データを永続化。コンテナ破棄しても消えないように)する場所作成</span></div><div>$ docker volume create my-vol  # my-volという名前でマウント先作成</div><div><br/></div><div><span style="font-weight: bold;"># 存在するvolume確認</span></div><div>$ docker volume ls</div><div><br/></div><div><span style="font-weight: bold;"># volumeの詳細確認</span></div><div>$ docker volume inspect my-vol</div><div><br/></div><div><span style="font-weight: bold;"># volumeの削除</span></div><div>$ docker volume rm my-vol</div><div><br/></div><div><span style="font-weight: bold;"># -vフラグでvolumeマウントする方法</span></div><div><span style="font-weight: bold;"># -v &lt;マウントするボリューム名&gt;:&lt;コンテナ上にマウントするパス&gt;</span></div><div><span style="font-weight: bold;"># マウントするボリューム名が存在しなければ新規にディレクトリ作成される</span></div><div>$ docker run -itd --name mount-c1 -v vol1:/app nginx</div><div>$ docker inspect mount-c1  # volumeの詳細確認</div><div>$ docker exec -it mount-c1 /bin/bash  # コンテナに入る</div><div>root@bec3a0da4338:/# df  # volumeの詳細確認</div><div><br/></div><div><span style="font-weight: bold;"># -vフラグでカレントディレクトリをvolumeマウントする方法（バインドマウント=ホスト側でファイル変更できるマウント）</span></div><div><span style="font-weight: bold;"># ホストに./sourceディレクトリ存在しなければ自動でディレクトリ作られる</span></div><div>$ docker run -itd --name mount-c1 -v &quot;$(pwd)&quot;/source:/app nginx</div><div><br/></div><div><span style="font-weight: bold;"># -vフラグかつ読み取り専用でvolumeマウントする方法</span></div><div><span style="font-weight: bold;"># roを:くぎる。</span></div><div>$ docker run -itd --name mount-c1 -v vol1:/app:ro nginx</div><div>$ docker inspect mount-c1  # volumeの詳細確認したらRWがfalseになっている</div><div><br/></div><div><span style="font-weight: bold;"># --mountフラグでvolumeマウントする方法(-vと同じ意味)</span></div><div><span style="font-weight: bold;"># sourceがローカルのマウント元。targetがコンテナのマウント先。,にスペース入れたらエラー</span></div><div>$ docker run -itd --name mount-c2 --mount source=vol1,target=/app nginx</div><div>$ docker exec -it mount-c2 /bin/bash  # コンテナに入る</div><div><br/></div><div><span style="font-weight: bold;"># --mountフラグかつ読み取り専用でvolumeマウントする方法(-vと同じ意味)</span></div><div><span style="font-weight: bold;"># readonlyをカンマでくぎる。</span></div><div>$ docker run -itd --name mount-c2 --mount source=copy-vol,destination=/etc/nginx,readonly nginx</div><div>$ docker inspect mount-c1  # volumeの詳細確認したらRWがfalseになっている</div><div><br/></div><div><span style="font-weight: bold;"># -mountフラグでカレントディレクトリをvolumeマウントする方法（バインドマウント）</span></div><div><span style="font-weight: bold;"># ホストに./vol1ディレクトリ存在しなければエラー</span></div><div>$ docker run -itd --name mount-c2 --mount type=bind,source=vol1,target=/app nginx</div><div><br/></div><div><span style="font-weight: bold;"># tmpfs:メモリ上にマウントする。コンテナ削除したらデータ消える</span></div><div>$ docker run -itd --name mount-c2 --mount type=tmpfs,destination=/app nginx</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Docker compose:マルチコンテナのアプリケーションを定義して実行するためのツール</span></div><div><span style="font-weight: bold;">webサーバ、DBサーバのコンテナ一気に起動して開発環境作るときに使われる</span></div><div><span style="font-weight: bold;">docker-compose.ymlファイルにコンテナのコマンド書いて、docker-compose up -dで起動する</span></div><div><span style="font-weight: bold;">&lt;docker-compose.ymlの例&gt;</span></div><div>version: '3'  # docker-composeのファイル形式のバージョン。基本'3'。以下はバージョン3の書き方</div><div>services:  # 後で書いてるdocker serviceに対応</div><div>  web:  #  サービス名。任意の名前でok。ここでは1コンテナだけ起動してる</div><div>    build: .  # ビルドコンテキスト=Dockerfileファイルの置き場所</div><div>    ports:</div><div>    - &quot;5000:5000&quot;  # ホストの5000ポートを公開してコンテナの50ポートに転送</div><div>    volumes:  # -vオプションの内容</div><div>    - .:/code  # ホストのカレントディレクトリをバインドマウント</div><div>    - logvolume01:/var/log  # ホストのlogvolume01ディレクトリをバインドマウント</div><div>    links:  # 同時に立ち上げる別サービスと接続</div><div>    -redis  # サービス名</div><div>  redis  #  サービス名。任意の名前でok。ここでは1コンテナだけ起動してる</div><div>     image: redis  # redisイメージからコンテナ起動</div><div>volumes:  # 上で名前つけたvolume(logvolume01)書いてるのでlogvolume01の定義が必要</div><div>  logvolume01: {}  # ドライバの指定などがあるなら{}の中に書く。今回はなしなので{}だけ。{}無くても動く</div><div><br/></div><div><span style="font-weight: bold;"># docker-composeコマンドがインストールされているかチェック</span></div><div>$ docker-compose -v</div><div>→問題なければバージョン情報が出る</div><div><br/></div><div><span style="font-weight: bold;"># docker-composeのコンテナ削除。-vで関連するコンテナすべて削除</span></div><div>$ docker-compose down -v</div><div>$ docker-compose ps  # 消えてること確認</div><div><br/></div><div><span style="font-weight: bold;"># docker-composeのコンテナ停止</span></div><div>$ docker-compose stop</div><div>$ docker-compose start  # 開始</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Docker Swarmのクラスタは複数のコンテナを分散管理する仕組み</span></div><div><span style="font-weight: bold;">　複数のdocker-machineでネットワークを作り各docker-machineのコンテナと接続する</span></div><div><span style="font-weight: bold;">　tensorflowの分散学習みたいに管理用のマネージャーノードとワーカーノードに分かれて処理を行える</span></div><div><span style="font-weight: bold;">　サーバみたいに１つのワーカが落ちても他のワーカーが処理引き受けたりできる</span></div><div><span style="font-weight: bold;">例.マネージャとワーカ2個のクラスタ作る</span></div><div>$ docker-machine create manager1</div><div>$ docker-machine create worker1</div><div>$ docker-machine create worker2</div><div>$ docker-machine ip manager1  # ip確認(192.168.99.103)</div><div>$ eval $(docker-machine env manager1)  # docker-machine切り替え</div><div>$ docker swarm init --advertise-addr 192.168.99.103  # manager1のswarmモードを有効にする</div><div>$ docker swarm join-token manager  # node追加させるためのコマンド表示</div><div>To add a manager to this swarm, run the following command:</div><div>    docker swarm join --token SWMTKN-1-13iyq3qnjoc7kpumudlnu32pztdhlikdlo8l4076wieli21y8t-awinq56a7br8a1oe3uej5xn9n 192.168.99.103:2377</div><div>$ eval $(docker-machine env worker1)  # docker-machine切り替え</div><div>$ docker swarm join --token SWMTKN-1-13iyq3qnjoc7kpumudlnu32pztdhlikdlo8l4076wieli21y8t-awinq56a7br8a1oe3uej5xn9n 192.168.99.103:2377</div><div>$ eval $(docker-machine env worker2)  # docker-machine切り替え</div><div>$ docker swarm join --token SWMTKN-1-13iyq3qnjoc7kpumudlnu32pztdhlikdlo8l4076wieli21y8t-awinq56a7br8a1oe3uej5xn9n 192.168.99.103:2377</div><div>$ eval $(docker-machine env manager1)  # docker-machine切り替え</div><div>$ docker node ls  # nodeの状態一覧で確認。マネージャノードでしか使えないコマンド</div><div><br/></div><div><span style="font-weight: bold;"># 今いるdocker-machineのSwarm解除</span></div><div>$ docker swarm leave -f</div><div><br/></div><div><span style="font-weight: bold;"># Swarmでサービス作成（それぞれのノードでnginx起動）</span></div><div>$ eval $(docker-machine env manager1)</div><div>$ docker service create -d --name nginx --replicas 3 --publish 8080:80 nginx  # --replicas 3で3並列でnginx起動。--publish 8080:80でポート指定</div><div>$ docker service ps nginx  # サービスの状態確認</div><div>$ docker-machine ls  # それぞれのdocker-machineのip確認。ブラウザでip:8080入れたらnginx見れる</div><div><br/></div><div><span style="font-weight: bold;"># Swarmのサービス一覧表示</span></div><div>$ docker service ls</div><div><br/></div><div><span style="font-weight: bold;"># Swarmのサービス詳細表示</span></div><div>$ docker service inspect nginx  # サービス名指定必要</div><div><br/></div><div><span style="font-weight: bold;"># Swarmのサービス状態表示</span></div><div>$ docker service ps nginx</div><div><br/></div><div><span style="font-weight: bold;"># Swarmのサービス削除</span></div><div>$ docker service remove nginx</div><div><br/></div><div><span style="font-weight: bold;"># Swarmのルーティングメッシュはロードバランサを付ける機能（要は負荷分散機能）</span></div><div>$ eval $(docker-machine env manager1)</div><div>$ docker service create --name host-nginx --publish mode=host,published=8080,target=80 --replicas 2 nginx  # replicas 2なので今ある3つのノードの2つでサービス実行</div><div><br/></div><div><span style="font-weight: bold;"># Swarmにはグローバルモードとレプリカモードがある。これまでの--replicas 3はレプリカモード</span></div><div><span style="font-weight: bold;">　グローバルモードは1ノードで1タスク実行する。レプリカモードはノードより多い/少ない数のタスクを実行することができる</span></div><div><span style="font-weight: bold;"># グローバルモードで実行</span></div><div>$ docker service create -d --name nginx --global --publish 8080:80 nginx</div><div><br/></div><div><span style="font-weight: bold;"># サービス起動後からレプリカ数変更する方法</span></div><div>$ eval $(docker-machine env manager1)</div><div>$ docker service create -d --name nginx --replicas 2 --publish 8080:80 nginx  # レプリカ数2のサービス起動</div><div>$ docker service ls  # 確認</div><div>$ docker service scale nginx=4  # レプリカ数4に変更</div><div>$ docker service ls  # 確認</div><div>$ docker service scale nginx=2  # レプリカ数2に変更</div><div>$ docker service ls  # 確認</div><div>$ docker service remove nginx  # 消しとく</div><div><br/></div><div><span style="font-weight: bold;"># docker-compose.ymlでサービス起動</span></div><div>$ docker stack deploy --compose-file docker-compose.yml wp  # wpはサービス名</div><div>$ docker stack remove wp  # サービス削除</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># Kitematic(カイトマティック): DockerをGUIで管理するソフトウエア</span></div><div>　Docke toolboxからインストールできる</div><div>　docker hubからimageをボタンクリックでインストールできる</div><div><br/></div><hr/><div><span style="font-weight: bold;">■Windowsの R の環境変数通し方</span></div></div><div>参考: <a href="https://tetdm.jp/pukiwiki/index.php?plugin=attach&amp;refer=R%E5%88%A9%E7%94%A8%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%88%A9%E7%94%A8%E6%BA%96%E5%82%99&amp;openfile=WINDOWS%E7%94%A8R%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB.pdf">https://tetdm.jp/pukiwiki/index.php?plugin=attach&amp;refer=R%E5%88%A9%E7%94%A8%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E5%88%A9%E7%94%A8%E6%BA%96%E5%82%99&amp;openfile=WINDOWS%E7%94%A8R%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB.pdf</a></div><div><br/></div><div>20200507</div><div><br/></div><div>1.R をインストール</div><div>以下のサイトで Windows 用の R のインストーラをダウンロード</div><div><a href="https://cran.ism.ac.jp/">https://cran.ism.ac.jp/</a></div><div><br/></div><div>2.コントロールパネル → システムの詳細設定→「環境変数」→「システム環境変数の変数「Path」を選択」→「編集」を選択してRのbinのパスを追加する</div><div><img src="環境構築ログ_files/Image.png" type="image/png" data-filename="Image.png" width="375"/></div><div>→コマンドプロンプトで R と叩くとR使える</div><div><br/></div><div><br/></div><hr/><div><span style="font-size: 14px;"><span style="font-size: 14px; font-weight: bold;">■ubuntuのR再インストール </span></span></div><div><span style="font-size: 14px;">1.下記の5ディレクトリ削除($ sudo rm -rf で)。古いR残ってるとうまく行かなそう</span></div><div><span style="font-size: 14px;">参考:<a href="https://stackoverflow.com/questions/24118558/complete-remove-and-reinstall-r-including-all-packages/24118876" style="font-size: 14px;">https://stackoverflow.com/questions/24118558/complete-remove-and-reinstall-r-including-all-packages/24118876</a></span></div><div>/home/shingo/R/x86_64-pc-linux-gnu-library/3.6</div><div><span style="font-size: 14px;">/usr/local/lib/R/site-library</span></div><div><span style="font-size: 14px;">/usr/lib/R/site-library</span></div><div><span style="font-size: 14px;">/usr/lib/R/library</span></div><div><span style="font-size: 14px;">~/R</span></div><div><span style="font-size: 14px;"><br/></span></div><div><span style="font-size: 14px;">2.下記コマンド叩いてCRANの設定を</span><span style="font-size: 14px;">/etc/apt/sources.list に書き込む</span></div><div><span style="font-size: 14px;">$ echo -e &quot;\n## For R package&quot;  | sudo tee -a /etc/apt/sources.list</span></div><div><span style="font-size: 14px;">$ echo &quot;deb</span> <a href="https://cran.rstudio.com/bin/linux/ubuntu" style="font-size: 14px;">https://cran.rstudio.com/bin/linux/ubuntu</a> <span style="font-size: 14px;">$(lsb_release -cs)-cran35/&quot; | sudo tee -a /etc/apt/sources.list</span></div><div><span style="font-size: 14px;">$ sudo apt-key adv --keyserver</span> <a href="http://keyserver.ubuntu.com/" style="font-size: 14px;">keyserver.ubuntu.com</a> <span style="font-size: 14px;">--recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9</span></div><div><span style="font-size: 14px;"><br/></span></div><div><span style="font-size: 14px;">3.下記コマンド叩いてRのその他設定諸々消す</span></div><div><span style="font-size: 14px;">$ sudo apt-get remove r-base-core</span></div><div><span style="font-size: 14px;">$ sudo apt-get remove r-base</span></div><div><span style="font-size: 14px;">$ sudo apt-get autoremove</span></div><div><span style="font-size: 14px;"><br/></span></div><div><span style="font-size: 14px;">4.下記コマンド叩いて最新版のR再インストール</span></div><div><span style="font-size: 14px;">参考:<a href="https://www.datacamp.com/community/tutorials/installing-R-windows-mac-ubuntu" style="font-size: 14px;">https://www.datacamp.com/community/tutorials/installing-R-windows-mac-ubuntu</a></span></div><div><span style="font-size: 14px;">$ sudo apt update</span></div><div><span style="font-size: 14px;">$ sudo apt -y upgrade</span></div><div><span style="font-size: 14px;">$ sudo apt -y install r-base</span></div><div><span style="font-size: 14px;"><br/></span></div><div><span style="font-size: 14px;">5.Rをsudoで起動したらggplot2インストールできた(エラー出てたがlibraryは通る)</span></div><div><span style="font-size: 14px;">$ sudo R</span></div><div><span style="font-size: 14px;">&gt; install.packages(&quot;ggplot2&quot;,dependencies = TRUE)</span></div><div><span style="font-size: 14px;">&gt; library(&quot;ggplot2&quot;)</span></div><div><span style="font-size: 14px;">&gt; install.packages(&quot;tidyverse&quot;,dependencies = TRUE)</span></div><div><span style="font-size: 14px;">&gt; </span><span style="font-size: 14px;">library(&quot;tidyverse&quot;)</span></div><div><span style="font-size: 14px;"><br/></span></div></div><hr/><div><span style="font-weight: bold;">■Git/GitHubの初期設定（ドスパラのPCでやった）</span></div><div>参考:<a href="https://employment.en-japan.com/engineerhub/entry/2017/01/31/110000">https://employment.en-japan.com/engineerhub/entry/2017/01/31/110000</a></div><div><br/></div><div>1. Git For Windows ダウンロード</div><div><a href="https://git-scm.com/">https://git-scm.com/</a></div><div><br/></div><div>2. ダウンロードしたファイルをダブルクリックしてインストーラーを起動</div><div>→全部デフォルトで Next 押し続けたらいい</div><div><br/></div><div>3. 環境変数にPath追加（コマンドプロンプトでgitコマンド使えるようになる）</div><div>コントロールパネル → システムの詳細設定→「環境変数」→「システム環境変数の変数「Path」を選択」→「編集」を選択</div><div>C:\Program Files\Git\bin</div><div>追加</div><div><br/></div><div>4. ユーザー名とメールアドレスを設定（コマンドプロンプト or Git Bash のどっちかから実行）</div><div>$ git config --global user.name <a href="mailto:rironyokoi@gmail.com">rironyokoi@gmail.com</a></div><div>$ git config --global user.email riron1206</div><div>$ git config --list  # でうまくいったか確認できる</div><div><br/></div><div>5. SSHの鍵を取得</div><div>$ ssh-keygen -t rsa -b 4096 -C <a href="mailto:rironyokoi@gmail.com">rironyokoi@gmail.com</a></div><div><br/></div><div>上記のssh-keygenコマンドを入力すると、</div><div>生成される鍵のファイル名と出力場所を確認するメッセージが表示され</div><div>「id_rsa」というファイル名のままでよければ、そのままEnter押す</div><div>変更する場合はフルパス入力してEnter押す</div><div><br/></div><div>続いて、パスフレーズ（=パスワード）を決める</div><div>shingorider1</div><div>を入力して、パスフレーズ設定した</div><div>→パスフレーズの入力が完了すると、</div><div>　秘密鍵（id_rsa_github）と公開鍵（id_rsa_github.pub）のペアが「id_rsa」フォルダに生成される</div><div><br/></div><div>.pub拡張子がついている公開鍵は、</div><div>GitHubなど、SSHで接続したい先のサービスに登録しておくもの</div><div>SSH通信をする際に、手元の秘密鍵と通信先に登録してある公開鍵が照合されて、認証が成功</div><div>これにより、秘密鍵を持っている自分のみが通信を許可される仕組み</div><div><br/></div><div>6. 生成された秘密鍵のパーミッションを600に変更（Git Bashでないと実行できないので注意!!!!）</div><div>$ chmod 600 ~/.ssh/id_rsa</div><div><br/></div><div>7. SSHのconfigファイルを編集（GitHubへSSH接続する際に、どの秘密鍵を指定するのかを管理するため）</div><div>$ vim ~/.ssh/config</div><div>vimの操作参考: <a href="https://qiita.com/hide/items/5bfe5b322872c61a6896">https://qiita.com/hide/items/5bfe5b322872c61a6896</a></div><div>→i で挿入モードへ</div><div>→以下の文追記</div><div>Host github</div><div>  HostName <a href="http://github.com/">github.com</a></div><div>  User git</div><div>  IdentityFile ~/.ssh/id_rsa</div><div>→ESCキーで、コマンドモードに戻る</div><div>→ZZ入力で、上書き保存し、viを終了</div><div><br/></div><div>8. GitHubのアカウントを作成</div><div><a href="https://github.com/">https://github.com/</a></div><div>→まだアカウントを持っていなければ、上記サイトの右側のテキストボックスにそれぞれ、取得したいユーザー名、メールアドレス、設定したいパスワードを入力し、「Sign up for GitHub」をクリック</div><div><br/></div><div>9. GitHubでリポジトリ作成</div><div><br/></div><div>10. GitHubに公開鍵を登録</div><div>→保存した公開鍵(C:\Users\81908\.ssh\id_rsa.pub)をエディタで開き、中の文字列をコピー</div><div>※コピーする際に改行や余分な文字列が入らないように注意</div><div>→<a href="https://github.com/settings/ssh/new">https://github.com/settings/ssh/new</a> 開く</div><div>　■「Title」に どのPC・サーバに置かれた鍵に対する公開鍵なのか分かるよう、PC名・サーバ名を入れておく</div><div>　　→DESKTOP-IHA4N7R を入れた</div><div>　■「Key」には、先ほどコピーした公開鍵の値をそのまま貼り付け</div><div>　■入力したら「Add SSH key」をクリック</div><div><br/></div><div>11. GitHubへのSSH接続を確認</div><div>$ ssh github</div><div>→パスフレーズ(shingorider1)入れたらアクセス成功する</div><div><br/></div><hr/><div>■GitHubにpushするとき毎回パスワード聞かれるの回避（ドスパラのPCでやった）</div></div><div>→原因：https通信だったので毎回聞かれる。ssh通信に変更する</div><div><a href="https://qiita.com/rorensu2236/items/df7d4c2cf621eeddd468">https://qiita.com/rorensu2236/items/df7d4c2cf621eeddd468</a></div><div><br/></div><div>1.対象のgitディレクトリに移動</div><div>$ cd C:\Users\81908\MyGitHub\memo</div><div><br/></div><div>2.通信方法確認</div><div>$ git remote -v</div><div>origin<span style="font-weight: bold;">  </span><a href="https://github.com/riron1206/memo.git" style="font-weight: bold;">https://github.com/</a>riron1206/memo.git (fetch)</div><div>origin <span style="font-weight: bold;"> </span><a href="https://github.com/riron1206/memo.git" style="font-weight: bold;">https://github.com/</a>riron1206/memo.git (push)</div><div>→httpsになってる</div><div><br/></div><div>3.ssh形式に書き換える</div><div>$ git remote set-url origin <a href="mailto:git@github.com" style="color: rgb(255, 0, 0); font-weight: bold;">git@github.com</a><span style="color: rgb(255, 0, 0); font-weight: bold;">:riron1206/memo.git</span></div><div>$ git remote -v</div><div>origin <span style="font-weight: bold;"> </span><a href="mailto:git@github.com" style="font-weight: bold;">git@github.com</a><span style="font-weight: bold;">:</span>riron1206/memo.git (fetch)</div><div><div>origin  <a href="mailto:git@github.com" style="font-weight: bold;">git@github.com</a><span style="font-weight: bold;">:</span>riron1206/memo.git (push)</div><div><br/></div><div>4.git pushすると以下のようなパスフレーズ聞かれる。ドスパラPCからのパスフレーズは「shingo*****1」。これ打てばpush完了!!!</div><div><img src="環境構築ログ_files/Image [1].png" type="image/png" data-filename="Image.png" width="581"/></div><div><br/></div><div><br/></div><hr/><div>■Gitコマンド</div><div><br/></div><div># 変更分のファイル名のみ表示</div><div>$ git diff --name-only  </div><div><br/></div><div><br/></div></div><hr/><div><span style="font-weight: bold;">■Poetry(ポエトリー)：仮想環境を作りpythonの依存関係を管理するツール</span></div><div><br/></div><div><span style="font-weight: bold;">→プロジェクト単位でパッケージ管理したいときに一番適している</span></div><div>　サンドボックス的な環境ならanacondaで十分と感じた。</div><div>　複数人で無駄なパッケージ使いたくないときに向いてるってこと（Docker+pipでいい気もするが。。。）</div><div><br/></div><div><span style="font-weight: bold;">→注意が必要なのはPoetryをキックするpythonのバージョン管理はできない</span></div><div>　<span style="color: rgb(255, 0, 0);">キックするpythonのバージョンがpoetryの設定ファイルと一致していなければ仮想環境構築($poetry installなど)は失敗する</span>し、うまくいってもpoetry installでロードされるpyproject.toml に書いてる依存関係パッケージのバージョン不整合で死ぬ</div><div><br/></div><div><span style="font-weight: bold;">→実行するpython（いろんなバージョンのpython保持）管理が必要</span></div><div>　これをPyenvで行うのがセオリーみたい（2020/08時点では）</div><div>　<span style="color: rgb(255, 0, 0);">Pyenvで複数バージョンpython環境保持して、パッケージ配布はPoetryで行う</span></div><div><br/></div><div>→裏でvirtualenvを作ってくれてる（virtualenvを勝手に作って管理。パッケージ自体はpipでとってくる）</div><div>poetry run [shell script] で venv下でスクリプトを実行</div><div><a href="https://qiita.com/termoshtt/items/64a01541145167a5a9cc">https://qiita.com/termoshtt/items/64a01541145167a5a9cc</a></div><div><br/></div><div>＜poetryインストール方法＞</div><div>①Windowsの設定</div><div><a href="https://qiita.com/moochannel/items/c1a46a2a29f06ce86b78">https://qiita.com/moochannel/items/c1a46a2a29f06ce86b78</a></div><div>Windowsの設定→アプリと機能→アプリ実行エイリアスを開くとアプリ インストーラー(python.exe)とアプリ インストーラー(python3.exe)があるので、両方オフにする</div><div><br/></div><div>②インストールコマンド</div><div><a href="https://python-poetry.org/docs/">https://python-poetry.org/docs/</a></div><div>パワーシェルで以下のコマンドたたくとインストールできる</div><div><span style="font-weight: bold;">$ (Invoke-WebRequest -Uri</span> <a href="https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py" style="font-weight: bold;">https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py</a> <span style="font-weight: bold;">-UseBasicParsing).Content | python</span></div><div>実行後</div><div><br/></div><div>③コマンドたたく</div><div>~.poetry\bin</div><div>を環境変数のPathに追加するとpoetryのコマンド叩ける（poetryのバージョン確認）</div><div>$ poetry --version</div><div>-------------------------------------------------------------------------------------------------------------------</div><div><br/></div><div><span style="font-weight: bold;"># プロジェクトのひな型作成</span></div><div>pyenv local 3.8.2  <span style="color: rgb(255, 0, 0); font-weight: bold;"># pythonのバージョン指定が非常に重要！！！！</span></div><div>poetry new tf23</div><div>→tf23というディレクトリにpyproject.toml（プロジェクトの依存関係を統括する重要なファイル）やREADME.rstなどが作られる</div><div><br/></div><div><span style="font-weight: bold;"># pyproject.tomlだけ作成する場合</span></div><div>poetry init</div><div><br/></div><div><span style="font-weight: bold;"># pyproject.tomlから、依存関係を解決し、必要なパッケージをインストール</span></div><div>cd tf23</div><div>poetry install</div><div>※poetry installやpoetry addした際に、仮想環境がすでに存在してなければ、自動的にpythonコマンドのバージョンを元に仮想環境が作成されます</div><div><br/></div><div><span style="font-weight: bold;"># パッケージをインストール</span></div><div>■tf23環境(cpu版のtensorflow)</div><div>cd tf23</div><div>poetry add tensorflow==2.3.0</div><div>poetry add tensorflow-estimator==2.3.0</div><div>poetry add tensorflow-addons</div><div>poetry add tensorflow-hub tensorflow-gcs-config tensorflow-probability</div><div>poetry add librosa pandas wave librosa scikit-learn Pillow tqdm matplotlib seaborn</div><div>poetry add jupyter black jupyter_contrib_nbextensions</div><div>poetry run jupyter contrib nbextension install --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry run jupyter nbextensions_configurator enable --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry add jupytext  # notebookとpyファイル行ったり来たりできる</div><div>poetry add optuna</div><div><span style="text-decoration: line-through;">poetry add u8darts</span>  # dartsのパッケージ。<span style="color: rgb(255, 0, 0);">これ入れたら環境壊れたのでpoetry env remove</span> <span style="color: rgb(255, 0, 0);">tf23-IOo67D1J-py3.8 </span><span style="color: rgb(255, 0, 0);">して、poetry install で再度環境作った（pyproject.toml に壊れる前の依存関係残っているので。こら便利だ）</span></div><div>poetry add google_images_download  # 画像スクレイピングパッケージ</div><div>poetry add adabelief-tf==0.0.1  # Adamを改良したAdaBelief <a href="https://github.com/juntang-zhuang/Adabelief-Optimizer">https://github.com/juntang-zhuang/Adabelief-Optimizer</a></div><div>poetry add adabelief-tf==0.1.0  # v=0.0.1 は動かないので更新</div><div>poetry add iterative-stratification  # マルチラベルStratifiedKFold</div><div><br/></div><div><br/></div><div>■tfgpu環境</div><div>poetry new tfgpu</div><div>poetry add tensorflow-gpu</div><div>poetry add tensorflow-estimator tensorflow-addons tensorflow-hub tensorflow-gcs-config tensorflow-probability</div><div>poetry add librosa pandas wave librosa scikit-learn Pillow tqdm matplotlib seaborn jupyter black jupyter_contrib_nbextensions jupytext optuna</div><div>poetry run jupyter contrib nbextension install --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry run jupyter nbextensions_configurator enable --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry add pandas-profiling</div><div>poetry add lightgbm</div><div>poetry add adabelief-tf==0.0.1  # Adamを改良したAdaBelief <a href="https://github.com/juntang-zhuang/Adabelief-Optimizer">https://github.com/juntang-zhuang/Adabelief-Optimizer</a></div><div>poetry add xgboost</div><div>poetry add category_encoders</div><div>poetry add keras-tuner</div><div>poetry add adabelief-tf==0.1.0  # v=0.0.1 は動かないので更新</div><div>poetry add iterative-stratification  # マルチラベルStratifiedKFold</div><div>poetry add kaggle  # 20201203</div><div>poetry add openpyxl  # 20201204</div><div>poetry add pycaret==2.2.2  # 20201204</div><div><br/></div><div>■tfgpu1環境(TGAN使うために作成)</div><div>pyenv shell 3.7.6</div><div>poetry new tfgpu1</div><div>cd C:\Users\81908\jupyter_notebook\poetry_work\tfgpu1</div><div>poetry show</div><div>poetry add tgan</div><div>poetry add tensorflow-gpu==1.15.4</div><div>poetry add pandas scikit-learn Pillow tqdm matplotlib seaborn jupyter black jupyter_contrib_nbextensions jupytext optuna nose</div><div>poetry run jupyter contrib nbextension install --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry run jupyter nbextensions_configurator enable --user  # jupyter_contrib_nbextensions有効化   <a href="https://qiita.com/varusvarus/items/20b047140b2aa1a44f40">https://qiita.com/varusvarus/items/20b047140b2aa1a44f40</a></div><div>poetry remove tensorflow-gpu  # gpu使ってくれないので消す。多分cudaの関係でgpu認識できていない</div><div>poetry add tensorflow-gpu==1.15.4  # 消したらimport出来なくなったので入れなおす</div><div><br/></div><div><br/></div><div>■ts環境</div><div>u8dartsインストールむり。原因はpystanと思われる</div><div><span style="text-decoration: line-through;">pyenv local 3.6.8  </span><span style="color: rgb(255, 0, 0); font-weight: bold; text-decoration: line-through;"># pythonのバージョン指定が非常に重要！！！！</span></div><div><span style="text-decoration: line-through;">pyenv local 3.7.6</span></div><div><span style="text-decoration: line-through;">poetry new ts  # プロジェクトディレクトリ作成</span></div><div><span style="text-decoration: line-through;">cd ts</span></div><div><span style="text-decoration: line-through;">poetry add fbprophet</span></div><div><span style="text-decoration: line-through;">poetry add pytorch cpuonly</span></div><div><span style="text-decoration: line-through;">poetry add u8darts </span></div><div><br/></div><div><br/></div><div>■pycaret2環境</div><div>poetry new pycaret2  # pycaret という名前だとエラーになるので注意</div><div>poetry add pycaret==2.0</div><div>poetry add jupyter black jupyter_contrib_nbextensions</div><div>poetry run jupyter contrib nbextension install --user</div><div>poetry run jupyter nbextensions_configurator enable --user</div><div>poetry add jupytext </div><div>poetry add optuna</div><div>poetry add category-encoders</div><div>poetry add papermill</div><div>poetry add pycaret==2.1</div><div><br/></div><div><br/></div><div>■pytorch環境</div><div><span style="text-decoration: line-through;">cd C:\Users\81908\jupyter_notebook\poetry_work</span></div><div><span style="text-decoration: line-through;">poetry new torch1</span></div><div><span style="text-decoration: line-through;">cd C:\Users\81908\jupyter_notebook\poetry_work\torch</span></div><div><span style="text-decoration: line-through;">poetry add torch</span></div><div>→失敗するので消した</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># パッケージをアップデート</span></div><div>poetry update requests</div><div><br/></div><div><span style="font-weight: bold;"># インストールしたパッケージを削除</span></div><div>poetry remove flask</div><div><br/></div><div><span style="font-weight: bold;"># 利用可能なパッケージの一覧を表示(pip listとおなじ)</span></div><div>poetry show</div><div><br/></div><div><span style="font-weight: bold;"># env系</span></div><div>poetry env info            # 現在の仮想環境の情報</div><div>poetry env list            # 仮想環境一覧</div><div>poetry env remove &lt;python&gt; # 仮想環境の削除</div><div>poetry env use &lt;python&gt;    # 仮想環境をアクティブまたは作成</div><div><br/></div><div><span style="font-weight: bold;"># 仮想環境内でシェルを起動</span></div><div>poetry shell</div><div><br/></div><div><span style="font-weight: bold;"># コマンドはpoetry run ~ で実行(例.python起動)</span></div><div>poetry run python</div><div><br/></div><div><span style="font-weight: bold;"># poetryの仮想環境ディレクトリ確認</span></div><div>$ poetry config --list</div><div>デフォルトは~/AppData\\Local\\pypoetry\\Cache</div><div><br/></div><div><span style="font-weight: bold;"># poetryの仮想環境一覧確認</span></div><div>poetry install したディレクトリで</div><div>$ poetry env list</div><div><br/></div><div><span style="font-weight: bold;">#</span> <span style="font-weight: bold;">poetryの</span><span style="font-weight: bold;">仮想環境の削除</span></div><div>$ poetry env remove poetry-xx-py3.6(仮想環境名)</div><div><br/></div><div><br/></div><hr/><div><span style="font-weight: bold;">■poetryのtensorflow-gpuが動かないのでcudaとか入れた 20201023</span></div></div><div><br/></div><div># 「00_tf23でのインストール手順」ショートカット(<a href="https://www.kkaneko.jp/tools/win/keras.html#S1">https://www.kkaneko.jp/tools/win/keras.html#S1</a>)に書いてるが一応やったことメモしておく</div><div># 以下のサイトも参考になった</div><div><a href="https://qiita.com/8128/items/2e884998cd1193f73e2f">https://qiita.com/8128/items/2e884998cd1193f73e2f</a></div><div><span style="color: rgb(255, 0, 0);">1. visual studio 2019のビルドツールインストール</span></div><div><span style="color: rgb(255, 0, 0);">2. PC再起動</span></div><div><span style="color: rgb(255, 0, 0);">3. cuda10.1ダウンロード+インストール</span></div><div><span style="color: rgb(255, 0, 0);">4. cudnn-10.1ダウンロード</span></div><div><span style="color: rgb(255, 0, 0);">　　cudnnダウンロードはnvidiaのサイトのログイン必要</span></div><div><span style="color: rgb(255, 0, 0);">　　</span><a href="mailto:rironyokoi@gmail.com" style="color: rgb(255, 0, 0);">rironyokoi@gmail.com</a></div><div><span style="color: rgb(255, 0, 0);">　　Shingorider1</span></div><div><span style="color: rgb(255, 0, 0);">　　でログインできる</span></div><div><span style="color: rgb(255, 0, 0);">5. cudnn-10.1解凍してcuda10.1のフォルダに解凍したファイルすべてコピーする</span></div><div><span style="color: rgb(255, 0, 0);">6. cudaの環境変数追加</span></div><div><br/></div><div>poetryでインストールしたtensorflow($ poetry add tensorflow-gpu)試す</div><div>$ cd C:\Users\81908\jupyter_notebook\poetry_work\tmp</div><div>$ poetry run python</div><div>&gt;&gt; import tensorflow as tf</div><div><div>&gt;&gt; tf.config.experimental.list_physical_devices('GPU')</div><div><br/></div><hr/><div><span style="font-weight: bold;">■Pyenv:複数のpythonバージョンや</span><span style="font-weight: bold;">複数の</span><span style="font-weight: bold;">Anaconda環境を管理可能なツール</span></div><div><span style="font-weight: bold;">→複数バージョンのPythonをインストールして簡単に切り替えられる</span></div><div>→バージョン違うAnacondaもインストールして切り替え可能</div><div>→色々なバージョンのPythonを~/.pyenv以下に配置する</div><div><br/></div><div>&lt;Pyenvインストール方法&gt;</div><div><a href="https://qiita.com/foewhoew32f320/items/2889d0e0bbb7b68309a5">https://qiita.com/foewhoew32f320/items/2889d0e0bbb7b68309a5</a></div><div>公式のpyenvは<span style="font-weight: bold;">windowsに対応していないので3rdパーティーのツールpyenv-winを利用</span></div><div><br/></div><div>①インストールコマンド</div><div>$ git clone <a href="https://github.com/pyenv-win/pyenv-win.git">https://github.com/pyenv-win/pyenv-win.git</a> %USERPROFILE%/.pyenv</div><div>→ホームディレクトリ(デフォルトはC:\User\ユーザー名\)の配下に.pyenvフォルダにコピー</div><div><br/></div><div>②環境変数</div><ul><li><div>クローン下フォルダパス(~/.pyenv\pyenv-win)をユーザー環境変数PYENVに設定</div></li><li><div>環境変数のPathにbinフォルダ(~/.pyenv\pyenv-win\bin)を追加</div></li><li><div>shimsフォルダ(~/.pyenv\pyenv-win\shims)</div></li></ul><div>         ※shimsフォルダは最初存在しないがpyenvでpython入れたら自動で作られる</div><ul><li><div>必ず～Microsoft\WindowsAppsと~/Anaconda3よりも上位に設定する</div></li></ul><div>         ※こうしないと切り替わりません</div><div><a href="https://midsatoh.github.io/python/install/pyenv-win/">https://midsatoh.github.io/python/install/pyenv-win/</a></div><div><img src="環境構築ログ_files/Image [2].png" type="image/png" data-filename="Image.png" width="380"/></div><div><br/></div><div>③コマンドプロンプトでコマンドたたく</div><div>※コマンドプロンプトからしか切り替えできない！！！</div><div>　powershellではむり。多分anacondaが邪魔してる</div><div>$ pyenv --version</div><div>叩いてエラー無いか確認</div><div>-------------------------------------------------------------------------------------------------------------------</div><div><br/></div><div><span style="font-weight: bold;"># インストール可能なPythonの一覧を表示</span></div><div>$ pyenv install --list</div><div><br/></div><div><span style="font-weight: bold;"># 指定したPythonをインストール</span></div><div>$ pyenv install &lt;version&gt;</div><div>→pyenv install 3.8.2 とか</div><div><br/></div><div><span style="font-weight: bold;"># インストールされたPythonの一覧を表示</span></div><div>$ pyenv versions</div><div>ディレクトリパスも表示される</div><div><br/></div><div><span style="font-weight: bold;"># グローバルに利用するPythonを指定（globalコマンドを使ってバージョンを切り替える）</span></div><div>$ pyenv global &lt;version&gt;</div><div>→pyenv global 3.8.2 とか</div><div>$ python -V で切り替わってること確認</div><div><br/></div><div><span style="font-weight: bold;"># カレントシェルで利用するPythonを指定</span></div><div>$ pyenv shell &lt;version&gt;</div><div><br/></div><div><span style="font-weight: bold;"># バージョンが切り替わらないなど何かあったらrehash</span></div><div>$ pyenv rehash</div><div><br/></div><div>shims下にpython.batを見つけて切り替えてるらしい</div><div><a href="http://yamap55.hatenablog.com/entry/2019/09/12/080000">http://yamap55.hatenablog.com/entry/2019/09/12/080000</a></div><div><br/></div><hr/><div><span style="font-weight: bold;">■Gitコマンドいろいろ(Udemyのまとめ)</span></div><div><br/></div><div><span style="font-weight: bold;"># pullはこの機能追加しての依頼や自分で作ったコードを投げる機能</span></div><div><br/></div><div><span style="font-weight: bold;"># Githubは非公開リポジトリは有料</span></div><div><span style="font-weight: bold;"># Gitbucketは非公開リポジトリが無料。ただし少人数じゃないと使かえない</span></div><div><br/></div><div><span style="font-weight: bold;"># gitの登録情報ファイル確認</span></div><div>$ cat ~/.gitconfig</div><div><br/></div><div><span style="font-weight: bold;"># Gitはスナップショットを保存している（差分じゃなくてファイル丸ごと保存してる）</span></div><div><span style="font-weight: bold;">　スナップショットだからブランチ切るとき早い</span></div><div><br/></div><div><span style="font-weight: bold;"># ローカルリポジトリの構造</span></div><div>ワークツリー（ファイル変更する作業場）でファイル変更</div><div>→git add でステージ（コミットする変更準備）に変更したファイルの圧縮ファイルを追加</div><div>→git commitでリポジトリにスナップショット記録。変更履歴たどれるように直前のcommit idなども記録する</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例１（リポジトリ開始）</span></div><div>ローカルファイル変更</div><div>→$ git init でリポジトリ設定</div><div>→$ git add --all なりでstageに変更追加</div><div>→$ git commit -m &quot;first commit&quot; でローカルリポジトリに変更追加</div><div>→$ git push origin master でリモートリポジトリに変更追加</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例２(ローカルファイル変更したからcommit＋push)</span></div><div>→$ git log で変更履歴確認</div><div>→$ git status で現在のリポジトリの状態確認</div><div>→$ git diff でワークツリーと stageの差分確認</div><div>→$ git add . でstageに追加</div><div>→$ git diff stage でローカルリポジトリとの差確認</div><div>→$ git commit -m &quot;edit aaa&quot; でローカルリポジトリに変更追加</div><div>→$ git push origin masterでリモートリポジトリに変更追加</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例３(ファイルをstageの状態に戻したい)</span></div><div>→$ git checkout -- .</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例４(ファイル間違えてaddした。stageをローカルリポジトリの状態に戻したい)</span></div><div>→$ git checkout HEAD .</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例5（ファイル間違えてcommitした。直前のcommit取り消して再commit）</span></div><div>→ファイル修正</div><div>→$ git commit --amend</div><div>　エディタ立ち上がりコミットメッセージ修正して再commitされる</div><div>→$ git push origin master でリモートリポジトリに変更追加</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例6（ファイル間違えてpushした。リモートリポジトリを戻したい）</span></div><div>※リモートリポジトリの切り戻しはできない。戻したい状態にローカルリポジトリしてpushするしかない</div><div>　絶対に$ git commit --amend しないこと。これするとpushできなくなる</div><div>　やっちゃった場合は、$ git branch -D master&lt;ブランチ名&gt; でローカルのブランチ削除して、$ git fetch→$ git branch master origin/master でリモートのマスターブランチにする</div><div>→何かファイル変更してadd,commit,push</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例7（ソース一式確保して違う機能開発したい）</span></div><div>→$ git branch feature で別ブランチ(ここではfeatureという名前のブランチ)作成</div><div>→$ git checkout feature でfeatureブランチに移動</div><div>→$ git branch で今いるブランチ確認</div><div>→ファイル変更</div><div>→$ git add .</div><div>→$ git commit</div><div>→$ git push origin feature でリモートリポジトリのfeatureブランチに変更追加</div><div>※$ git checkout master + $ ls でmasterブランチ確認するとfeatureで変更した内容がないことがわかる</div><div>※Github右上のBranch: ボタンでブランチ切り替えれる</div><div><br/></div><div><span style="font-weight: bold;"># gitの手順例8（リモートのfeatureブランチの内容をmasterブランチにマージする）</span></div><div>→$ git checkout feature でfeatureブランチに移動</div><div>→$ git pull origin(リモート名) feature（ブランチ名）でローカルのfeatureブランチをリモートの内容にする</div><div>→$ git checkout master でmasterブランチにもどる</div><div>→$ git merge feature でローカルのfearureブランチの内容をmasterにマージ。ここでコンフリクト多々起きる。コンフリクト起きているファイル開いていらん内容削除すること</div><div>→$ git add .</div><div>→$ git commit</div><div>→$ git push origin master  でリモートのmasterブランチ更新</div><div>→$ git branch -d feature  でいらなくなったローカルのブランチ削除</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"># gitのエディタとして Visual Studio Code を使う（commitコマンド書くときとかに立ち上がるediterが指定できる）</span></div><div>$ git config --global core.editor &quot;code --wait&quot;</div><div><br/></div><div><span style="font-weight: bold;"># stageに変更記録</span></div><div>$ git add .</div><div><br/></div><div><span style="font-weight: bold;"># リポジトリにcommit（変更記録）</span></div><div>$ git commit</div><div>$ git commit -m &lt;メッセージ&gt;  # 即commit</div><div>$ git commit -v  # ファイルの変更内容確認（gitのエディタが立ち上がり内容表示）してからcommitする</div><div><br/></div><div><span style="font-weight: bold;"># 現在の状況確認</span></div><div>$ git status</div><div><br/></div><div><span style="font-weight: bold;"># git addする前の変更差分（ワークツリーとstageとの差分）</span></div><div>$ git diff</div><div><br/></div><div><span style="font-weight: bold;"># git addした後の変更差分（stageとリポジトリとの差分）</span></div><div>$ git diff --staged</div><div><br/></div><div><span style="font-weight: bold;"># 変更履歴</span></div><div>$ git log</div><div>$ git log --oneline  # 1行で表示</div><div>$ git log -p xxx.txt  # ファイル変更差分表示</div><div>$ git log -n 1  # 表示するコミット数制限。直前のやつだけ見たいときは-n 1 にする</div><div><br/></div><div><span style="font-weight: bold;"># ファイル削除</span></div><div>$ git rm &lt;ファイル名&gt;  # ファイル本体も削除</div><div>$ git rm -r &lt;ディレクトリ名&gt;  # ファイル本体も削除</div><div>$ git rm --cached &lt;ファイル名&gt;  # ファイル本体は残してリポジトリだけで削除する場合</div><div><br/></div><div><span style="font-weight: bold;"># ファイル名変更</span></div><div>$ git mv aaa.txt bbb.txt  # ファイル本体の名前も変更</div><div><br/></div><div><span style="font-weight: bold;"># Githubに保存（プッシュ）</span></div><div>$ git remote add origin <a href="https://tenn/">https://tenn</a>  # リポジトリのurlをorigin（リモート名）として記憶する。これでいちいちGithubのurl書かなくてorigin でpushできる</div><div>$ git push &lt;リモート名&gt; &lt;ブランチ名&gt;  # -u オプションは初回にpushのみでいい</div><div><br/></div><div><span style="font-weight: bold;"># コマンドにエイリアス（別名で短縮させる）</span></div><div>$ git config --global alias.ci commit  # これで git ci でgit commitできるようになる</div><div>$ git config --global alias.st status  # これで git st でgit status  できるようになる</div><div>$ git config --global alias.br branch  # これで git br でgit branch  できるようになる</div><div>$ git config --global alias.co checkout  # これで git co でgit checkout  できるようになる</div><div><br/></div><div><span style="font-weight: bold;"># ファイルの変更を取り消す(ワークツリーを最新のstageの状態に戻す)</span></div><div>$ git checkout -- &lt;ファイル/ディレクトリ名&gt;</div><div># 全変更を取り消す</div><div>$ git checkout -- .</div><div><br/></div><div><span style="font-weight: bold;"># ステージに変更した(git add した)変更をもとに戻す（stageを最新のリポジトリの状態に戻す）</span></div><div>$ git reset HEAD &lt;ファイル/ディレクトリ名&gt;</div><div># 全ファイルの変更を取り消す</div><div>$ git checkout HEAD .</div><div><br/></div><div><span style="font-weight: bold;"># 直前のコミットをやり直す（今のstageの状態でリポジトリをcommitする。コミット漏れファイルあるときに使う）</span></div><div>$ git commit --amend  # これ使えるのはローカルリポジトリだけ。Github(リモートリポジトリ)にpush したcommitはやり直したらダメ。リモートの変更はcommit でのみ行うこと</div><div><br/></div><div><span style="font-weight: bold;"># Githubのブランチ（リモート名）表示</span></div><div>$ git remote  # originとか表示される</div><div>$ git remote -v  # 対応するurl表示</div><div><br/></div><div><span style="font-weight: bold;"># リモートリポジトリ（Github）から情報取得(fetch) ※他の人のpushをローカルに反映させるときに使う</span></div><div>$ git fetch origin(リモート名) # ワークツリーに入るわけじゃなくてcommit先のローカルリポジトリにコピーされる</div><div>$ git merge でワークツリー反映させる</div><div><br/></div><div><span style="font-weight: bold;"># pull = fetch+merge一気にやる。リモート（Github）から情報取得してマージ（変更内容取り込み）まで一気にやる</span></div><div>$ git pull origin(リモート名) master（ブランチ名）  # $ git pull だけでもいける</div><div>※$ git fetch origin master + $ git merge origin/master と同じこと</div><div>※pullは楽だが、現在いるローカルブランチにpullしてきた内容がコピーされる。hogeブランチにいるのにmasterブランチの内容で上書きしたみたいなことが起こり得るのでfetchしてブランチ移動してmergeとしたほうが安全</div><div><br/></div><div><span style="font-weight: bold;"># リモートリポジトリの詳細内容（urlとか）表示</span></div><div>$ git remote show orign(リモート名）</div><div><br/></div><div><span style="font-weight: bold;"># リモートリポジトリの名前変更</span></div><div>$ git remote rename &lt;旧リモート名&gt; &lt;新リモート名&gt;</div><div><br/></div><div><span style="font-weight: bold;"># リモートリポジトリ削除</span></div><div>$ git remote rm &lt;リモート名&gt;</div><div><br/></div><div><span style="font-weight: bold;"># ブランチ=複数人で同時並行して別機能を開発するための仕組み。</span></div><div>　実態はコミット（コミットID）を指したポインタにすぎない。</div><div>　コミットしたらブランチがさすコミットファイルが変更される（最新のコミットファイルを指すようになる）</div><div>　gitは直前の変更との紐づけのみを持つので、コミット1からブランチA,ブランチBを切ると2分木のようになり枝に見える（コミット1と紐づくポインタが2個できる）からブランチと言われてるみたい</div><div>　HEADは今自分が作業しているブランチへのポインタのこと</div><div><br/></div><div><span style="font-weight: bold;"># ブランチ新規追加 ※ブランチ作るだけで切り替えまではしない</span></div><div>$ git branch feature&lt;ブランチ名&gt;</div><div><br/></div><div><span style="font-weight: bold;"># ブランチ一覧表示</span></div><div>$ git branch</div><div>$ git branch -a  # リモートブランチ含めすべてのブランチ表示</div><div><br/></div><div><span style="font-weight: bold;"># ブランチ切り替える</span></div><div>$ git checkout feature&lt;既存ブランチ&gt;</div><div>$ git checkout -b &lt;新ブランチ&gt;  # -bオプションでブランチの作成と切り替え一度に実行</div><div><br/></div><div><span style="font-weight: bold;"># 変更履歴をマージ（=他の人の変更内容を取り込む）</span></div><div>$ git merge &lt;ブランチ名&gt;  # ローカルのブランチとマージ</div><div>$ git merge origin/master(&lt;リモート名&gt;/&lt;ブランチ名&gt;)  # リモートのブランチとマージ</div><div>マージには3種類ある</div><div>①Fast Forward: ブランチなしのマージ。ポインタ前に進めるだけ</div><div>②Auto Merge: 基本のマージ。ブランチありのマージ。</div><div>③コンフリクト</div><div><br/></div><div><span style="font-weight: bold;"># コンフリクト: 同じファイルの同じ行に対して異なる編集を行ったときに発生する</span></div><div>解消するにはコンフリクト起きているファイルの内容を変更するしかない</div><div>$ git status  # コンフリクト起きているファイル表示</div><div>→エディタで内容修正</div><div>$ git add &lt;コンフリクト起きているファイル&gt;</div><div>$ git commit</div><div><br/></div><div><span style="font-weight: bold;"># ローカルブランチ名を変更</span></div><div>$ git branch -m new_branch&lt;ブランチ名&gt;</div><div><br/></div><div><span style="font-weight: bold;"># ローカルブランチを削除</span></div><div>$ git branch -d feature&lt;ブランチ名&gt;</div><div>$ git branch -D feature&lt;ブランチ名&gt;  # 強制削除</div><div><br/></div><div><span style="font-weight: bold;"># pullリクエスト: 自分の変更したコードをリポジトリに取り込んでもらえるように依頼する機能</span></div><div>pushしたコードをレビューしてからmergeするために使う</div><div><br/></div><div><span style="font-weight: bold;"># masterはすぐデプロイできる状態にして、変更したいときはブランチを切って、変更完了したらmasterとマージするのがGithub flowのルール</span></div><div>git checkout -b feature</div><div>→git add .</div><div>→git commit</div><div>→git push origin feature</div><div>→git checkout master</div><div>→git pull origin feature</div><div><br/></div><div><span style="font-weight: bold;"># リベース: 規定(ベース)となる親コミットを変更してブランチを統合する</span></div><div>マージは履歴が枝分かれする</div><div>→履歴を綺麗にしたいときはマージではなくリベースを使う</div><div>→pushしていないローカルの変更はリベースを使い、pushした後はマージを使う</div><div>→コンフリクト起きそうならmergeを使う</div><div>$ git rebase &lt;ブランチ名&gt;</div><div><br/></div><div><span style="font-weight: bold;"># Githubでpushしたcommitをリベースは絶対やったらダメ=git push -f （強制push）は絶対NG。gitが完全に壊れる</span></div><div><span style="font-weight: bold;">リモートとローカルの履歴に不整合が起きるためpushできなくなる</span></div><div><br/></div><div><span style="font-weight: bold;"># 複数のcommitをやり直す</span></div><div>$ git rebase -i &lt;コミットID&gt;</div><div>$ git rebase -i HEAD~3  にすると3つ遡ってコミットやり直す。</div><div>→実行するとエディタが立ち上がる</div><div>　pickの行削除したらそのcomiit削除できる</div><div>　pick→editに変えるならコメント変更できる→git commit --amend→ git rebase --continue で反映</div><div><br/></div><div><span style="font-weight: bold;"># タグ: コミットを参照しやすくするためにわかりやすい名前を付けるもの。リリースポイントでつけるらしい</span></div><div>タグは注釈付き（annotated）と軽量版の2種類ある</div><div>→注釈付きタグ=コメントや署名もつけることができる</div><div>$ git tag -a [タグ名] -m [メッセージ]</div><div>$ git tag -a 20200908_01 -m &quot;version 20200908_01&quot;</div><div>→軽量版タグ=タグ名のみつけれる</div><div>$ git tag -a [タグ名]</div><div>$ git tag -a 20200908_01</div><div><br/></div><div><span style="font-weight: bold;"># タグのデータ表示</span></div><div>$ git show [タグ名]</div><div>$ git show 20200908_01</div><div><br/></div><div><span style="font-weight: bold;"># タグをリモートに上げるにはgit pushで送信。これ送ることでGithubのリリースにzipがつくれる！！！</span></div><div>$ git push [リモート名] [タグ名]</div><div>$ git push origin 20200908_01</div><div><br/></div><div><span style="font-weight: bold;"># タグを一斉に送信</span></div><div>$ git push origin --tags</div><div><br/></div><div><span style="font-weight: bold;"># 作業を一時避難する（急遽行うバグ修正とかで使う）</span></div><div>$ git stash  # 作業を一時避難する。ローカルの内容がステージの状態に戻り今の状態はstashに退避される。stashは隠すという意味</div><div>$ git stash save  # git stashと同じこと</div><div><br/></div><div>$ git stash list  # stashした一覧表示</div><div><br/></div><div>$ git stash apply  # stashに退避した最新のローカル環境を復元する。復元してもstash残るのでapply後はstash削除必要</div><div><br/></div><div>$ git stash apply --index  # ステージの状況も復元</div><div><br/></div><div>$ git stash apply [スタッシュ名]  # 特定のstashを復元</div><div>→$ git stash apply stash@{1}  # stash名は0始まり</div><div><br/></div><div>$ git stash drop  # 最新のstashを削除</div><div>$ git stash drop [スタッシュ名]</div><div>→$ git stash drop syash@{1}</div><div>$ git stash clear  # 全stash削除</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 